geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom'))
cat("\n")
}
for(i in unique(FatData$Year)) {
cat("\n")
cat("#####", i, "\n")
cat("\n")
FatData1 = FatData %>% filter(Year == i)
print(FatData1 %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData1, Lat < 46 & Lat > 40 & Month == 1 & Year == i), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom'))
cat("\n")
}
ggplot(data = subset(SST, Ground == "Scots Bay" & In_Box == "1"), aes(x = Julian, y = Temperature, colour = Year)) +
geom_point() +
geom_line() +
ylab("Average Sea Surface Temperature") +
xlab("Julian Day") +
ggtitle("Scots Bay")
Summer = SST %>%
subset(Ground == "Scots Bay" & In_Box == "1" & Month == "8")
ggplot(data = Summer, aes(x=Year, y=Temperature, group = Year, colour = Year))+
geom_boxplot() +
ylab("Average Sea Surface Temperature") +
ggtitle("August SST") +
stat_summary(fun.y = median, fun.ymax = length,
geom = "text", aes(label = ..ymax..), vjust = -0.5) +
ylim(8.5,16.5)
ggplot(data = subset(SST, Ground == "Scots Bay" & In_Box == "1"), aes(x=Year, y=Temperature, group = Year, colour = Year)) +
geom_boxplot() +
facet_wrap(~Month) +
ylim(7.5, 15.5) +
stat_summary(fun.y = median, fun.ymax = length,
geom = "text", aes(label = ..ymax..), vjust = -1) +
labs(x="Year", y = "Sea Surface Temperature (SST) (C)", title = "Scots Bay: Monthly SST vs. Year") +
theme(axis.text.x = element_text(angle = 55))
rm(list = ls())
#Import all packages, CTD data, and land data
#Packages
setwd(paste0("C:/Users/", Sys.info()[7],"/Documents/GitHub/HerringScience.github.io/Main Data/"))
library(cli)
library(lubridate)
library(reprex)
library(tidyverse)
library(geosphere)
library(reshape2)
library(moderndive)
library(skimr)
library(ggridges)
#library(weathercan)
library(GGally)
library(psych)
library(raster)
library(PBSmapping)
#library(rgeos)
library(sf)
library(terra)
library(knitr)
library(kableExtra)
library(grid)
library(gridExtra)
library(cowplot)
library(DT)
library(dygraphs)
library(leaflet)
library(rmapshaper)
library(plotly)
library(mapproj)
library(oce) #new CTD Data package
#Larval Data
Larval <- read_csv("Full Larval.csv")
Larval$Year <- as.factor(Larval$Year)
Larval$category <- as.factor(Larval$category)
Larval$Survey.No <- as.factor(Larval$Survey.No)
#Plankton Data
Plankton <- read_csv("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Source Data/planktonsamplingData.csv")
Plankton <- select(Plankton, id, TowTime, AvgTowDepth)
Plankton <- Plankton %>% drop_na(id)
is.na(Plankton$AvgTowDepth) <- 0
View(Plankton)
Plankton$AvgTowDepth[is.na(Plankton$AvgTowDepth)] <- 0
View(Plankton)
Larval$AgeInDays <- ((Larval$Lengthmm - 5)/0.24)
Larval$SpawnDate <- Larval$Date-Larval$AgeInDays
MeanAgeInDays <- aggregate(AgeInDays~id, Larval, mean)
colnames(MeanAgeInDays)[2]<- "MeanAgeInDays"
MinDateOfSpawn <- aggregate(SpawnDate~id, Larval, min)
colnames(MinDateOfSpawn)[2] <- "MinDateOfSpawn"
MaxDateOfSpawn <- aggregate(SpawnDate~id, Larval, max)
colnames(MaxDateOfSpawn)[2] <- "MaxDateOfSpawn"
Larval2 <- merge(MeanAgeInDays, MinDateOfSpawn)
Larval3 <- merge(Larval2, MaxDateOfSpawn)
Larval4 <- merge(Larval3, AvgTowDepth)
Plankton2 <- select(id, TowTime)
Larval4 <- select(Larval3, AvgTowDepth)
Plankton2 <- select(Plankton, id, TowTime)
MeanTowTime <- aggregate(TowTime~id, Plankton2, mean)
View(MeanTowTime)
View(Plankton)
View(Plankton2)
Plankton2 %>% drop_na(TowTime)
Plankton2 <- Plankton2 %>% drop_na(TowTime)
MeanTowTime <- aggregate(TowTime~id, Plankton2, mean)
StartLat <- aggregate(Lat1~id, Plankton, mean)
#Larval Data
Larval <- read_csv("Full Larval.csv")
Larval$Year <- as.factor(Larval$Year)
Larval$category <- as.factor(Larval$category)
Larval$Survey.No <- as.factor(Larval$Survey.No)
#Plankton Data
Plankton <- read_csv("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Source Data/planktonsamplingData.csv")
Plankton <- select(Plankton, id, TowTime, AvgTowDepth)
Plankton <- Plankton %>% drop_na(id)
Plankton$AvgTowDepth[is.na(Plankton$AvgTowDepth)] <- 0
Larval$AgeInDays <- ((Larval$Lengthmm - 5)/0.24)
Larval$SpawnDate <- Larval$Date-Larval$AgeInDays
MeanAgeInDays <- aggregate(AgeInDays~id, Larval, mean)
colnames(MeanAgeInDays)[2]<- "MeanAgeInDays"
MinDateOfSpawn <- aggregate(SpawnDate~id, Larval, min)
colnames(MinDateOfSpawn)[2] <- "MinDateOfSpawn"
MaxDateOfSpawn <- aggregate(SpawnDate~id, Larval, max)
colnames(MaxDateOfSpawn)[2] <- "MaxDateOfSpawn"
Larval2 <- merge(MeanAgeInDays, MinDateOfSpawn)
Larval3 <- merge(Larval2, MaxDateOfSpawn)
Larval4 <- merge(Larval3, AvgTowDepth)
Larval4 <- merge(Larval3, TowDepth)
Larval4 <- merge(Larval3, MeanTowDepth)
Larval4 <- merge(Larval3, MeanTowTime)
View(Larval4)
View(Larval3)
View(MeanTowTime)
View(Plankton2)
View(MeanTowTime)
View(Plankton2)
View(Plankton)
View(Larval)
StartLat <- aggregate(Lat1~id, Plankton, mean)
StartLon <- aggregate(Lon1~id, Plankton, mean)
#Plankton Data
Plankton <- read_csv("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Source Data/planktonsamplingData.csv")
StartLat <- aggregate(Lat1~id, Plankton, mean)
StartLon <- aggregate(Lon1~id, Plankton, mean)
StartCoords <- merge(StartLat, StartLon)
EndLat <- aggregate(Lat2~id, Plankton, mean)
EndLon <- aggregate(Lon2~id, Plankton, mean)
EndCoords <- merge(EndLat, EndLon)
TowCoords <- merge(StartCoords, EndCoords)
Larval5 <- merge(Larval4, MeanTowTime)
Larval6 <- merge(Larval5, TowCoords)
View(Larval5)
View(Larval6)
View(MeanTowTime)
Larval4 <- merge(Larval3, TowCoords)
Larval5 <- merge(Larval4, MeanTowTime)
View(Larval5)
MeanTowDepth <- select(Plankton, id, AvgTowDepth)
View(MeanTowDepth)
MeanTowDepth$AvgTowDepth[is.na(MeanTowDepth$AvgTowDepth)] <- 0
View(MeanTowDepth)
MeanTowDepth$AvgTowDepth[is.na(MeanTowDepth$AvgTowDepth)] <- 0
Larval6 <- merge(Larval4, MeanTowDepth)
View(Larval6)
Larval6 <- merge(Larval5, MeanTowDepth)
View(Larval6)
Larval6 <- merge(Larval5, MeanTowDepth)
LarvalSum <- Larval %>% select("Ground", "Year", "id", "Survey.No", "Abundance", "Preservative", "X", "Y", "TowTime", "MeanLength")
LarvalSum <- merge(LarvalSum, Larval6)
View(LarvalSum)
LarvalSum <- unique(LarvalSum)
View(LarvalSum)
MeanAgeInDays <- aggregate(AgeInDays~id, Larval, mean) %>%
colnames(MeanAgeInDays)[2]<- "MeanAgeInDays"
Plankton <- select(Plankton, id, TowTime, AvgTowDepth) +
Plankton %>% drop_na(id)
View(Plankton)
Plankton <- select(Plankton, id, TowTime, AvgTowDepth, Volume)
View(Plankton)
Volume <- select(Plankton, id, Volume)
Larval7 <- merge(Laval6, Volume)
Larval7 <- merge(Larval6, Volume)
View(Larval7)
View(Larval)
i
rm(list = ls())
#Larval Data
Larval <- read_csv("Full Larval.csv")
Larval$Year <- as.factor(Larval$Year)
Larval$category <- as.factor(Larval$category)
Larval$Survey.No <- as.factor(Larval$Survey.No)
#Plankton Data
Plankton <- read_csv("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Source Data/planktonsamplingData.csv")
Larval$AgeInDays <- ((Larval$Lengthmm - 5)/0.24)
Larval$SpawnDate <- Larval$Date-Larval$AgeInDays
MeanAgeInDays <- aggregate(AgeInDays~id, Larval, mean)
colnames(MeanAgeInDays)[2]<- "MeanAgeInDays"
MinDateOfSpawn <- aggregate(SpawnDate~id, Larval, min)
colnames(MinDateOfSpawn)[2] <- "MinDateOfSpawn"
MaxDateOfSpawn <- aggregate(SpawnDate~id, Larval, max)
colnames(MaxDateOfSpawn)[2] <- "MaxDateOfSpawn"
Larval2 <- merge(MeanAgeInDays, MinDateOfSpawn)
View(Larval2)
View(Larval)
Larval1 <- select(Larval, id, Date, Survey.No, Abundance, TowTime, AvgDepth, AgeInDays, SpawnDate)
Larval1 <- select(Larval, id, Date, Survey.No, Abundance, TowTime, AvgTowDepth, AgeInDays, SpawnDate)
View(Larval1)
Larval$AgeInDays <- ((Larval$Lengthmm - 5)/0.24)
Larval$SpawnDate <- Larval$Date-Larval$AgeInDays
Larval1 <- select(Larval, id, Date, Survey.No, Abundance, TowTime, AvgTowDepth, AgeInDays, SpawnDate)
MeanAgeInDays <- aggregate(AgeInDays~id, Larval, mean)
colnames(MeanAgeInDays)[2]<- "MeanAgeInDays"
MinDateOfSpawn <- aggregate(SpawnDate~id, Larval, min)
colnames(MinDateOfSpawn)[2] <- "MinDateOfSpawn"
MaxDateOfSpawn <- aggregate(SpawnDate~id, Larval, max)
colnames(MaxDateOfSpawn)[2] <- "MaxDateOfSpawn"
Larval2 <- merge(Larval1, MinDateOfSpawn)
Larval2A <- merge(Larval2, MeanAgeInDays)
Larval3 <- merge(Larval2, MaxDateOfSpawn)
Larval3 <- merge(Larval2A, MaxDateOfSpawn)
StartLat <- aggregate(Lat1~id, Plankton, mean)
StartLon <- aggregate(Lon1~id, Plankton, mean)
StartCoords <- merge(StartLat, StartLon)
EndLat <- aggregate(Lat2~id, Plankton, mean)
EndLon <- aggregate(Lon2~id, Plankton, mean)
EndCoords <- merge(EndLat, EndLon)
TowCoords <- merge(StartCoords, EndCoords)
Larval4 <- merge(Larval3, TowCoords)
Plankton <- select(Plankton, id, TowTime, AvgTowDepth, Volume)
Plankton <- Plankton %>% drop_na(id)
Plankton$AvgTowDepth[is.na(Plankton$AvgTowDepth)] <- 0
Plankton2 <- select(Plankton, id, TowTime)
Plankton2 <- Plankton2 %>% drop_na(TowTime)
MeanTowTime <- aggregate(TowTime~id, Plankton2, mean)
Larval5 <- merge(Larval4, MeanTowTime)
MeanTowDepth <- select(Plankton, id, AvgTowDepth)
MeanTowDepth$AvgTowDepth[is.na(MeanTowDepth$AvgTowDepth)] <- 0
Larval6 <- merge(Larval5, MeanTowDepth)
Volume <- select(Plankton, id, Volume)
Larval7 <- merge(Larval6, Volume)
LarvalSum <- Larval %>% select("Ground", "Year", "id", "Survey.No", "Abundance", "Preservative", "X", "Y", "TowTime", "MeanLength")
LarvalSum <- merge(LarvalSum, Larval6)
LarvalSum <- unique(LarvalSum)
View(LarvalSum)
MeanAgeInDays <- aggregate(AgeInDays~id, Larval1, mean)
colnames(MeanAgeInDays)[2]<- "MeanAgeInDays"
MinDateOfSpawn <- aggregate(SpawnDate~id, Larval1, min)
colnames(MinDateOfSpawn)[2] <- "MinDateOfSpawn"
MaxDateOfSpawn <- aggregate(SpawnDate~id, Larval1, max)
colnames(MaxDateOfSpawn)[2] <- "MaxDateOfSpawn"
Larval2 <- merge(Larval1, MinDateOfSpawn)
Larval2A <- merge(Larval2, MeanAgeInDays)
Larval3 <- merge(Larval2A, MaxDateOfSpawn)
StartLat <- aggregate(Lat1~id, Plankton, mean)
StartLon <- aggregate(Lon1~id, Plankton, mean)
StartCoords <- merge(StartLat, StartLon)
EndLat <- aggregate(Lat2~id, Plankton, mean)
EndLon <- aggregate(Lon2~id, Plankton, mean)
EndCoords <- merge(EndLat, EndLon)
TowCoords <- merge(StartCoords, EndCoords)
View(Plankton)
#Plankton Data
Plankton <- read_csv("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Source Data/planktonsamplingData.csv")
Larval$AgeInDays <- ((Larval$Lengthmm - 5)/0.24)
Larval$SpawnDate <- Larval$Date-Larval$AgeInDays
Larval1 <- select(Larval, id, Date, Survey.No, Abundance, TowTime, AvgTowDepth, AgeInDays, SpawnDate)
MeanAgeInDays <- aggregate(AgeInDays~id, Larval1, mean)
colnames(MeanAgeInDays)[2]<- "MeanAgeInDays"
MinDateOfSpawn <- aggregate(SpawnDate~id, Larval1, min)
colnames(MinDateOfSpawn)[2] <- "MinDateOfSpawn"
MaxDateOfSpawn <- aggregate(SpawnDate~id, Larval1, max)
colnames(MaxDateOfSpawn)[2] <- "MaxDateOfSpawn"
Larval2 <- merge(Larval1, MinDateOfSpawn)
Larval2A <- merge(Larval2, MeanAgeInDays)
Larval3 <- merge(Larval2A, MaxDateOfSpawn)
StartLat <- aggregate(Lat1~id, Plankton, mean)
StartLon <- aggregate(Lon1~id, Plankton, mean)
StartCoords <- merge(StartLat, StartLon)
EndLat <- aggregate(Lat2~id, Plankton, mean)
EndLon <- aggregate(Lon2~id, Plankton, mean)
EndCoords <- merge(EndLat, EndLon)
TowCoords <- merge(StartCoords, EndCoords)
Larval4 <- merge(Larval3, TowCoords)
Plankton <- select(Plankton, id, TowTime, AvgTowDepth, Volume)
Plankton <- Plankton %>% drop_na(id)
Plankton$AvgTowDepth[is.na(Plankton$AvgTowDepth)] <- 0
Plankton2 <- select(Plankton, id, TowTime)
Plankton2 <- Plankton2 %>% drop_na(TowTime)
MeanTowTime <- aggregate(TowTime~id, Plankton2, mean)
Larval5 <- merge(Larval4, MeanTowTime)
MeanTowDepth <- select(Plankton, id, AvgTowDepth)
MeanTowDepth$AvgTowDepth[is.na(MeanTowDepth$AvgTowDepth)] <- 0
Larval6 <- merge(Larval5, MeanTowDepth)
Volume <- select(Plankton, id, Volume)
Larval7 <- merge(Larval6, Volume)
LarvalSum <- Larval %>% select("Ground", "Year", "id", "Survey.No", "Abundance", "Preservative", "X", "Y", "TowTime", "MeanLength")
LarvalSum <- merge(LarvalSum, Larval6)
LarvalSum <- unique(LarvalSum)
View(LarvalSum)
View(MaxDateOfSpawn)
MeanAgeInDays <- aggregate(AgeInDays~id, Larval, mean)
colnames(MeanAgeInDays)[2]<- "MeanAgeInDays"
MinDateOfSpawn <- aggregate(SpawnDate~id, Larval, min)
colnames(MinDateOfSpawn)[2] <- "MinDateOfSpawn"
MaxDateOfSpawn <- aggregate(SpawnDate~id, Larval, max)
colnames(MaxDateOfSpawn)[2] <- "MaxDateOfSpawn"
Larval1 <- select(Larval, id, Date, Survey.No, Abundance, TowTime, AvgTowDepth)
Larval2 <- merge(MeanAgeInDays, MinDateOfSpawn)
Larval3 <- merge(Larval2, MaxDateOfSpawn)
Larval3A <- merge(Larval1, Larval3)
View(Larval3A)
Larval3B <- unique(Larval3A)
StartLat <- aggregate(Lat1~id, Plankton, mean)
rm(list = ls())
#Larval Data
Larval <- read_csv("Full Larval.csv")
Larval$Year <- as.factor(Larval$Year)
Larval$category <- as.factor(Larval$category)
Larval$Survey.No <- as.factor(Larval$Survey.No)
#Plankton Data
Plankton <- read_csv("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Source Data/planktonsamplingData.csv")
Larval$AgeInDays <- ((Larval$Lengthmm - 5)/0.24)
Larval$SpawnDate <- Larval$Date-Larval$AgeInDays
Larval1 <- select(Larval, id, Date, Survey.No, Abundance, TowTime, AvgTowDepth)
MeanAgeInDays <- aggregate(AgeInDays~id, Larval, mean)
colnames(MeanAgeInDays)[2]<- "MeanAgeInDays"
MinDateOfSpawn <- aggregate(SpawnDate~id, Larval, min)
colnames(MinDateOfSpawn)[2] <- "MinDateOfSpawn"
MaxDateOfSpawn <- aggregate(SpawnDate~id, Larval, max)
colnames(MaxDateOfSpawn)[2] <- "MaxDateOfSpawn"
Larval2 <- merge(MeanAgeInDays, MinDateOfSpawn)
Larval3 <- merge(Larval2, MaxDateOfSpawn)
Larval3 <- merge(Larval1, Larval3)
Larval3 <- unique(Larval3A)
Larval3 <- unique(Larval3)
StartLat <- aggregate(Lat1~id, Plankton, mean)
StartLon <- aggregate(Lon1~id, Plankton, mean)
StartCoords <- merge(StartLat, StartLon)
EndLat <- aggregate(Lat2~id, Plankton, mean)
EndLon <- aggregate(Lon2~id, Plankton, mean)
EndCoords <- merge(EndLat, EndLon)
TowCoords <- merge(StartCoords, EndCoords)
Larval4 <- merge(Larval3, TowCoords)
Plankton <- select(Plankton, id, TowTime, AvgTowDepth, Volume)
Plankton <- Plankton %>% drop_na(id)
Plankton$AvgTowDepth[is.na(Plankton$AvgTowDepth)] <- 0
Plankton2 <- select(Plankton, id, TowTime)
Plankton2 <- Plankton2 %>% drop_na(TowTime)
MeanTowTime <- aggregate(TowTime~id, Plankton2, mean)
Larval5 <- merge(Larval4, MeanTowTime)
View(Larval5)
View(Larval4)
View(Plankton2)
View(Plankton2)
View(MeanTowTime)
#Left in because this should update the tow time with means
Larval5 <- merge(Larval4, MeanTowTime)
MeanTowDepth <- select(Plankton, id, AvgTowDepth)
MeanTowDepth$AvgTowDepth[is.na(MeanTowDepth$AvgTowDepth)] <- 0
Larval6 <- merge(Larval5, MeanTowDepth)
View(Larval6)
Plankton2 <- select(Plankton, id, TowTime)
Plankton2 <- Plankton2 %>% drop_na(TowTime)
MeanTowTime <- aggregate(TowTime~id, Plankton2, mean)
#Left in because this should update the tow time with means
Larval5 <- merge(Larval4, MeanTowTime)
MeanTowDepth <- select(Plankton, id, AvgTowDepth)
MeanTowDepth$AvgTowDepth[is.na(MeanTowDepth$AvgTowDepth)] <- 0
View(MeanTowDepth)
Volume <- select(Plankton, id, Volume)
Larval7 <- merge(Larval5, Volume)
View(Larval7)
View(Larval3)
View(Larval7)
View(Larval7)
Larval6 <- merge(Larval5, Volume)
View(Larval6)
View(Plankton)
#Larval Data
Larval <- read_csv("Full Larval.csv")
Larval$Year <- as.factor(Larval$Year)
Larval$category <- as.factor(Larval$category)
Larval$Survey.No <- as.factor(Larval$Survey.No)
#Plankton Data
Plankton <- read_csv("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Source Data/planktonsamplingData.csv")
View(Larval)
Larval1 <- select(Larval, id, Date, Survey.No, Abundance, Density, TowTime, AvgTowDepth)
View(Larval1)
MeanAgeInDays <- aggregate(AgeInDays~id, Larval, mean)
colnames(MeanAgeInDays)[2]<- "MeanAgeInDays"
MinDateOfSpawn <- aggregate(SpawnDate~id, Larval, min)
Larval$AgeInDays <- ((Larval$Lengthmm - 5)/0.24)
Larval$SpawnDate <- Larval$Date-Larval$AgeInDays
Larval1 <- select(Larval, id, Date, Survey.No, Abundance, Density, TowTime, AvgTowDepth)
MeanAgeInDays <- aggregate(AgeInDays~id, Larval, mean)
colnames(MeanAgeInDays)[2]<- "MeanAgeInDays"
MinDateOfSpawn <- aggregate(SpawnDate~id, Larval, min)
colnames(MinDateOfSpawn)[2] <- "MinDateOfSpawn"
MaxDateOfSpawn <- aggregate(SpawnDate~id, Larval, max)
colnames(MaxDateOfSpawn)[2] <- "MaxDateOfSpawn"
Larval2 <- merge(MeanAgeInDays, MinDateOfSpawn)
Larval3 <- merge(Larval2, MaxDateOfSpawn)
Larval3 <- merge(Larval1, Larval3)
Larval3 <- unique(Larval3)
StartLat <- aggregate(Lat1~id, Plankton, mean)
StartLon <- aggregate(Lon1~id, Plankton, mean)
StartCoords <- merge(StartLat, StartLon)
EndLat <- aggregate(Lat2~id, Plankton, mean)
EndLon <- aggregate(Lon2~id, Plankton, mean)
EndCoords <- merge(EndLat, EndLon)
TowCoords <- merge(StartCoords, EndCoords)
Larval4 <- merge(Larval3, TowCoords)
Plankton <- select(Plankton, id, TowTime, AvgTowDepth, Volume)
Plankton <- Plankton %>% drop_na(id)
Plankton$AvgTowDepth[is.na(Plankton$AvgTowDepth)] <- 0
Plankton2 <- select(Plankton, id, TowTime)
Plankton2 <- Plankton2 %>% drop_na(TowTime)
MeanTowTime <- aggregate(TowTime~id, Plankton2, mean)
#Left in because this should update the tow time with means
Larval5 <- merge(Larval4, MeanTowTime)
Volume <- select(Plankton, id, Volume)
Larval6 <- merge(Larval5, Volume)
Density <-
LarvalSum <- Larval %>% select("Ground", "Year", "id", "Survey.No", "Abundance", "Preservative", "X", "Y", "TowTime", "MeanLength")
LarvalSum <- merge(LarvalSum, Larval6)
LarvalSum <- unique(LarvalSum)
View(LarvalSum)
Density <-
LarvalSum <- Larval %>% select("Ground", "Year", "id", "Survey.No", "Abundance", "Density", "Preservative", "TowTime", "MeanLength")
rm(list = ls())
#Import all packages, CTD data, and land data
#Packages
setwd(paste0("C:/Users/", Sys.info()[7],"/Documents/GitHub/HerringScience.github.io/Main Data/"))
library(cli)
library(lubridate)
library(reprex)
library(tidyverse)
library(geosphere)
library(reshape2)
library(moderndive)
library(skimr)
library(ggridges)
#library(weathercan)
library(GGally)
library(psych)
library(raster)
library(PBSmapping)
#library(rgeos)
library(sf)
library(terra)
library(knitr)
library(kableExtra)
library(grid)
library(gridExtra)
library(cowplot)
library(DT)
library(dygraphs)
library(leaflet)
library(rmapshaper)
library(plotly)
library(mapproj)
library(oce) #new CTD Data package
#Larval Data
Larval <- read_csv("Full Larval.csv")
Larval$Year <- as.factor(Larval$Year)
Larval$category <- as.factor(Larval$category)
Larval$Survey.No <- as.factor(Larval$Survey.No)
#LarvalSI <- filter(Larval, Ground == "SI")
#LarvalSB <- filter(Larval, Ground == "SB")
#LarvalGB <- filter(Larval, Ground == "GB")
#Plankton Data
Plankton <- read_csv("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Source Data/planktonsamplingData.csv")
Larval$AgeInDays <- ((Larval$Lengthmm - 5)/0.24)
Larval$SpawnDate <- Larval$Date-Larval$AgeInDays
Larval1 <- select(Larval, id, Date, Survey.No, Abundance, Density, TowTime, AvgTowDepth)
MeanAgeInDays <- aggregate(AgeInDays~id, Larval, mean)
colnames(MeanAgeInDays)[2]<- "MeanAgeInDays"
MinDateOfSpawn <- aggregate(SpawnDate~id, Larval, min)
colnames(MinDateOfSpawn)[2] <- "MinDateOfSpawn"
MaxDateOfSpawn <- aggregate(SpawnDate~id, Larval, max)
colnames(MaxDateOfSpawn)[2] <- "MaxDateOfSpawn"
Larval2 <- merge(MeanAgeInDays, MinDateOfSpawn)
Larval3 <- merge(Larval2, MaxDateOfSpawn)
Larval3 <- merge(Larval1, Larval3)
Larval3 <- unique(Larval3)
StartLat <- aggregate(Lat1~id, Plankton, mean)
StartLon <- aggregate(Lon1~id, Plankton, mean)
StartCoords <- merge(StartLat, StartLon)
EndLat <- aggregate(Lat2~id, Plankton, mean)
EndLon <- aggregate(Lon2~id, Plankton, mean)
EndCoords <- merge(EndLat, EndLon)
TowCoords <- merge(StartCoords, EndCoords)
Larval4 <- merge(Larval3, TowCoords)
Plankton <- select(Plankton, id, TowTime, AvgTowDepth, Volume)
Plankton <- Plankton %>% drop_na(id)
Plankton$AvgTowDepth[is.na(Plankton$AvgTowDepth)] <- 0
Plankton2 <- select(Plankton, id, TowTime)
Plankton2 <- Plankton2 %>% drop_na(TowTime)
MeanTowTime <- aggregate(TowTime~id, Plankton2, mean)
#Left in because this should update the tow time with means
Larval5 <- merge(Larval4, MeanTowTime)
Volume <- select(Plankton, id, Volume)
Larval6 <- merge(Larval5, Volume)
LarvalSum <- Larval %>% select("Ground", "Year", "id", "Survey.No", "Abundance", "Density", "Preservative", "TowTime", "MeanLength")
LarvalSum <- merge(LarvalSum, Larval6)
LarvalSum <- unique(LarvalSum)
View(LarvalSum)
