# Scots Bay plankton and CTD box
SBplankton=boxes[which(boxes$Box == "SBPlanktonBox"), ]
SBCTD=boxes[which(boxes$Box == "SBocean"), ]
# Scots Bay
SUA = read.csv("polygon_SBEastern.csv")
polyEastern = as.PolySet(SUA, projection="LL")
SUA = read.csv("polygon_SBNorthern.csv")
polyNorthern = as.PolySet(SUA, projection="LL")
SUA = read.csv("polygon_SB.csv")
polySB_main = as.PolySet(SUA, projection="LL")
#German Bank CTD box
GBCTD=boxes[which(boxes$Box == "GBocean"), ]
# German Bank
SUA = read.csv("polygon_GB.csv")
polyGB = as.PolySet(SUA, projection="LL")
# Seal Island
SUA = read.csv("polygon_SI.csv")
polySI = as.PolySet(SUA, projection="LL")
Larval = Larval %>% filter(Ground == "SB")
Larval %>% ggplot(aes(y=Lengthmm, x=Julian, colour = Year)) +
geom_point() +
labs(y="Length (mm)", x="Julian Date of Collection")
ggplot(Larval, aes(Year, Lengthmm, colour = Year)) +
geom_boxplot() +
labs(y="Length (mm)")
Table = Larval %>%
group_by(Year) %>%
summarize(AvgLength = mean(Lengthmm),
AvgSD = mean(SD),
Abundance = n()) %>%
mutate_if(is.numeric, format, digits=2)
kbl(Table, col.names=c("Year", "Mean Length (mm)", "+/- SD (mm)", "Abundance"), align = "c") %>%
kable_paper("striped", full_width = F)
ggplot(Larval, aes(Julian, Lengthmm, colour = Year)) +
geom_jitter(size = 2) +
geom_hline(yintercept = 8, linetype = "longdash", size =1, colour = "red")  +
geom_hline(yintercept = 12, linetype = "longdash", size =1, colour = "blue")  +
geom_hline(yintercept = 17, linetype = "longdash", size =1, colour = "forestgreen") +
geom_hline(yintercept = 27, linetype = "longdash", size =1, colour = "grey70") +
labs(x= "Julian Date of Collection", y = "Length (mm)")
TotalCategories <- Larval %>%
group_by(category) %>%
dplyr::summarize(n = n()) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1) %>%
mutate(Length = ifelse(category==1, "<8",
ifelse(category==2, "8-12",
ifelse(category==3, "13-17",
ifelse(category==4, "18-27",
ifelse(category==5, ">28", NA)))))) %>%
relocate(Length, .after = category) %>%
mutate(Age = ifelse(category==1, "<2 weeks",
ifelse(category==2, "2-5 weeks",
ifelse(category==3, "5-8 weeks",
ifelse(category==4, "8-14 weeks",
ifelse(category==5, ">14 weeks", NA)))))) %>%
relocate(Age, .after = Length)
kbl(TotalCategories, col.names=c("Category", "Length (mm)", "Age", "Abundance", "%"), align = "c") %>%
kable_paper("striped", full_width = F)
ggplot(Larval, aes(Julian, Lengthmm, colour = Year)) +
geom_jitter(size = 5) +
geom_hline(yintercept = 8, linetype = "longdash", size =1, colour = "red")  +
geom_hline(yintercept = 12, linetype = "longdash", size =1, colour = "blue")  +
geom_hline(yintercept = 17, linetype = "longdash", size =1, colour = "forestgreen") +
geom_hline(yintercept = 27, linetype = "longdash", size =1, colour = "grey70") +
labs(x= "Julian Date of Collection", y = "Length (mm)")
TotalCategories <- Larval %>%
group_by(category) %>%
dplyr::summarize(n = n()) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1) %>%
mutate(Length = ifelse(category==1, "<8",
ifelse(category==2, "8-12",
ifelse(category==3, "13-17",
ifelse(category==4, "18-27",
ifelse(category==5, ">28", NA)))))) %>%
relocate(Length, .after = category) %>%
mutate(Age = ifelse(category==1, "<2 weeks",
ifelse(category==2, "2-5 weeks",
ifelse(category==3, "5-8 weeks",
ifelse(category==4, "8-14 weeks",
ifelse(category==5, ">14 weeks", NA)))))) %>%
relocate(Age, .after = Length)
kbl(TotalCategories, col.names=c("Category", "Length (mm)", "Age", "Abundance", "%"), align = "c") %>%
kable_paper("striped", full_width = F)
ggplot(Larval, aes(Julian, Lengthmm, colour = Year)) +
geom_jitter(size = 2, position = "jitter") +
geom_hline(yintercept = 8, linetype = "longdash", size =1, colour = "red")  +
geom_hline(yintercept = 12, linetype = "longdash", size =1, colour = "blue")  +
geom_hline(yintercept = 17, linetype = "longdash", size =1, colour = "forestgreen") +
geom_hline(yintercept = 27, linetype = "longdash", size =1, colour = "grey70") +
labs(x= "Julian Date of Collection", y = "Length (mm)")
TotalCategories <- Larval %>%
group_by(category) %>%
dplyr::summarize(n = n()) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1) %>%
mutate(Length = ifelse(category==1, "<8",
ifelse(category==2, "8-12",
ifelse(category==3, "13-17",
ifelse(category==4, "18-27",
ifelse(category==5, ">28", NA)))))) %>%
relocate(Length, .after = category) %>%
mutate(Age = ifelse(category==1, "<2 weeks",
ifelse(category==2, "2-5 weeks",
ifelse(category==3, "5-8 weeks",
ifelse(category==4, "8-14 weeks",
ifelse(category==5, ">14 weeks", NA)))))) %>%
relocate(Age, .after = Length)
kbl(TotalCategories, col.names=c("Category", "Length (mm)", "Age", "Abundance", "%"), align = "c") %>%
kable_paper("striped", full_width = F)
ggplot(Larval, aes(Julian, Lengthmm, colour = Year)) +
geom_jitter(size = 2, width = 0.25) +
geom_hline(yintercept = 8, linetype = "longdash", size =1, colour = "red")  +
geom_hline(yintercept = 12, linetype = "longdash", size =1, colour = "blue")  +
geom_hline(yintercept = 17, linetype = "longdash", size =1, colour = "forestgreen") +
geom_hline(yintercept = 27, linetype = "longdash", size =1, colour = "grey70") +
labs(x= "Julian Date of Collection", y = "Length (mm)")
TotalCategories <- Larval %>%
group_by(category) %>%
dplyr::summarize(n = n()) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1) %>%
mutate(Length = ifelse(category==1, "<8",
ifelse(category==2, "8-12",
ifelse(category==3, "13-17",
ifelse(category==4, "18-27",
ifelse(category==5, ">28", NA)))))) %>%
relocate(Length, .after = category) %>%
mutate(Age = ifelse(category==1, "<2 weeks",
ifelse(category==2, "2-5 weeks",
ifelse(category==3, "5-8 weeks",
ifelse(category==4, "8-14 weeks",
ifelse(category==5, ">14 weeks", NA)))))) %>%
relocate(Age, .after = Length)
kbl(TotalCategories, col.names=c("Category", "Length (mm)", "Age", "Abundance", "%"), align = "c") %>%
kable_paper("striped", full_width = F)
ggplot(Larval, aes(Julian, Lengthmm, colour = Year)) +
geom_jitter(size = 2, width = 2) +
geom_hline(yintercept = 8, linetype = "longdash", size =1, colour = "red")  +
geom_hline(yintercept = 12, linetype = "longdash", size =1, colour = "blue")  +
geom_hline(yintercept = 17, linetype = "longdash", size =1, colour = "forestgreen") +
geom_hline(yintercept = 27, linetype = "longdash", size =1, colour = "grey70") +
labs(x= "Julian Date of Collection", y = "Length (mm)")
TotalCategories <- Larval %>%
group_by(category) %>%
dplyr::summarize(n = n()) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1) %>%
mutate(Length = ifelse(category==1, "<8",
ifelse(category==2, "8-12",
ifelse(category==3, "13-17",
ifelse(category==4, "18-27",
ifelse(category==5, ">28", NA)))))) %>%
relocate(Length, .after = category) %>%
mutate(Age = ifelse(category==1, "<2 weeks",
ifelse(category==2, "2-5 weeks",
ifelse(category==3, "5-8 weeks",
ifelse(category==4, "8-14 weeks",
ifelse(category==5, ">14 weeks", NA)))))) %>%
relocate(Age, .after = Length)
kbl(TotalCategories, col.names=c("Category", "Length (mm)", "Age", "Abundance", "%"), align = "c") %>%
kable_paper("striped", full_width = F)
ggplot(Larval, aes(Julian, Lengthmm, colour = Year)) +
geom_jitter(size = 2, width = 3.5) +
geom_hline(yintercept = 8, linetype = "longdash", size =1, colour = "red")  +
geom_hline(yintercept = 12, linetype = "longdash", size =1, colour = "blue")  +
geom_hline(yintercept = 17, linetype = "longdash", size =1, colour = "forestgreen") +
geom_hline(yintercept = 27, linetype = "longdash", size =1, colour = "grey70") +
labs(x= "Julian Date of Collection", y = "Length (mm)")
TotalCategories <- Larval %>%
group_by(category) %>%
dplyr::summarize(n = n()) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1) %>%
mutate(Length = ifelse(category==1, "<8",
ifelse(category==2, "8-12",
ifelse(category==3, "13-17",
ifelse(category==4, "18-27",
ifelse(category==5, ">28", NA)))))) %>%
relocate(Length, .after = category) %>%
mutate(Age = ifelse(category==1, "<2 weeks",
ifelse(category==2, "2-5 weeks",
ifelse(category==3, "5-8 weeks",
ifelse(category==4, "8-14 weeks",
ifelse(category==5, ">14 weeks", NA)))))) %>%
relocate(Age, .after = Length)
kbl(TotalCategories, col.names=c("Category", "Length (mm)", "Age", "Abundance", "%"), align = "c") %>%
kable_paper("striped", full_width = F)
ggplot(Larval, aes(Julian, Lengthmm, colour = Year)) +
geom_jitter(size = 1, width = 3.5) +
geom_hline(yintercept = 8, linetype = "longdash", size =1, colour = "red")  +
geom_hline(yintercept = 12, linetype = "longdash", size =1, colour = "blue")  +
geom_hline(yintercept = 17, linetype = "longdash", size =1, colour = "forestgreen") +
geom_hline(yintercept = 27, linetype = "longdash", size =1, colour = "grey70") +
labs(x= "Julian Date of Collection", y = "Length (mm)")
TotalCategories <- Larval %>%
group_by(category) %>%
dplyr::summarize(n = n()) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1) %>%
mutate(Length = ifelse(category==1, "<8",
ifelse(category==2, "8-12",
ifelse(category==3, "13-17",
ifelse(category==4, "18-27",
ifelse(category==5, ">28", NA)))))) %>%
relocate(Length, .after = category) %>%
mutate(Age = ifelse(category==1, "<2 weeks",
ifelse(category==2, "2-5 weeks",
ifelse(category==3, "5-8 weeks",
ifelse(category==4, "8-14 weeks",
ifelse(category==5, ">14 weeks", NA)))))) %>%
relocate(Age, .after = Length)
kbl(TotalCategories, col.names=c("Category", "Length (mm)", "Age", "Abundance", "%"), align = "c") %>%
kable_paper("striped", full_width = F)
ggplot(Larval, aes(Julian, Lengthmm, colour = Year)) +
geom_jitter(size = 0.5, width = 3.5) +
geom_hline(yintercept = 8, linetype = "longdash", size =1, colour = "red")  +
geom_hline(yintercept = 12, linetype = "longdash", size =1, colour = "blue")  +
geom_hline(yintercept = 17, linetype = "longdash", size =1, colour = "forestgreen") +
geom_hline(yintercept = 27, linetype = "longdash", size =1, colour = "grey70") +
labs(x= "Julian Date of Collection", y = "Length (mm)")
TotalCategories <- Larval %>%
group_by(category) %>%
dplyr::summarize(n = n()) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1) %>%
mutate(Length = ifelse(category==1, "<8",
ifelse(category==2, "8-12",
ifelse(category==3, "13-17",
ifelse(category==4, "18-27",
ifelse(category==5, ">28", NA)))))) %>%
relocate(Length, .after = category) %>%
mutate(Age = ifelse(category==1, "<2 weeks",
ifelse(category==2, "2-5 weeks",
ifelse(category==3, "5-8 weeks",
ifelse(category==4, "8-14 weeks",
ifelse(category==5, ">14 weeks", NA)))))) %>%
relocate(Age, .after = Length)
kbl(TotalCategories, col.names=c("Category", "Length (mm)", "Age", "Abundance", "%"), align = "c") %>%
kable_paper("striped", full_width = F)
ggplot(Larval, aes(Julian, Lengthmm, colour = Year)) +
geom_jitter(size = 1.25, width = 4) +
geom_hline(yintercept = 8, linetype = "longdash", size =1, colour = "red")  +
geom_hline(yintercept = 12, linetype = "longdash", size =1, colour = "blue")  +
geom_hline(yintercept = 17, linetype = "longdash", size =1, colour = "forestgreen") +
geom_hline(yintercept = 27, linetype = "longdash", size =1, colour = "grey70") +
labs(x= "Julian Date of Collection", y = "Length (mm)")
TotalCategories <- Larval %>%
group_by(category) %>%
dplyr::summarize(n = n()) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1) %>%
mutate(Length = ifelse(category==1, "<8",
ifelse(category==2, "8-12",
ifelse(category==3, "13-17",
ifelse(category==4, "18-27",
ifelse(category==5, ">28", NA)))))) %>%
relocate(Length, .after = category) %>%
mutate(Age = ifelse(category==1, "<2 weeks",
ifelse(category==2, "2-5 weeks",
ifelse(category==3, "5-8 weeks",
ifelse(category==4, "8-14 weeks",
ifelse(category==5, ">14 weeks", NA)))))) %>%
relocate(Age, .after = Length)
kbl(TotalCategories, col.names=c("Category", "Length (mm)", "Age", "Abundance", "%"), align = "c") %>%
kable_paper("striped", full_width = F)
ggplot(Larval, aes(Julian, Lengthmm, colour = Year)) +
geom_jitter(size = 1.25, width = 4, height = 2) +
geom_hline(yintercept = 8, linetype = "longdash", size =1, colour = "red")  +
geom_hline(yintercept = 12, linetype = "longdash", size =1, colour = "blue")  +
geom_hline(yintercept = 17, linetype = "longdash", size =1, colour = "forestgreen") +
geom_hline(yintercept = 27, linetype = "longdash", size =1, colour = "grey70") +
labs(x= "Julian Date of Collection", y = "Length (mm)")
TotalCategories <- Larval %>%
group_by(category) %>%
dplyr::summarize(n = n()) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1) %>%
mutate(Length = ifelse(category==1, "<8",
ifelse(category==2, "8-12",
ifelse(category==3, "13-17",
ifelse(category==4, "18-27",
ifelse(category==5, ">28", NA)))))) %>%
relocate(Length, .after = category) %>%
mutate(Age = ifelse(category==1, "<2 weeks",
ifelse(category==2, "2-5 weeks",
ifelse(category==3, "5-8 weeks",
ifelse(category==4, "8-14 weeks",
ifelse(category==5, ">14 weeks", NA)))))) %>%
relocate(Age, .after = Length)
kbl(TotalCategories, col.names=c("Category", "Length (mm)", "Age", "Abundance", "%"), align = "c") %>%
kable_paper("striped", full_width = F)
ggplot(Larval, aes(Julian, Lengthmm, colour = Year)) +
geom_jitter(size = 1.25, width = 3) +
geom_hline(yintercept = 8, linetype = "longdash", size =1, colour = "red")  +
geom_hline(yintercept = 12, linetype = "longdash", size =1, colour = "blue")  +
geom_hline(yintercept = 17, linetype = "longdash", size =1, colour = "forestgreen") +
geom_hline(yintercept = 27, linetype = "longdash", size =1, colour = "grey70") +
labs(x= "Julian Date of Collection", y = "Length (mm)")
TotalCategories <- Larval %>%
group_by(category) %>%
dplyr::summarize(n = n()) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1) %>%
mutate(Length = ifelse(category==1, "<8",
ifelse(category==2, "8-12",
ifelse(category==3, "13-17",
ifelse(category==4, "18-27",
ifelse(category==5, ">28", NA)))))) %>%
relocate(Length, .after = category) %>%
mutate(Age = ifelse(category==1, "<2 weeks",
ifelse(category==2, "2-5 weeks",
ifelse(category==3, "5-8 weeks",
ifelse(category==4, "8-14 weeks",
ifelse(category==5, ">14 weeks", NA)))))) %>%
relocate(Age, .after = Length)
kbl(TotalCategories, col.names=c("Category", "Length (mm)", "Age", "Abundance", "%"), align = "c") %>%
kable_paper("striped", full_width = F)
Larval %>%
ggplot(aes(Lengthmm, AvgTowDepth, colour = category)) +
geom_point() +
scale_y_reverse() +
labs(x = "Length (mm)", y = "Average Tow Depth (m)", colour = "Category")
TotalCategories <- Larval %>%
group_by(category) %>%
summarize(n = n(),
MeanDepth = mean(AvgTowDepth, na.rm = TRUE)) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1) %>%
relocate(MeanDepth, .after= Percentage)
kbl(TotalCategories, col.names=c("Category", "Abundance", "%", "Avg Tow Depth (m)"), align = "c") %>%
kable_paper("striped", full_width = F)
Larval %>%
ggplot(aes(Lengthmm, AvgTowDepth, colour = category)) +
geom_jitter() +
scale_y_reverse() +
labs(x = "Length (mm)", y = "Average Tow Depth (m)", colour = "Category")
TotalCategories <- Larval %>%
group_by(category) %>%
summarize(n = n(),
MeanDepth = mean(AvgTowDepth, na.rm = TRUE)) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1) %>%
relocate(MeanDepth, .after= Percentage)
kbl(TotalCategories, col.names=c("Category", "Abundance", "%", "Avg Tow Depth (m)"), align = "c") %>%
kable_paper("striped", full_width = F)
Larval %>%
ggplot(aes(Lengthmm, AvgTowDepth, colour = category)) +
geom_jitter(height = 2) +
scale_y_reverse() +
labs(x = "Length (mm)", y = "Average Tow Depth (m)", colour = "Category")
TotalCategories <- Larval %>%
group_by(category) %>%
summarize(n = n(),
MeanDepth = mean(AvgTowDepth, na.rm = TRUE)) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1) %>%
relocate(MeanDepth, .after= Percentage)
kbl(TotalCategories, col.names=c("Category", "Abundance", "%", "Avg Tow Depth (m)"), align = "c") %>%
kable_paper("striped", full_width = F)
Larval %>%
ggplot(aes(Lengthmm, AvgTowDepth, colour = category)) +
geom_jitter(height = 0.25) +
scale_y_reverse() +
labs(x = "Length (mm)", y = "Average Tow Depth (m)", colour = "Category")
TotalCategories <- Larval %>%
group_by(category) %>%
summarize(n = n(),
MeanDepth = mean(AvgTowDepth, na.rm = TRUE)) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1) %>%
relocate(MeanDepth, .after= Percentage)
kbl(TotalCategories, col.names=c("Category", "Abundance", "%", "Avg Tow Depth (m)"), align = "c") %>%
kable_paper("striped", full_width = F)
## Global options
rm(list = ls())
#Change these options
surv = "SB"
surv2 = "Scots Bay"
surv.date = "2023-05-18 22:00"
surv.no = "1"
Allocation = "0" #set to "0" for a non-fishing survey
SIAllocation = "75"
vessels = 5
EVessel = "Morning Star"
NVessel = "Fundy Monarch"
PlanktonVessel = "Morning Star"
Tagging = NA
knitr::opts_knit$set(root.dir = paste0("C:/Users/", Sys.info()[7],"/Documents/GitHub/HerringScience.github.io/"))
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE, fig.align='center')
#Import all packages and data
library(cli)
library(lubridate)
library(reprex)
library(tidyverse)
library(geosphere)
library(reshape2)
library(moderndive)
library(skimr)
library(ggridges)
library(weathercan)
library(GGally)
library(psych)
library(raster)
library(PBSmapping)
library(rgeos)
library(knitr)
library(kableExtra)
library(grid)
library(gridExtra)
library(cowplot)
#Parse date time
surv.date = as.POSIXlt(surv.date, format="%Y-%m-%d %H:%M")
StartTime = substr(surv.date, 12,16)
StartDate = substr(surv.date, 1,10)
year = substr(surv.date, 1,4)
#Load plan
setwd(paste0("C:/Users/", Sys.info()[7],"/Documents/GitHub/HerringScience.github.io/Surveys/", year, "/", surv, surv.no, "/"))
Plan = list.files(pattern = "*plan.csv") %>%
map_df(~read_csv(.))
Plan = Plan %>% filter(!is.na(Vessel))
Table = list.files(pattern = "*Table.csv") %>%
map_df(~read_csv(.))
Table = Table %>% filter(!is.na(Vessel))
#Land Data
setwd(paste0("C:/Users/", Sys.info()[7], "/Documents/GitHub/HerringScience.github.io/"))
can<-getData('GADM', country="CAN", level=1)
us = getData('GADM', country = "USA", level = 1)
can1 = rbind(can,us)
NBNS <- can1[can1@data$NAME_1%in%c("New Brunswick","Nova Scotia","Prince Edward Island","Newfoundland and Labrador","QuÃ©bec", "Maine"),]
# Proper coordinates for German Bank
GBMap <- as(extent(-66.5, -65.5, 43, 44), "SpatialPolygons")
proj4string(GBMap) <- CRS(proj4string(NBNS))
GBout <- gIntersection(NBNS, GBMap, byid=TRUE)
# Proper coordinates for Scots Bay
SBMap <- as(extent(-65.5, -64.5, 45, 45.5), "SpatialPolygons")
proj4string(SBMap) <- CRS(proj4string(NBNS))
SBout <- gIntersection(NBNS, SBMap, byid=TRUE)
#Make CTD Cast Box (GB or SB)
a = c("4334.320", "4333.600", "4333.600", "4334.320")
b = c("6622.080", "6622.080", "6621.000", "6621.000")
c = c("4503.432", "4503.000", "4503.000", "4503.432")
d = c("6513.048", "6513.048", "6512.000", "6512.000")
if(surv == "SB") {
CTDBox = data.frame(c,d)
names(CTDBox) = c('Lat', 'Lon')
}
if(surv == "GB") {
CTDBox = data.frame(a,b)
names(CTDBox) = c('Lat', 'Lon')
}
#Make Tow Box (SB only)
a = c("4501.800", "4504.200", "4506.780", "4504.500")
b = c("6515.300", "6506.600", "6506.600", "6515.300")
TowBox = data.frame(a,b)
names(TowBox) = c('Lat', 'Lon')
#Import All Boxes
setwd(paste0("C:/Users/", Sys.info()[7], "/Documents/GitHub/HerringScience.github.io/Box Coordinates/"))
boxes = read.csv("surveyBoxes.csv")
# Scots Bay plankton and CTD box
SBplankton=boxes[which(boxes$Box == "SBPlanktonBox"), ]
SBCTD=boxes[which(boxes$Box == "SBocean"), ]
# Scots Bay
SUA = read.csv("polygon_SBEastern.csv")
polyEastern = as.PolySet(SUA, projection="LL")
SUA = read.csv("polygon_SBNorthern.csv")
polyNorthern = as.PolySet(SUA, projection="LL")
SUA = read.csv("polygon_SB.csv")
polySB_main = as.PolySet(SUA, projection="LL")
#German Bank CTD box
GBCTD=boxes[which(boxes$Box == "GBocean"), ]
# German Bank
SUA = read.csv("polygon_GB.csv")
polyGB = as.PolySet(SUA, projection="LL")
# Seal Island
SUA = read.csv("polygon_SI.csv")
polySI = as.PolySet(SUA, projection="LL")
Plan2 = Plan %>%
dplyr::select(X = "Start Lon", Y = "Start Lat", Xend = "End Lon", Yend = "End Lat", Vessel)
if(surv=="GB"){a = ggplot(Plan2, aes(x=X, y=Y)) +
geom_polygon(data=GBout,aes(x=long, y=lat, group=group), fill = "gray") +
geom_polygon(data=GBCTD,aes(x=X, y=Y, group=PID),fill='white',col='black') +
geom_segment(data=Plan2, aes(x = X, y = Y, xend = Xend, yend = Yend, colour = Vessel), size=0.5) +
coord_map() +
labs(x=NULL, y=NULL, caption = "Figure 1. Survey lines to be completed by participating vessels.")}
if(surv=="SB"){a = ggplot(Plan2, aes(x=X, y=Y)) +
geom_polygon(data=SBout,aes(x=long, y=lat, group=group), fill = "gray") +
geom_polygon(data=SBplankton,aes(x=X, y=Y, group=PID),fill='white',col='black') +
geom_polygon(data=SBCTD,aes(x=X, y=Y, group=PID),fill='white',col='black') +
geom_segment(data=Plan2, aes(x = X, y = Y, xend = Xend, yend = Yend, colour = Vessel), size=0.5) +
coord_map() +
labs(x=NULL, y=NULL, caption = "Figure 1. Survey lines to be completed by participating vessels.")}
print(a)
Plan2 = Plan %>%
dplyr::select(X = "Start Lon", Y = "Start Lat", Xend = "End Lon", Yend = "End Lat", Vessel)
if(surv=="GB"){a = ggplot(Plan2, aes(x=X, y=Y)) +
geom_polygon(data=GBout,aes(x=long, y=lat, group=group), fill = "gray") +
geom_polygon(data=GBCTD,aes(x=X, y=Y, group=PID),fill='white',col='black') +
geom_segment(data=Plan2, aes(x = X, y = Y, xend = Xend, yend = Yend, colour = Vessel), size=0.5) +
coord_map() +
labs(x=NULL, y=NULL, caption = "Figure 1. Survey lines to be completed by participating vessels.")}
if(surv=="SB"){a = ggplot(Plan2, aes(x=X, y=Y)) +
geom_polygon(data=SBout,aes(x=long, y=lat, group=group), fill = "gray") +
geom_polygon(data=SBplankton,aes(x=X, y=Y, group=PID),fill='white',col='black') +
geom_polygon(data=polySB_main,aes(x=X, y=Y, group=PID),fill='white',col='black') +
geom_polygon(data=polyNorthern,aes(x=X, y=Y, group=PID),fill='white',col='black') +
geom_polygon(data=SBCTD,aes(x=X, y=Y, group=PID),fill='white',col='black') +
geom_segment(data=Plan2, aes(x = X, y = Y, xend = Xend, yend = Yend, colour = Vessel), size=0.5) +
coord_map() +
labs(x=NULL, y=NULL, caption = "Figure 1. Survey lines to be completed by participating vessels.")}
print(a)
