AvgSD = mean(SD),
Abundance = n()) %>%
mutate_if(is.numeric, format, digits=2)
kbl(Table, col.names=c("Year", "Min Length (mm)", "Max Length (mm)", "Mean Length (mm)", "+/- SD (mm)", "Abundance"), align = "c") %>%
kable_paper("striped", full_width = F)
for(i in unique(Larval$Year)) {
cat("\n")
cat("#####", i, "\n")
cat("\n")
Larval1 = LarvalSI %>% filter(Year == i)
print(ggplot(data = Larval1, (aes(Lengthmm))) +
geom_histogram(binwidth=0.5, colour = "white") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
labs(x = "Length (mm)", y="Count"))
cat("\n")
print(ggplot(data=Larval1, aes(Lengthmm, colour = Survey.No)) +
geom_freqpoly(bins=100, linewidth = 1) +
labs(y="Count", x="Length (mm)"))
cat("\n")
Table = Larval1 %>%
group_by(Survey.No) %>%
summarize(AvgLength = mean(Lengthmm),
AvgSD = mean(SD),
Abundance = n()) %>%
mutate_if(is.numeric, format, digits=2)
print(kbl(Table, col.names=c("Survey #", "Mean Length (mm)", "+/- SD (mm)", "Abundance"), align = "c") %>%
kable_paper("striped", full_width = F))
cat("\n")
}
ggplot(Larval, aes(Julian, Lengthmm, colour = Year)) +
geom_jitter(size = 2) +
scale_x_continuous(labels = scales::label_number(1), limits = c(284, 288)) +
geom_hline(yintercept = 8, linetype = "longdash", size =1, colour = "red")  +
geom_hline(yintercept = 12, linetype = "longdash", size =1, colour = "blue")  +
geom_hline(yintercept = 17, linetype = "longdash", size =1, colour = "forestgreen") +
geom_hline(yintercept = 27, linetype = "longdash", size =1, colour = "grey70") +
labs(x= "Julian Date of Collection", y = "Length (mm)")
TotalCategories <- Larval %>%
group_by(category) %>%
dplyr::summarize(n = n()) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1) %>%
mutate(Length = ifelse(category==1, "<8",
ifelse(category==2, "8-12",
ifelse(category==3, "12-17",
ifelse(category==4, "17-27",
ifelse(category==5, ">27", NA)))))) %>%
relocate(Length, .after = category)
kbl(TotalCategories, col.names=c("Category", "Length (mm)", "Abundance", "%"), align = "c") %>%
kable_paper("striped", full_width = F)
for(i in unique(Larval$Year)) {
cat("\n")
cat("#####", i, "\n")
cat("\n")
Larval1 = LarvalSI %>% filter(Year == i)
print(ggplot(Larval1, aes(Julian, Lengthmm)) +
geom_jitter(size = 2) +
scale_x_continuous(labels = scales::label_number(1), limits = c(284, 288)) +
geom_hline(yintercept = 8, linetype = "longdash", size =1, colour = "red")  +
geom_hline(yintercept = 12, linetype = "longdash", size =1, colour = "blue")  +
geom_hline(yintercept = 17, linetype = "longdash", size =1, colour = "forestgreen") +
geom_hline(yintercept = 27, linetype = "longdash", size =1, colour = "grey70") +
labs(x= "Julian Date of Collection", y = "Length (mm)"))
cat("\n")
TotalCategories <- Larval1 %>%
group_by(category) %>%
dplyr::summarize(n = n()) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1)
print(kbl(TotalCategories, col.names=c("Category", "Abundance", "%"), align = "c") %>%
kable_paper("striped", full_width = F))
cat("\n")
}
CP <- as(extent(-66.5, -65.5, 43, 44), "SpatialPolygons") #set boundaries for German Bank before plotting
proj4string(CP) <- CRS(proj4string(NBNS))
out <- crop(NBNS, CP, byid=TRUE)
Larval2 <- subset(Larval, Ground == 'SI')
ggplot(Larval2, aes(x=X, y=Y)) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
geom_polygon(data=polyGB,aes(x=X, y=Y, group=PID), colour = "black", fill="white",linetype = 3) +
geom_polygon(data=GBCTD,aes(x=X, y=Y, group=PID), colour = "black", fill = "white", linetype = 3) +
geom_polygon(data=polySI,aes(x=X, y=Y, group=PID), colour = "black", fill="white",linetype = 3) +
geom_point(data=Larval2, aes(fill = Year, size = Abundance), pch=21, alpha = 0.6) +
labs(x=NULL, y=NULL) +
coord_map()
TotalCategories <- Larval2 %>%
group_by(category) %>%
dplyr::summarize(n = n()) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1) %>%
mutate(Length = ifelse(category==1, "<8",
ifelse(category==2, "8-12",
ifelse(category==3, "12-17",
ifelse(category==4, "17-27",
ifelse(category==5, ">27", NA)))))) %>%
relocate(Length, .after = category)
kbl(TotalCategories, col.names=c("Category", "Length (mm)", "Abundance", "%"), align = "c") %>%
kable_paper("striped", full_width = F)
for(i in unique(Larval$Year)) {
cat("\n")
cat("#####", i, "\n")
cat("\n")
Larval1 = Larval %>% filter(Year == i) %>% filter()
print(ggplot(Larval1, aes(x=X, y=Y)) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
geom_polygon(data=GBCTD,aes(x=X, y=Y, group=PID), colour = "black", fill = "white", linetype = 3) +
geom_polygon(data=polyGB,aes(x=X, y=Y, group=PID), colour = "black", fill="white",linetype = 3) +
geom_polygon(data=polySI,aes(x=X, y=Y, group=PID), colour = "black", fill="white",linetype = 3) +
geom_point(data=Larval1, aes(fill = category, size = Abundance), pch=21, alpha = 0.6) +
labs(x=NULL, y=NULL) +
coord_map())
cat("\n")
TotalCategories <- Larval1 %>%
group_by(category) %>%
dplyr::summarize(n = n()) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1)
print(kbl(TotalCategories, col.names=c("Category", "Abundance", "%"), align = "c") %>%
kable_paper("striped", full_width = F))
cat("\n")
}
LarvalSI %>%
ggplot(aes(Lengthmm, AvgTowDepth, colour = category)) +
geom_point() +
scale_y_reverse() +
labs(x = "Length (mm)", y = "Average Tow Depth (m)", colour = "Category")
TotalCategories <- LarvalSI %>%
group_by(category) %>%
summarize(n = n(),
MeanDepth = mean(AvgTowDepth, na.rm = TRUE)) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1) %>%
relocate(MeanDepth, .after= Percentage)
kbl(TotalCategories, col.names=c("Category", "Abundance", "%", "Avg Tow Depth (m)"), align = "c") %>%
kable_paper("striped", full_width = F)
for(i in unique(Larval$Year)) {
cat("\n")
cat("#####", i, "\n")
cat("\n")
Larval1 = Larval %>% filter(Year == i)
print(ggplot(data=Larval1, (aes(Lengthmm, AvgTowDepth, colour = category))) +
geom_point() +
scale_y_reverse() +
labs(x = "Length (mm)", y = "Average Tow Depth (m)", colour = "Category"))
cat("\n")
TotalCategories <- Larval1 %>%
group_by(category) %>%
summarize(n = n(),
MeanDepth = mean(AvgTowDepth, na.rm = TRUE)) %>%
mutate(Percentage = (n/sum(n))*100) %>%
mutate_if(is.numeric, format, digits = 1) %>%
relocate(MeanDepth, .after= Percentage)
print(kbl(TotalCategories, col.names=c("Category", "Abundance", "%", "Avg Tow Depth (m)"), align = "c") %>%
kable_paper("striped", full_width = F))
cat("\n")
}
ggplot(Larval, aes(LastLength, ..density.., colour = Survey.No)) +
geom_freqpoly(binwidth = 0.5, lwd = 1) +
ggtitle("Density") +
labs(y="Density", x="Growth Rate Applied Length (mm)")
ggplot(Larval, aes(LastLength, colour = Survey.No)) +
geom_freqpoly(binwidth = 0.5, lwd = 1) +
ggtitle("Count") +
labs(y="Count", x="Growth Rate Applied Length (mm)")
Larval %>% ggplot(aes(JulianMax, JulianMin, colour = category)) +
geom_point(alpha = 0.45, size = 5) +
ggtitle("Min and Max") +
labs(x = "Max Estimated Julian Date", y= "Min Estimated Julian Date")
for(i in unique(Larval$Year)) {
cat("\n")
cat("#####", i, "\n")
cat("\n")
cat("Growth applied to compare spawning modes.")
Larval1 = Larval %>% filter(Year == i)
print(ggplot(Larval1, aes(LastLength, ..density.., colour = Survey.No)) +
geom_freqpoly(binwidth = 0.5, lwd = 1) +
ggtitle(paste("German Bank Density")) +
labs(y="Density", x="Growth Rate Applied Length (mm)"))
cat("\n")
print(ggplot(Larval1, aes(LastLength, colour = Survey.No)) +
geom_freqpoly(binwidth = 0.5, lwd = 1) +
ggtitle(paste("German Bank Count")) +
labs(y="Count", x="Growth Rate Applied Length (mm)"))
cat("\n")
print(ggplot(data=Larval1, (aes(JulianMax, JulianMin, colour = category))) +
geom_point(alpha = 0.45, size = 5) +
ggtitle(paste("German Bank Estimated Julian Date.")) +
labs(x = "Max Estimated Julian Date", y= "Min Estimated Julian Date"))
cat("\n")
}
can<-getData('GADM', country="CAN", level=1)
us = getData('GADM', country = "USA", level = 1)
can1 = rbind(can,us)
NBNS <- can1[can1@data$NAME_1%in%c("New Brunswick","Nova Scotia","Prince Edward Island","Newfoundland and Labrador","QuÃ©bec", "Maine", "New Hampshire", "Massachusetts", "Connecticut", "Rhode Island", "New York", "Vermont", "New Jersey"),]
CP <- as(extent(-73, -61, 40.5, 46), "SpatialPolygons")
proj4string(CP) <- CRS(proj4string(NBNS))
out <- crop(NBNS, CP, byid=TRUE)
pal <- colorNumeric(
palette = "Reds",
domain = FatData$Fat)
FatDataSum = FatData %>%
group_by(Date, Lat, Lon) %>%
summarize(Fat = mean(Fat))
leaflet(FatDataSum, options = leafletOptions(preferCanvas = TRUE)) %>%
addCircles(data = subset(FatDataSum, Lat > 40 & Lat < 47), color=~pal(Fat), popup = ~as.character(Fat)) %>%
addProviderTiles(providers$CartoDB.Positron, options = providerTileOptions(updateWhenZooming = FALSE, updateWhenIdle = TRUE)) %>%
clearBounds() %>%
addLegend("bottomright", pal = pal, values = ~Fat,
title = "Fat Percent (%)",
labFormat = labelFormat(suffix = "%"),
opacity = 1)
FatData %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData, Lat < 46 & Lat > 40 & Month == 8), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
}
FatData %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData, Lat < 46 & Lat > 40 & Month == 8), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
FatData %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData, Lat < 46 & Lat > 40 & Month == 1), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
FatData %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData, Lat < 46 & Lat > 40 & Month == 6), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
FatData %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData, Lat < 46 & Lat > 40 & Month == 2), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
FatData %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData, Lat < 46 & Lat > 40 & Month == 3), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
FatData %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData, Lat < 46 & Lat > 40 & Month == 4), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
FatData %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData, Lat < 46 & Lat > 40 & Month == 5), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
FatData %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData, Lat < 46 & Lat > 40 & Month == 6), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
FatData %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData, Lat < 46 & Lat > 40 & Month == 7), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
FatData %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData, Lat < 46 & Lat > 40 & Month == 8), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
FatData %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData, Lat < 46 & Lat > 40 & Month == 9), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
FatData %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData, Lat < 46 & Lat > 40 & Month == 10, aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom'))
FatData %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData, Lat < 46 & Lat > 40 & Month == 9), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
FatData %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData, Lat < 46 & Lat > 40 & Month == 10), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
FatData %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData, Lat < 46 & Lat > 40 & Month == 11), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
FatData %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData, Lat < 46 & Lat > 40 & Month == 12), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
for(i in unique(Larval$Year)) {
cat("\n")
cat("#####", i, "\n")
cat("\n")
FatData2 = FatData %>% filter(Year == i)
print(FatData2 %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData2, Lat < 46 & Lat > 40), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom'))
cat("\n")
}
for(i in unique(FatDatal$Year)) {
cat("\n")
cat("#####", i, "\n")
cat("\n")
FatData2 = FatData %>% filter(Year == i)
print(FatData2 %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData2, Lat < 46 & Lat > 40), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom'))
cat("\n")
}
for(i in unique(Larval$Year)) {
cat("\n")
cat("#####", i, "\n")
cat("\n")
FatData2 = FatData %>% filter(Year == i)
print(FatData2 %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData2, Lat < 46 & Lat > 40), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom'))
cat("\n")
}
for(i in unique(FatDatal$Year)) {
cat("\n")
cat("#####", i, "\n")
cat("\n")
cat("Fat Data")
FatData1 = FatData %>% filter(Year == i)
FatData %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData, Lat < 46 & Lat > 40 & Month == 1), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
cat("\n")
}
FatData1 = FatData %>% filter(Year == i)
for(i in unique(FatDatal$Year)) {
cat("\n")
cat("#####", i, "\n")
cat("\n")
cat("Fat Data")
FatData1 = FatData %>% filter(Year == i)
FatData1 %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData1, Lat < 46 & Lat > 40 & Month == 1), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
cat("\n")
}
for(i in unique(FatData$Year)) {
cat("\n")
cat("#####", i, "\n")
cat("\n")
cat("Fat Data")
FatData1 = FatData %>% filter(Year == i)
FatData1 %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData1, Lat < 46 & Lat > 40 & Month == 1), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
cat("\n")
}
View(FatData1)
for(i in unique(FatData$Year)) {
cat("\n")
cat("#####", i, "\n")
cat("\n")
cat("Fat Data")
FatData1 = FatData %>% filter(Year == i)
FatData1 %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData1, Lat < 46 & Lat > 40 & Month == 1 & Year == i), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom')
cat("\n")
}
for(i in unique(Larval$Year)) {
cat("\n")
cat("#####", i, "\n")
cat("\n")
FatData1 = FatData %>% filter(Year == i)
print(FatData1 %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData1, Lat < 46 & Lat > 40 & Month == 1 & Year == i), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom'))
cat("\n")
}
for(i in unique(FatData$Year)) {
cat("\n")
cat("#####", i, "\n")
cat("\n")
FatData1 = FatData %>% filter(Year == i)
print(FatData1 %>%
ggplot(aes(x=Lon, y=Lat)) +
geom_polygon(data=polysT,aes(x=X, y=Y, group=Box, fill = Box), colour = "black") +
geom_point(data=subset(FatData1, Lat < 46 & Lat > 40 & Month == 1 & Year == i), aes(color=Fat)) +
scale_color_viridis_c(direction=-1) +
geom_polygon(data=out,aes(x=long, y=lat, group=group)) +
coord_map() +
theme(legend.position = 'bottom'))
cat("\n")
}
ggplot(data = subset(SST, Ground == "Scots Bay" & In_Box == "1"), aes(x = Julian, y = Temperature, colour = Year)) +
geom_point() +
geom_line() +
ylab("Average Sea Surface Temperature") +
xlab("Julian Day") +
ggtitle("Scots Bay")
Summer = SST %>%
subset(Ground == "Scots Bay" & In_Box == "1" & Month == "8")
ggplot(data = Summer, aes(x=Year, y=Temperature, group = Year, colour = Year))+
geom_boxplot() +
ylab("Average Sea Surface Temperature") +
ggtitle("August SST") +
stat_summary(fun.y = median, fun.ymax = length,
geom = "text", aes(label = ..ymax..), vjust = -0.5) +
ylim(8.5,16.5)
ggplot(data = subset(SST, Ground == "Scots Bay" & In_Box == "1"), aes(x=Year, y=Temperature, group = Year, colour = Year)) +
geom_boxplot() +
facet_wrap(~Month) +
ylim(7.5, 15.5) +
stat_summary(fun.y = median, fun.ymax = length,
geom = "text", aes(label = ..ymax..), vjust = -1) +
labs(x="Year", y = "Sea Surface Temperature (SST) (C)", title = "Scots Bay: Monthly SST vs. Year") +
theme(axis.text.x = element_text(angle = 55))
