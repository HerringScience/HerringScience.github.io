TotalBiomass <- subset(TotalBiomass, Survey_Date < '2023-05-22')
GermanBankTotalBiomass <- subset(TotalBiomass, Ground == "GB")
GermanBankTotalBiomass <- GermanBankTotalBiomass %>% group_by(Year) %>% add_count(Year)
aggregateGB <- aggregate(GermanBankTotalBiomass$DFO_Turnover_Adjusted, list(GermanBankTotalBiomass$Year), FUN=(sum))
colnames(aggregateGB)<-c("Year", "DFO_Turnover_Adjusted")
PeakBiomass <- subset(Survey_Factors, select = c("Survey_Date", "Year","Ground", "DFO_Estimate", "DFO_Turnover_Adjusted"))
PeakBiomass <- na.omit(PeakBiomass)
PeakBiomass <- subset(PeakBiomass, Survey_Date < '2023-05-22')
GermanBankPeakBiomass <- subset(PeakBiomass, Ground == "GB")
GermanBankPeakBiomass <- GermanBankPeakBiomass %>% group_by(Year) %>% slice_max(DFO_Turnover_Adjusted)
ThreeYearRollingBiomass <- aggregateGB %>%
arrange(Year) %>%
mutate(avg_biomass3 = rollmean(DFO_Turnover_Adjusted, k = 3, fill = NA, align = 'right'))
ThreeYearRollingBiomassGraph <- print(ggplot(ThreeYearRollingBiomass, aes(x=Year, y=DFO_Turnover_Adjusted)) +
geom_point() +
geom_line())
GermanBankPeakBiomass <- GermanBankPeakBiomass %>% select(Year, DFO_Turnover_Adjusted)
GermanBankPeakBiomass <- ungroup(GermanBankPeakBiomass)
ThreeYearRollingPeak <- GermanBankPeakBiomass %>%
arrange(Year) %>%
mutate(avg_biomass3 = rollmean(DFO_Turnover_Adjusted, k = 3, fill = NA, align = 'right'))
ThreeYearRollingPeakGraph <- print(ggplot(ThreeYearRollingPeak, aes(x=Year, y=avg_biomass3)) +
geom_point()+
geom_line())
CombinedPlot3 <- merge(ThreeYearRollingBiomass, ThreeYearRollingPeak, by="Year")
CombinedPlot4 <- print(ggplot(CombinedPlot3, aes(x=Year))+
geom_line(aes(y=avg_biomass3.x, colour = "German Bank Three Year rolling Average Yearly Biomass")) +
geom_line(aes(y=avg_biomass3.y, colour = "German Bank Three Year rolling Average Peak Biomass")) +
labs(x = "Year", y = "Total Biomass (mt)"))
library(rlang)
library(cli)
library(lubridate)
library(reprex)
library(tidyverse)
library(geosphere)
library(reshape2)
library(moderndive)
library(skimr)
library(ggridges)
#library(weathercan)
library(GGally)
library(psych)
library(sp)
library(raster)
library(PBSmapping)
#library(rgeos) - replaced by terra and sf
library(knitr)
library(kableExtra)
library(grid)
library(gridExtra)
library(cowplot)
library(readxl)
library(hms)
library(measurements)
library(ggplot2)
library(maps)
library(dplyr)
library(RColorBrewer)
library(AICcmodavg)
library(datasets)
library(terra)
library(multcompView)
library(sf)
library(zoo)
library(ggrepel)
###remove everything in environment
rm(list = ls())
options(scipen = 999)
setwd("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder")
Survey_Factors <- read_csv("surveyFactorsAll_Tracey with SSB data.csv")
Survey_Data <- read_csv("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Main Data/Survey Data.csv")
View(Survey_Factors)
Survey_Factors$Julian = as.POSIXlt(Survey_Factors$Survey_Date)$yday
View(Survey_Factors)
###remove everything in environment
rm(list = ls())
options(scipen = 999)
setwd("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder")
Survey_Factors <- read_csv("surveyFactorsAll_Tracey with SSB data.csv")
Survey_Factors$Julian = as.POSIXlt(Survey_Factors$Survey_Date)$yday
View(Survey_Factors)
JulianAndBiomass <- subset(Survey_Factors, select=c("Survey_Date", "Ground", "Julian", "DFO_Estimate")) +
JulianAndBiomass <- na.omit(JulianAndBiomass)
JulianAndBiomass <- subset(Survey_Factors, select=c("Survey_Date", "Ground", "Julian", "DFO_Estimate")) +
JulianAndBiomass <- na.omit(JulianAndBiomass)
Survey_Data <- read_csv("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Main Data/Survey Data.csv")
JulianAndBiomass <- subset(Survey_Factors, select=c("Survey_Date", "Ground", "Julian", "DFO_Estimate")) +
JulianAndBiomass <- na.omit(JulianAndBiomass)
JulianAndBiomass <- subset(Survey_Factors, select=c("Survey_Date", "Ground", "Julian", "DFO_Estimate"))
JulianAndBiomass <- na.omit(JulianAndBiomass)
JulianAndBiomass<- subset(JulianAndBiomass, Survey_Date < '2023-05-22') #As only one DFO factor for 2023 is in the system, removed to keep years nice.
View(JulianAndBiomass)
library(data.table)
library(suncalc)
library(rlang)
library(cli)
library(lubridate)
library(reprex)
library(tidyverse)
library(geosphere)
library(reshape2)
library(moderndive)
library(skimr)
library(ggridges)
#library(weathercan)
library(GGally)
library(psych)
library(raster)
library(PBSmapping)
#library(rgeos)
library(knitr)
library(kableExtra)
library(grid)
library(gridExtra)
library(cowplot)
library(readxl)
library(hms)
library(measurements)
library(tibble)
library(zoo)
Sys.setenv(tz = "America/Halifax")
# remove everything in the workspace
rm(list = ls())
#Set information here
Lat = "45 03 54" #Degree-Min-Sec format from the boat but only the numbers written with spaces (e.g. "44 16 23")
Lon = "65 14 93"
date = "1999-09-10"
#Load Sunset Time.csv - Pulls up previous entries.
SunsetStart <- read_csv(paste0("C:/Users/", Sys.info()[7],"/Desktop/surveyFactorsAll_Tracey with SSB data.csv"))
#Load Sunset Time.csv - Pulls up previous entries.
SunsetStart <- read_csv(paste0("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder/surveyFactorsAll_Tracey with SSB data.csv")) #"C:/Users/", Sys.info()[7],"/Desktop/surveyFactorsAll_Tracey with SSB data.csv"))
View(SunsetStart)
setwd("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder")
SunsetStart <- read_csv("surveyFactorsAll_Tracey with SSB data.csv")
#Lat and Lon Converter
Lon = conv_unit(Lon,"deg_min_sec","dec_deg")
Lon = as.numeric(Lon)
Lat = conv_unit(Lat, "deg_min_sec", "dec_deg")
Lat = as.numeric(Lat)
Lon = -1*Lon
#Calendar date Converter
date = as.Date(as.POSIXct(date))
julian = yday(date)
#Data Table of Sunset times - Current Data
Sunset <- suncalc::getSunlightTimes(date = date, lat = Lat, lon = Lon, keep = c("sunsetStart"), tz = "America/Halifax")
View(Sunset)
Sunset <- as.data.frame(Sunset)
SunsetStart <- as.data.frame(SunsetStart)
Sunset[] <- data.frame(lapply(Sunset, as.character), stringsAsFactors = FALSE)
Sunset$date = as.Date(Sunset$date)
SunsetStartOnly <- Sunset$sunsetStart
SunsetStartOnly <- as.POSIXct(SunsetStartOnly)
#Set information here
Lat = "45 03 54" #Degree-Min-Sec format from the boat but only the numbers written with spaces (e.g. "44 16 23")
Lon = "65 14 93"
date = "2024-01-02"
#Load Sunset Time.csv - Pulls up previous entries.
SunsetStart <- read_csv(paste0("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder/surveyFactorsAll_Tracey with SSB data.csv"))
setwd("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder")
#Lat and Lon Converter
Lon = conv_unit(Lon,"deg_min_sec","dec_deg")
Lon = as.numeric(Lon)
Lat = conv_unit(Lat, "deg_min_sec", "dec_deg")
Lat = as.numeric(Lat)
Lon = -1*Lon
#Calendar date Converter
date = as.Date(as.POSIXct(date))
#Data Table of Sunset times - Current Data
Sunset <- suncalc::getSunlightTimes(date = date, lat = Lat, lon = Lon, keep = c("sunsetStart"), tz = "America/Halifax")
julian = yday(date) ##Double check julian date
#Data Table of Sunset times - Current Data
Sunset <- suncalc::getSunlightTimes(date = date, lat = Lat, lon = Lon, keep = c("sunsetStart"), tz = "America/Halifax")
Sunset <- as.data.frame(Sunset)
SunsetStart <- as.data.frame(SunsetStart)
Sunset[] <- data.frame(lapply(Sunset, as.character), stringsAsFactors = FALSE)
Sunset$date = as.Date(Sunset$date)
SunsetStartOnly <- Sunset$sunsetStart
SunsetStartOnly <- as.POSIXct(SunsetStartOnly)
View(SunsetStart)
View(Sunset)
View(SunsetStart)
#Bind Data
SunsetStart <- rbind(SunsetStart, list(date, SunsetStartOnly))
#Load Sunset Time.csv - Pulls up previous entries.
#SunsetStart <- read_csv(paste0("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder/surveyFactorsAll_Tracey with SSB data.csv"))
SunsetStart <- read_csv(paste0("C:\Users\herri\Desktop\Tracey Local SSB Spreadsheet.csv"))
#Load Sunset Time.csv - Pulls up previous entries.
#SunsetStart <- read_csv(paste0("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder/surveyFactorsAll_Tracey with SSB data.csv"))
SunsetStart <- read_csv(paste0("C:/Users/herri/Desktop/Tracey Local SSB Spreadsheet.csv"))
View(SunsetStart)
View(Sunset)
#Load Sunset Time.csv - Pulls up previous entries.
#SunsetStart <- read_csv(paste0("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder/surveyFactorsAll_Tracey with SSB data.csv"))
SunsetStart <- read_csv(paste0("C:/Users/herri/Desktop/Tracey Local SSB Spreadsheet.csv"))
View(SunsetStart)
setwd("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder")
#Lat and Lon Converter
Lon = conv_unit(Lon,"deg_min_sec","dec_deg")
Lon = as.numeric(Lon)
Lat = conv_unit(Lat, "deg_min_sec", "dec_deg")
Lat = as.numeric(Lat)
Lon = -1*Lon
#Calendar date Converter
date = as.Date(as.POSIXct(date))
julian = yday(date) ##Double check julian date
#Data Table of Sunset times - Current Data
Sunset <- suncalc::getSunlightTimes(date = date, lat = Lat, lon = Lon, keep = c("sunsetStart"), tz = "America/Halifax")
Sunset <- as.data.frame(Sunset)
SunsetStart <- as.data.frame(SunsetStart)
Sunset[] <- data.frame(lapply(Sunset, as.character), stringsAsFactors = FALSE)
Sunset$date = as.Date(Sunset$date)
SunsetStartOnly <- Sunset$sunsetStart
SunsetStartOnly <- as.POSIXct(SunsetStartOnly)
#Bind Data
add_data = SunsetStart(Survey_Data = date, sunsetStart = SunsetStartOnly, row.names="ID")
#Bind Data
add_data = data.frame(Survey_Data = date, sunsetStart = SunsetStartOnly, row.names="ID")
View(add_data)
# remove everything in the workspace
rm(list = ls())
#Set information here
Lat = "45 03 54" #Degree-Min-Sec format from the boat but only the numbers written with spaces (e.g. "44 16 23")
Lon = "65 14 93"
date = "2024-01-02"
#Load Sunset Time.csv - Pulls up previous entries.
#SunsetStart <- read_csv(paste0("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder/surveyFactorsAll_Tracey with SSB data.csv"))
SunsetStart <- read_csv(paste0("C:/Users/herri/Desktop/Tracey Local SSB Spreadsheet.csv"))
setwd("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder")
#Lat and Lon Converter
Lon = conv_unit(Lon,"deg_min_sec","dec_deg")
Lon = as.numeric(Lon)
Lat = conv_unit(Lat, "deg_min_sec", "dec_deg")
Lat = as.numeric(Lat)
Lon = -1*Lon
#Calendar date Converter
date = as.Date(as.POSIXct(date))
julian = yday(date) ##Double check julian date
#Data Table of Sunset times - Current Data
Sunset <- suncalc::getSunlightTimes(date = date, lat = Lat, lon = Lon, keep = c("sunsetStart"), tz = "America/Halifax")
Sunset <- as.data.frame(Sunset)
SunsetStart <- as.data.frame(SunsetStart)
Sunset[] <- data.frame(lapply(Sunset, as.character), stringsAsFactors = FALSE)
Sunset$date = as.Date(Sunset$date)
SunsetStartOnly <- Sunset$sunsetStart
SunsetStartOnly <- as.POSIXct(SunsetStartOnly)
#Bind Data
add_data = data.frame(Survey_Data = date, sunsetStart = SunsetStartOnly, row.names="ID")
View(add_data)
View(add_data)
#Bind Data
add_data = data.frame(Survey_Date = date, sunsetStart = SunsetStartOnly, row.names="ID")
View(add_data)
View(Sunset)
bind_rows(Survey_Date, sunsetStart)
bind_rows(SunsetStart, add_data)
rlang::last_trace()
View(SunsetStart)
#Bind Data
add_data = data.frame(Survey_Date = date, sunsetStart = SunsetStartOnly)
View(add_data)
?bind_row
??bind_rows
bind_rows(add_data, SunsetStart)
bind_rows(Survey_Date, SunsetStart)
bind_rows
bind_rows(SunsetStart, add_data)
View(SunsetStart)
#Bind Data
add_data = data.frame(id = "NA", Survey_Date = date, sunsetStart = SunsetStartOnly)
View(add_data)
#Load Sunset Time.csv - Pulls up previous entries.
#SunsetStart <- read_csv(paste0("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder/surveyFactorsAll_Tracey with SSB data.csv"))
SunsetStart <- read_csv(paste0("C:/Users/herri/Desktop/Tracey Local SSB Spreadsheet.csv"))
setwd("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder")
#Lat and Lon Converter
Lon = conv_unit(Lon,"deg_min_sec","dec_deg")
Lon = as.numeric(Lon)
Lat = conv_unit(Lat, "deg_min_sec", "dec_deg")
Lat = as.numeric(Lat)
Lon = -1*Lon
#Calendar date Converter
date = as.Date(as.POSIXct(date))
julian = yday(date) ##Double check julian date
#Data Table of Sunset times - Current Data
Sunset <- suncalc::getSunlightTimes(date = date, lat = Lat, lon = Lon, keep = c("sunsetStart"), tz = "America/Halifax")
Sunset <- as.data.frame(Sunset)
SunsetStart <- as.data.frame(SunsetStart)
Sunset[] <- data.frame(lapply(Sunset, as.character), stringsAsFactors = FALSE)
Sunset$date = as.Date(Sunset$date)
SunsetStartOnly <- Sunset$sunsetStart
SunsetStartOnly <- as.POSIXct(SunsetStartOnly)
# remove everything in the workspace
rm(list = ls())
#Set information here
Lat = "45 03 54" #Degree-Min-Sec format from the boat but only the numbers written with spaces (e.g. "44 16 23")
Lon = "65 14 93"
date = "2024-01-02"
#Load Sunset Time.csv - Pulls up previous entries.
#SunsetStart <- read_csv(paste0("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder/surveyFactorsAll_Tracey with SSB data.csv"))
SunsetStart <- read_csv(paste0("C:/Users/herri/Desktop/Tracey Local SSB Spreadsheet.csv"))
setwd("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder")
#Lat and Lon Converter
Lon = conv_unit(Lon,"deg_min_sec","dec_deg")
Lon = as.numeric(Lon)
Lat = conv_unit(Lat, "deg_min_sec", "dec_deg")
Lat = as.numeric(Lat)
Lon = -1*Lon
#Calendar date Converter
date = as.Date(as.POSIXct(date))
julian = yday(date) ##Double check julian date
#Data Table of Sunset times - Current Data
Sunset <- suncalc::getSunlightTimes(date = date, lat = Lat, lon = Lon, keep = c("sunsetStart"), tz = "America/Halifax")
Sunset <- as.data.frame(Sunset)
SunsetStart <- as.data.frame(SunsetStart)
Sunset[] <- data.frame(lapply(Sunset, as.character), stringsAsFactors = FALSE)
Sunset$date = as.Date(Sunset$date)
SunsetStartOnly <- Sunset$sunsetStart
SunsetStartOnly <- as.POSIXct(SunsetStartOnly)
#Bind Data
add_data = data.frame(id = "NA",
Survey_Date = date,
Survey_Type = "NA",
Counted = "NA",
Year = "NA",
No_of_Vessels = "NA",
Ground = "NA",
HSC_Estimate = "NA",
HSC_Turnover= "NA",
DFO_Estimate = "NA",
DFO_Turnover = "NA",
Survey_Start = "NA",
High_Tide = "NA",
Tide_Difference = "NA",
Tide_Relative = "NA",
Sunset_Time = "NA",
Sunset_Difference = "NA",
Sunset_Relative = "NA",
DFO_Area = "NA",
DFO_Density = "NA",
SurveyStart = "NA",
HighTide = "NA"
sunsetStart = SunsetStartOnly)
#Bind Data
add_data = data.frame(id = "NA",
Survey_Date = date,
Survey_Type = "NA",
Counted = "NA",
Year = "NA",
No_of_Vessels = "NA",
Ground = "NA",
HSC_Estimate = "NA",
HSC_Turnover= "NA",
DFO_Estimate = "NA",
DFO_Turnover = "NA",
Survey_Start = "NA",
High_Tide = "NA",
Tide_Difference = "NA",
Tide_Relative = "NA",
Sunset_Time = "NA",
Sunset_Difference = "NA",
Sunset_Relative = "NA",
DFO_Area = "NA",
DFO_Density = "NA",
SurveyStart = "NA",
HighTide = "NA",
sunsetStart = SunsetStartOnly)
View(add_data)
View(SunsetStart)
#Bind Data
add_data = data.frame(id = "NA",
Survey_Date = date,
Survey_Type = "NA",
Counted = "NA",
Year = "NA",
No_of_Vessels = "NA",
Ground = "NA",
HSC_Estimate = "NA",
HSC_Turnover= "NA",
DFO_Estimate = "NA",
DFO_Turnover = "NA",
Survey_Start = "NA",
High_Tide = "NA",
Tide_Difference = "NA",
Tide_Relative = "NA",
Sunset_Time = "NA",
Sunset_Difference = "NA",
Sunset_Relative = "NA",
DFO_Area = "NA",
DFO_Density = "NA",
SurveyStart = "NA",
HighTide = "NA",
sunsetStart = SunsetStartOnly,
Comment = "NA")
View(SunsetStart)
#Bind Data
add_data = data.frame(id = "NA",
Survey_Date = date,
Survey_Number = "NA",
Survey_Type = "NA",
Counted = "NA",
Year = "NA",
No_of_Vessels = "NA",
Ground = "NA",
HSC_Estimate = "NA",
HSC_Turnover= "NA",
DFO_Estimate = "NA",
DFO_Turnover = "NA",
Survey_Start = "NA",
High_Tide = "NA",
Tide_Difference = "NA",
Tide_Relative = "NA",
Sunset_Time = "NA",
Sunset_Difference = "NA",
Sunset_Relative = "NA",
DFO_Area = "NA",
DFO_Density = "NA",
SurveyStart = "NA",
HighTide = "NA",
sunsetStart = SunsetStartOnly,
Comment = "NA")
rbind(SunsetStart, add_data)
View(SunsetStart)
# remove everything in the workspace
rm(list = ls())
#Set information here
Lat = "45 03 54" #Degree-Min-Sec format from the boat but only the numbers written with spaces (e.g. "44 16 23")
Lon = "65 14 93"
date = "2024-01-02"
#Load Sunset Time.csv - Pulls up previous entries.
#SunsetStart <- read_csv(paste0("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder/surveyFactorsAll_Tracey with SSB data.csv"))
SunsetStart <- read_csv(paste0("C:/Users/herri/Desktop/Tracey Local SSB Spreadsheet.csv"))
setwd("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder")
#Lat and Lon Converter
Lon = conv_unit(Lon,"deg_min_sec","dec_deg")
Lon = as.numeric(Lon)
Lat = conv_unit(Lat, "deg_min_sec", "dec_deg")
Lat = as.numeric(Lat)
Lon = -1*Lon
#Calendar date Converter
date = as.Date(as.POSIXct(date))
julian = yday(date) ##Double check julian date
#Data Table of Sunset times - Current Data
Sunset <- suncalc::getSunlightTimes(date = date, lat = Lat, lon = Lon, keep = c("sunsetStart"), tz = "America/Halifax")
Sunset <- as.data.frame(Sunset)
SunsetStart <- as.data.frame(SunsetStart)
Sunset[] <- data.frame(lapply(Sunset, as.character), stringsAsFactors = FALSE)
Sunset$date = as.Date(Sunset$date)
SunsetStartOnly <- Sunset$sunsetStart
SunsetStartOnly <- as.POSIXct(SunsetStartOnly)
#Bind Data
add_data = data.frame(id = "NA",
Survey_Date = date,
Survey_Number = "NA",
Survey_Type = "NA",
Counted = "NA",
Year = "NA",
No_of_Vessels = "NA",
Ground = "NA",
HSC_Estimate = "NA",
HSC_Turnover= "NA",
DFO_Estimate = "NA",
DFO_Turnover = "NA",
Survey_Start = "NA",
High_Tide = "NA",
Tide_Difference = "NA",
Tide_Relative = "NA",
Sunset_Time = "NA",
Sunset_Difference = "NA",
Sunset_Relative = "NA",
DFO_Area = "NA",
DFO_Density = "NA",
SurveyStart = "NA",
HighTide = "NA",
sunsetStart = SunsetStartOnly,
Comment = "NA")
rbind(SunsetStart, add_data)
# Load the libraries first
install.packages("gtools")
library(gtools)
add_data <- unname(add_data)
View(add_data)
rbind(add_data, SunsetStart)
#Bind Data
add_data = data.frame(id = "NA",
Survey_Date = date,
Survey_Number = "NA",
Survey_Type = "NA",
Counted = "NA",
Year = "NA",
No_of_Vessels = "NA",
Ground = "NA",
HSC_Estimate = "NA",
HSC_Turnover= "NA",
DFO_Estimate = "NA",
DFO_Turnover = "NA",
Survey_Start = "NA",
High_Tide = "NA",
Tide_Difference = "NA",
Tide_Relative = "NA",
Sunset_Time = "NA",
Sunset_Difference = "NA",
Sunset_Relative = "NA",
DFO_Area = "NA",
DFO_Density = "NA",
SurveyStart = "NA",
HighTide = "NA",
sunsetStart = SunsetStartOnly,
Comment = "NA")
View(add_data)
bind_rows(SunsetStart, add_data)
rlang::last_trace()
SunsetStart1 <- bind_rows(SunsetStart, add_data)
