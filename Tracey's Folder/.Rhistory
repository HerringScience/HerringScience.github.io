library(oce) #new CTD Data package
#Tagging Data
Tag = read_csv("TaggingEvents.csv") #Tagging Data
polysT = read_csv("timGrounds.csv") #Coloured ground maps
Tag$Year = as.factor(Tag$Year)
Tag$Vessel = as.factor(Tag$Vessel)
Tag$Survey = as.factor(Tag$Survey)
Tag$Tagger = as.factor(Tag$Tagger)
#CTD Data
SST = read_csv("CTD SST.csv") #SST
polysT = read_csv("timGrounds.csv") #coloured ground maps
CTD = read_csv("CTD Full.csv") #All Data
atDepth = read_csv("CTD 30m.csv") #At 30m Depth > This one contains all Stratified Temp + Salinity data as well
SST$Year <- as.factor(SST$Year)
SST$Month <- as.factor(SST$Month)
atDepth$Year <- as.factor(atDepth$Year)
atDepth$Month <- as.factor(atDepth$Month)
CTD$Year <- as.factor(CTD$Year)
CTD$Month <- as.factor(CTD$Month)
CTD$Survey <- as.factor(CTD$Survey)
CTD <- CTD %>%
mutate(Julian_factor = Julian)
CTD$Julian_factor <- as.factor(CTD$Julian_factor)
#SSB Data
SSB = read_csv("SSB Estimates.csv")
SSB$Year <- as.factor(SSB$Year)
SSB$Survey_Number <- as.factor(SSB$Survey_Number)
SSB$Ground <- as.factor(SSB$Ground)
#LRP Data
LRP2 = read_csv("LRP Data.csv")
LRP2 = LRP2 %>% rename(ThreeYear = "3yr Avg")
#Fat Data
FatData = read_csv("Total Fat Data.csv")
#Larval Data
#All Adjusted Ages and Dates are originally added in Larval QC script.
Larval = read_csv("Full Larval.csv")
Larval$Date <- lubridate::ymd(Larval$Date)
Larval <- dplyr::arrange(Larval, Date)
Larval$Year <- as.factor(Larval$Year)
Larval$category <- as.factor(Larval$category)
Larval$Survey.No <- as.factor(Larval$Survey.No)
Larval$MonthDay <- format(Larval$Date, "%m-%d")
LarvalSI = filter(Larval, Ground == "SI")
LarvalSum = read_csv(paste0("C:/Users/", Sys.info()[7],"/Documents/GitHub/HerringScience.github.io/Source Data/Larval Data/LarvalSum.csv"))
LarvalSum$Year <- as.factor(LarvalSum$Year)
#Land Data
can<-getData('GADM', country="CAN", level=1)
us = getData('GADM', country = "USA", level = 1)
?getData
can1 = rbind(can,us)
NBNS <- can1[can1@data$NAME_1%in%c("New Brunswick","Nova Scotia","Prince Edward Island","Newfoundland and Labrador","QuÃ©bec", "Maine"),]
library(raster)
year= substr(Sys.Date(),1,4)
knitr::opts_knit$set(root.dir = paste0("C:/Users/", Sys.info()[7],"/Documents/GitHub/HerringScience.github.io/"))
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE, fig.align='center')
#Import all packages, CTD data, and land data
#Packages
setwd(paste0("C:/Users/", Sys.info()[7],"/Documents/GitHub/HerringScience.github.io/Main Data/"))
library(ggplot2)
library(patchwork)
library(scales)
library(cli)
library(lubridate)
library(reprex)
library(tidyverse)
library(geosphere)
library(reshape2)
library(moderndive)
library(skimr)
library(ggridges)
#library(weathercan)
library(GGally)
library(psych)
library(raster)
library(PBSmapping)
#library(rgeos)
library(sf)
library(terra)
library(knitr)
library(kableExtra)
library(grid)
library(gridExtra)
library(cowplot)
library(DT)
library(dygraphs)
library(leaflet)
library(rmapshaper)
library(plotly)
library(mapproj)
library(oce) #new CTD Data package
library(raster)
#Tagging Data
Tag = read_csv("TaggingEvents.csv") #Tagging Data
polysT = read_csv("timGrounds.csv") #Coloured ground maps
Tag$Year = as.factor(Tag$Year)
Tag$Vessel = as.factor(Tag$Vessel)
Tag$Survey = as.factor(Tag$Survey)
Tag$Tagger = as.factor(Tag$Tagger)
#CTD Data
SST = read_csv("CTD SST.csv") #SST
polysT = read_csv("timGrounds.csv") #coloured ground maps
CTD = read_csv("CTD Full.csv") #All Data
atDepth = read_csv("CTD 30m.csv") #At 30m Depth > This one contains all Stratified Temp + Salinity data as well
SST$Year <- as.factor(SST$Year)
SST$Month <- as.factor(SST$Month)
atDepth$Year <- as.factor(atDepth$Year)
atDepth$Month <- as.factor(atDepth$Month)
CTD$Year <- as.factor(CTD$Year)
CTD$Month <- as.factor(CTD$Month)
CTD$Survey <- as.factor(CTD$Survey)
CTD <- CTD %>%
mutate(Julian_factor = Julian)
CTD$Julian_factor <- as.factor(CTD$Julian_factor)
#SSB Data
SSB = read_csv("SSB Estimates.csv")
SSB$Year <- as.factor(SSB$Year)
SSB$Survey_Number <- as.factor(SSB$Survey_Number)
SSB$Ground <- as.factor(SSB$Ground)
#LRP Data
LRP2 = read_csv("LRP Data.csv")
LRP2 = LRP2 %>% rename(ThreeYear = "3yr Avg")
#Fat Data
FatData = read_csv("Total Fat Data.csv")
#Larval Data
#All Adjusted Ages and Dates are originally added in Larval QC script.
Larval = read_csv("Full Larval.csv")
Larval$Date <- lubridate::ymd(Larval$Date)
Larval <- dplyr::arrange(Larval, Date)
Larval$Year <- as.factor(Larval$Year)
Larval$category <- as.factor(Larval$category)
Larval$Survey.No <- as.factor(Larval$Survey.No)
Larval$MonthDay <- format(Larval$Date, "%m-%d")
LarvalSI = filter(Larval, Ground == "SI")
LarvalSum = read_csv(paste0("C:/Users/", Sys.info()[7],"/Documents/GitHub/HerringScience.github.io/Source Data/Larval Data/LarvalSum.csv"))
LarvalSum$Year <- as.factor(LarvalSum$Year)
#Land Data
can<-getData('GADM', country="CAN", level=1)
library(rlang)
library(cli)
library(lubridate)
library(reprex)
library(tidyverse)
library(geosphere)
library(reshape2)
library(moderndive)
library(skimr)
library(ggridges)
#library(weathercan)
library(GGally)
library(psych)
library(sp)
library(raster)
library(PBSmapping)
#library(rgeos) - replaced by terra and sf
library(knitr)
library(kableExtra)
library(grid)
library(gridExtra)
library(cowplot)
library(readxl)
library(hms)
library(measurements)
library(ggplot2)
library(maps)
library(dplyr)
library(RColorBrewer)
library(AICcmodavg)
library(datasets)
library(terra)
library(multcompView)
library(sf)
library(zoo)
library(ggrepel)
rm(list = ls())
options(scipen = 999)
setwd("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder")
Survey_Factors <- read_csv("surveyFactorsAll_Tracey with SSB data.csv")
Survey_Factors$Julian = as.POSIXlt(Survey_Factors$Survey_Date)$yday
Survey_Data <- read_csv("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Main Data/Survey Data.csv")
JulianAndBiomass <- subset(Survey_Factors, select=c("Survey_Date", "Ground", "Julian", "DFO_Estimate"))
JulianAndBiomass <- na.omit(JulianAndBiomass)
JulianAndBiomass<- subset(JulianAndBiomass, Survey_Date < '2023-05-22') #As only one DFO factor for 2023 is in the system, removed to keep years nice.
ScotsBay_Turnover <- subset(JulianAndBiomass, Ground=='SB' )
SBPointGraph <- ggplot(ScotsBay_Turnover, aes(Julian, DFO_Estimate)) +geom_point() +geom_smooth(span = 1)
print(SBPointGraph + labs(y = "Survey Biomass (mt)", x = "Julian Day"))
summary(aov(DFO_Estimate ~ Julian, data = ScotsBay_Turnover))
SBVesselsBiomass <- subset(Survey_Factors, select=c("Survey_Date", "No_of_Vessels", "Julian", "DFO_Estimate", "Ground"))
SBVesselsBiomass <- na.omit(SBVesselsBiomass)
SBVesselsBiomass <- subset(SBVesselsBiomass, Ground == "SB", Survey_Date < '2023-05-22')
SBVesselsBiomass$No_of_Vessels <- as.factor(SBVesselsBiomass$No_of_Vessels)
SBBoxplotVessels <-boxplot(SBVesselsBiomass$DFO_Estimate~SBVesselsBiomass$No_of_Vessels, xlab="Number of Vessels in Survey", ylab="Survey Biomass (mt)")
SBOneWayVessels <- aov(DFO_Estimate ~ No_of_Vessels, data = SBVesselsBiomass)
summary(SBOneWayVessels)
SurveyAreaTimeTideBiomass <- subset(Survey_Factors, select=c("Survey_Date", "No_of_Vessels", "Ground","Year", "Julian", "DFO_Estimate", "Survey_Start", "High_Tide", "Tide_Difference", "Tide_Relative" ))
SurveyAreaTimeTideBiomass <- na.omit(SurveyAreaTimeTideBiomass)
ScotsBayHighTideBiomass <- subset(SurveyAreaTimeTideBiomass, Ground=="SB")
ScotsBayHighTideBiomass <- subset(ScotsBayHighTideBiomass, Survey_Date < '2023-05-22')
ScotsBayHighTideBiomass$Tide_Relative <- as.numeric(ScotsBayHighTideBiomass$Tide_Relative)
SBTideRelativePoint <- ggplot(ScotsBayHighTideBiomass, aes(x=Tide_Relative, y=DFO_Estimate)) + geom_point(aes(group= Tide_Relative)) +stat_smooth(span = 1) + geom_hline(yintercept=mean(ScotsBayHighTideBiomass$DFO_Estimate))
print(SBTideRelativePoint + labs(y="Survey Biomass", x = "Tide Relative to Survey Start in Hours"))
SBOneWayTideRelative <- aov(DFO_Estimate ~ Tide_Relative, data = ScotsBayHighTideBiomass)
summary(SBOneWayTideRelative)
###Scots Bay Sunset Relative
SunsetData <- subset(Survey_Factors, select = c("Survey_Date", "Year", "Ground", "DFO_Estimate", "Sunset_Relative"))
SunsetData <- na.omit(SunsetData)
SunsetData <- subset(SunsetData,  Survey_Date < '2023-05-22')
JulianAndBiomass <- subset(Survey_Factors, select=c("Survey_Date", "Ground", "Julian", "DFO_Estimate"))
JulianAndBiomass <- na.omit(JulianAndBiomass)
JulianAndBiomass<- subset(JulianAndBiomass, Survey_Date < '2023-05-22') #As only one DFO factor for 2023 is in the system, removed to keep years nice.
ScotsBay_Turnover <- subset(JulianAndBiomass, Ground=='SB' )
SBPointGraph <- ggplot(ScotsBay_Turnover, aes(Julian, DFO_Estimate)) +geom_point() +geom_smooth(span = 1)
print(SBPointGraph + labs(y = "Survey Biomass (mt)", x = "Julian Day"))
summary(aov(DFO_Estimate ~ Julian, data = ScotsBay_Turnover))
knitr::opts_chunk$set(echo = TRUE)
#ANOVA Survey Factors Investigations_Scots Bay Tides
library(rlang)
library(cli)
library(lubridate)
library(reprex)
library(tidyverse)
library(geosphere)
library(reshape2)
library(moderndive)
library(skimr)
library(ggridges)
#library(weathercan)
library(GGally)
library(psych)
library(sp)
library(raster)
library(PBSmapping)
#library(rgeos) - replaced by terra and sf
library(knitr)
library(kableExtra)
library(grid)
library(gridExtra)
library(cowplot)
library(readxl)
library(hms)
library(measurements)
library(ggplot2)
library(maps)
library(dplyr)
library(RColorBrewer)
library(AICcmodavg)
library(datasets)
library(terra)
library(multcompView)
library(sf)
library(zoo)
library(ggrepel)
###remove everything in environment
rm(list = ls())
options(scipen = 999)
setwd("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder")
Survey_Factors <- read_csv("surveyFactorsAll_Tracey with SSB data.csv")
Survey_Factors$Julian = as.POSIXlt(Survey_Factors$Survey_Date)$yday
Survey_Data <- read_csv("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Main Data/Survey Data.csv")
JulianAndBiomass <- subset(Survey_Factors, select=c("Survey_Date", "Ground", "Julian", "DFO_Estimate"))
JulianAndBiomass <- na.omit(JulianAndBiomass)
JulianAndBiomass<- subset(JulianAndBiomass, Survey_Date < '2023-05-22') #As only one DFO factor for 2023 is in the system, removed to keep years nice.
ScotsBay_Turnover <- subset(JulianAndBiomass, Ground=='SB' )
SBPointGraph <- ggplot(ScotsBay_Turnover, aes(Julian, DFO_Estimate)) +geom_point() +geom_smooth(span = 1)
print(SBPointGraph + labs(y = "Survey Biomass (mt)", x = "Julian Day"))
summary(aov(DFO_Estimate ~ Julian, data = ScotsBay_Turnover))
JulianAndBiomass <- subset(Survey_Factors, select=c("Survey_Date", "Ground", "Julian", "DFO_Estimate"))
JulianAndBiomass <- na.omit(JulianAndBiomass)
JulianAndBiomass<- subset(JulianAndBiomass, Survey_Date < '2023-05-22') #As only one DFO factor for 2023 is in the system, removed to keep years nice.
ScotsBay_Turnover <- subset(JulianAndBiomass, Ground=='SB' )
SBPointGraph <- ggplot(ScotsBay_Turnover, aes(Julian, DFO_Estimate)) +geom_point() +geom_smooth(span = 1)
print(SBPointGraph + labs(y = "Survey Biomass (mt)", x = "Julian Day"))
summary(aov(DFO_Estimate ~ Julian, data = ScotsBay_Turnover))
knitr::opts_chunk$set(echo = TRUE)
#ANOVA Survey Factors Investigations_Scots Bay Tides
library(rlang)
library(cli)
library(lubridate)
library(reprex)
library(tidyverse)
library(geosphere)
library(reshape2)
library(moderndive)
library(skimr)
library(ggridges)
#library(weathercan)
library(GGally)
library(psych)
library(sp)
library(raster)
library(PBSmapping)
#library(rgeos) - replaced by terra and sf
library(knitr)
library(kableExtra)
library(grid)
library(gridExtra)
library(cowplot)
library(readxl)
library(hms)
library(measurements)
library(ggplot2)
library(maps)
library(dplyr)
library(RColorBrewer)
library(AICcmodavg)
library(datasets)
library(terra)
library(multcompView)
library(sf)
library(zoo)
library(ggrepel)
###remove everything in environment
rm(list = ls())
options(scipen = 999)
setwd("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder")
Survey_Factors <- read_csv("surveyFactorsAll_Tracey with SSB data.csv")
Survey_Factors$Julian = as.POSIXlt(Survey_Factors$Survey_Date)$yday
Survey_Data <- read_csv("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Main Data/Survey Data.csv")
JulianAndBiomass <- subset(Survey_Factors, select=c("Survey_Date", "Ground", "Julian", "DFO_Estimate"))
JulianAndBiomass <- na.omit(JulianAndBiomass)
JulianAndBiomass<- subset(JulianAndBiomass, Survey_Date < '2023-05-22') #As only one DFO factor for 2023 is in the system, removed to keep years nice.
ScotsBay_Turnover <- subset(JulianAndBiomass, Ground=='SB' )
SBPointGraph <- ggplot(ScotsBay_Turnover, aes(Julian, DFO_Estimate)) +geom_point() +geom_smooth(span = 1)
print(SBPointGraph + labs(y = "Survey Biomass (mt)", x = "Julian Day"))
summary(aov(DFO_Estimate ~ Julian, data = ScotsBay_Turnover))
SBVesselsBiomass <- subset(Survey_Factors, select=c("Survey_Date", "No_of_Vessels", "Julian", "DFO_Estimate", "Ground"))
SBVesselsBiomass <- na.omit(SBVesselsBiomass)
SBVesselsBiomass <- subset(SBVesselsBiomass, Ground == "SB", Survey_Date < '2023-05-22')
SBVesselsBiomass$No_of_Vessels <- as.factor(SBVesselsBiomass$No_of_Vessels)
SBBoxplotVessels <-boxplot(SBVesselsBiomass$DFO_Estimate~SBVesselsBiomass$No_of_Vessels, xlab="Number of Vessels in Survey", ylab="Survey Biomass (mt)")
SBOneWayVessels <- aov(DFO_Estimate ~ No_of_Vessels, data = SBVesselsBiomass)
summary(SBOneWayVessels)
SurveyAreaTimeTideBiomass <- subset(Survey_Factors, select=c("Survey_Date", "No_of_Vessels", "Ground","Year", "Julian", "DFO_Estimate", "Survey_Start", "High_Tide", "Tide_Difference", "Tide_Relative" ))
SurveyAreaTimeTideBiomass <- na.omit(SurveyAreaTimeTideBiomass)
ScotsBayHighTideBiomass <- subset(SurveyAreaTimeTideBiomass, Ground=="SB")
ScotsBayHighTideBiomass <- subset(ScotsBayHighTideBiomass, Survey_Date < '2023-05-22')
ScotsBayHighTideBiomass$Tide_Relative <- as.numeric(ScotsBayHighTideBiomass$Tide_Relative)
SBTideRelativePoint <- ggplot(ScotsBayHighTideBiomass, aes(x=Tide_Relative, y=DFO_Estimate)) + geom_point(aes(group= Tide_Relative)) +stat_smooth(span = 1) + geom_hline(yintercept=mean(ScotsBayHighTideBiomass$DFO_Estimate))
print(SBTideRelativePoint + labs(y="Survey Biomass", x = "Tide Relative to Survey Start in Hours"))
SBOneWayTideRelative <- aov(DFO_Estimate ~ Tide_Relative, data = ScotsBayHighTideBiomass)
summary(SBOneWayTideRelative)
SunsetData <- subset(Survey_Factors, select = c("Survey_Date", "Year", "Ground", "DFO_Estimate", "Sunset_Relative"))
SunsetData <- na.omit(SunsetData)
SunsetData <- subset(SunsetData,  Survey_Date < '2023-05-22')
ScotsBaySunsetData <- subset(SunsetData, Ground == "SB")
ScotsBaySunsetData$Sunset_Relative <- as.numeric(ScotsBaySunsetData$Sunset_Relative)
SBSunsetRelativePoint <- ggplot(ScotsBaySunsetData, aes (x=Sunset_Relative, y=DFO_Estimate))+ geom_point(aes(group=Sunset_Relative)) +geom_smooth(span = 1)
print(SBSunsetRelativePoint + labs(y="Survey Biomass", x="Sunset Relative to Survey Start (hrs)"))
SBSunsetOneWayANOVA <- aov(DFO_Estimate ~ Sunset_Relative, data = ScotsBaySunsetData)
summary(SBSunsetOneWayANOVA)
PeakBiomass <- subset(Survey_Factors, select = c("Survey_Date", "Year", "Julian", "Ground", "DFO_Turnover_Adjusted"))
PeakBiomass <- na.omit(PeakBiomass)
PeakBiomass <- subset(PeakBiomass, Survey_Date < '2023-05-22')
ScotsBayPeakBiomass <- subset(PeakBiomass, Ground == "SB")
ScotsBayPeakBiomass <- ScotsBayPeakBiomass %>% group_by(Year) %>% slice_max(DFO_Turnover_Adjusted)
ScotsBayPeakBiomass <-ScotsBayPeakBiomass %>% add_column(format(ScotsBayPeakBiomass$Survey_Date, "%B"))
colnames(ScotsBayPeakBiomass)[6] = "Month"
ScotsBayPeakBiomass %>% group_by(Month)
ScotsBayPeakBiomass$Month <-factor(ScotsBayPeakBiomass$Month, levels = c("June", "July", "August", "September"))
ScotsBayPeakBiomassPointGraph <- ggplot(ScotsBayPeakBiomass, aes(x=Julian, y=DFO_Turnover_Adjusted)) +
geom_point(aes(color=Month, size = 3)) +
geom_label_repel(aes(label=Year), nudge_x = 2)
ScotsBayPeakBiomassPointGraph + scale_fill_discrete(breaks=c("June", "July", "August", "September"))
print(ScotsBayPeakBiomassPointGraph + labs(y="Peak Survey Biomass(mt)", x = "Julian"))
SBPeakBiomassANOVA = aov(DFO_Turnover_Adjusted~Year, data = ScotsBayPeakBiomass)
summary(SBPeakBiomassANOVA)
TotalBiomass <- subset(Survey_Factors, select = c("id", "Year","Ground", "DFO_Estimate", "Survey_Date"))
TotalBiomass <- na.omit(TotalBiomass)
TotalBiomass <- subset(TotalBiomass, Survey_Date < '2023-05-22')
ScotsBayTotalBiomass <- subset(TotalBiomass, Ground == "SB")
ScotsBayTotalBiomass <- ScotsBayTotalBiomass %>% group_by(Year) %>% add_count(Year)
aggregateSB <- aggregate(ScotsBayTotalBiomass$DFO_Estimate, list(ScotsBayTotalBiomass$Year), FUN=(sum))
colnames(aggregateSB)<-c("Year", "DFO_Estimate")
SBTotalBiomass <- print(ggplot(aggregateSB, aes(x=Year, y=DFO_Estimate, col = "Yearly Total Biomass")) +
geom_point() +
geom_line()+
labs(x = "Year", y= "Total Biomass (mt)"))
PeakBiomass <- subset(Survey_Factors, select = c("Survey_Date", "Year","Ground", "DFO_Estimate"))
PeakBiomass <- na.omit(PeakBiomass)
PeakBiomass <- subset(PeakBiomass, Survey_Date < '2023-05-22')
ScotsBayPeakBiomass <- subset(PeakBiomass, Ground == "SB")
ScotsBayPeakBiomass <- ScotsBayPeakBiomass %>% group_by(Year) %>% slice_max(DFO_Estimate)
ScotsBayPeakBiomassGraph2 <- ggplot(ScotsBayPeakBiomass, aes(x=Year, y=DFO_Estimate, col = "Yearly Peak Biomass")) +
geom_point()+
geom_line()
labs(x="Year", y="Peak Biomass (mt)")
ScotsBayPeakBiomassPointGraph <- ggplot(ScotsBayPeakBiomass, aes(x=Year, y=DFO_Estimate)) +
geom_point() +
geom_line()+
legend(2000, 500000, legend= c("Scots Bay Peak Biomass"))
plot.new()
knitr::opts_chunk$set(echo = TRUE)
#ANOVA Survey Factors Investigations_Scots Bay Tides
library(rlang)
library(cli)
library(lubridate)
library(reprex)
library(tidyverse)
library(geosphere)
library(reshape2)
library(moderndive)
library(skimr)
library(ggridges)
#library(weathercan)
library(GGally)
library(psych)
library(sp)
library(raster)
library(PBSmapping)
#library(rgeos) - replaced by terra and sf
library(knitr)
library(kableExtra)
library(grid)
library(gridExtra)
library(cowplot)
library(readxl)
library(hms)
library(measurements)
library(ggplot2)
library(maps)
library(dplyr)
library(RColorBrewer)
library(AICcmodavg)
library(datasets)
library(terra)
library(multcompView)
library(sf)
library(zoo)
library(ggrepel)
###remove everything in environment
rm(list = ls())
options(scipen = 999)
setwd("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Tracey's Folder")
Survey_Factors <- read_csv("surveyFactorsAll_Tracey with SSB data.csv")
Survey_Factors$Julian = as.POSIXlt(Survey_Factors$Survey_Date)$yday
Survey_Data <- read_csv("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Main Data/Survey Data.csv")
JulianAndBiomass <- subset(Survey_Factors, select=c("Survey_Date", "Ground", "Julian", "DFO_Estimate"))
JulianAndBiomass <- na.omit(JulianAndBiomass)
JulianAndBiomass<- subset(JulianAndBiomass, Survey_Date < '2023-05-22') #As only one DFO factor for 2023 is in the system, removed to keep years nice.
ScotsBay_Turnover <- subset(JulianAndBiomass, Ground=='SB' )
SBPointGraph <- ggplot(ScotsBay_Turnover, aes(Julian, DFO_Estimate)) +geom_point() +geom_smooth(span = 1)
print(SBPointGraph + labs(y = "Survey Biomass (mt)", x = "Julian Day"))
summary(aov(DFO_Estimate ~ Julian, data = ScotsBay_Turnover))
SBVesselsBiomass <- subset(Survey_Factors, select=c("Survey_Date", "No_of_Vessels", "Julian", "DFO_Estimate", "Ground"))
SBVesselsBiomass <- na.omit(SBVesselsBiomass)
SBVesselsBiomass <- subset(SBVesselsBiomass, Ground == "SB", Survey_Date < '2023-05-22')
SBVesselsBiomass$No_of_Vessels <- as.factor(SBVesselsBiomass$No_of_Vessels)
SBBoxplotVessels <-boxplot(SBVesselsBiomass$DFO_Estimate~SBVesselsBiomass$No_of_Vessels, xlab="Number of Vessels in Survey", ylab="Survey Biomass (mt)")
SBOneWayVessels <- aov(DFO_Estimate ~ No_of_Vessels, data = SBVesselsBiomass)
summary(SBOneWayVessels)
SurveyAreaTimeTideBiomass <- subset(Survey_Factors, select=c("Survey_Date", "No_of_Vessels", "Ground","Year", "Julian", "DFO_Estimate", "Survey_Start", "High_Tide", "Tide_Difference", "Tide_Relative" ))
SurveyAreaTimeTideBiomass <- na.omit(SurveyAreaTimeTideBiomass)
ScotsBayHighTideBiomass <- subset(SurveyAreaTimeTideBiomass, Ground=="SB")
ScotsBayHighTideBiomass <- subset(ScotsBayHighTideBiomass, Survey_Date < '2023-05-22')
ScotsBayHighTideBiomass$Tide_Relative <- as.numeric(ScotsBayHighTideBiomass$Tide_Relative)
SBTideRelativePoint <- ggplot(ScotsBayHighTideBiomass, aes(x=Tide_Relative, y=DFO_Estimate)) + geom_point(aes(group= Tide_Relative)) +stat_smooth(span = 1) + geom_hline(yintercept=mean(ScotsBayHighTideBiomass$DFO_Estimate))
print(SBTideRelativePoint + labs(y="Survey Biomass", x = "Tide Relative to Survey Start in Hours"))
SBOneWayTideRelative <- aov(DFO_Estimate ~ Tide_Relative, data = ScotsBayHighTideBiomass)
summary(SBOneWayTideRelative)
SunsetData <- subset(Survey_Factors, select = c("Survey_Date", "Year", "Ground", "DFO_Estimate", "Sunset_Relative"))
SunsetData <- na.omit(SunsetData)
SunsetData <- subset(SunsetData,  Survey_Date < '2023-05-22')
ScotsBaySunsetData <- subset(SunsetData, Ground == "SB")
ScotsBaySunsetData$Sunset_Relative <- as.numeric(ScotsBaySunsetData$Sunset_Relative)
SBSunsetRelativePoint <- ggplot(ScotsBaySunsetData, aes (x=Sunset_Relative, y=DFO_Estimate))+ geom_point(aes(group=Sunset_Relative)) +geom_smooth(span = 1)
print(SBSunsetRelativePoint + labs(y="Survey Biomass", x="Sunset Relative to Survey Start (hrs)"))
SBSunsetOneWayANOVA <- aov(DFO_Estimate ~ Sunset_Relative, data = ScotsBaySunsetData)
summary(SBSunsetOneWayANOVA)
PeakBiomass <- subset(Survey_Factors, select = c("Survey_Date", "Year", "Julian", "Ground", "DFO_Turnover_Adjusted"))
PeakBiomass <- na.omit(PeakBiomass)
PeakBiomass <- subset(PeakBiomass, Survey_Date < '2023-05-22')
ScotsBayPeakBiomass <- subset(PeakBiomass, Ground == "SB")
ScotsBayPeakBiomass <- ScotsBayPeakBiomass %>% group_by(Year) %>% slice_max(DFO_Turnover_Adjusted)
ScotsBayPeakBiomass <-ScotsBayPeakBiomass %>% add_column(format(ScotsBayPeakBiomass$Survey_Date, "%B"))
colnames(ScotsBayPeakBiomass)[6] = "Month"
ScotsBayPeakBiomass %>% group_by(Month)
ScotsBayPeakBiomass$Month <-factor(ScotsBayPeakBiomass$Month, levels = c("June", "July", "August", "September"))
ScotsBayPeakBiomassPointGraph <- ggplot(ScotsBayPeakBiomass, aes(x=Julian, y=DFO_Turnover_Adjusted)) +
geom_point(aes(color=Month, size = 3)) +
geom_label_repel(aes(label=Year), nudge_x = 2)
ScotsBayPeakBiomassPointGraph + scale_fill_discrete(breaks=c("June", "July", "August", "September"))
print(ScotsBayPeakBiomassPointGraph + labs(y="Peak Survey Biomass(mt)", x = "Julian"))
SBPeakBiomassANOVA = aov(DFO_Turnover_Adjusted~Year, data = ScotsBayPeakBiomass)
summary(SBPeakBiomassANOVA)
TotalBiomass <- subset(Survey_Factors, select = c("id", "Year","Ground", "DFO_Estimate", "Survey_Date"))
TotalBiomass <- na.omit(TotalBiomass)
TotalBiomass <- subset(TotalBiomass, Survey_Date < '2023-05-22')
ScotsBayTotalBiomass <- subset(TotalBiomass, Ground == "SB")
ScotsBayTotalBiomass <- ScotsBayTotalBiomass %>% group_by(Year) %>% add_count(Year)
aggregateSB <- aggregate(ScotsBayTotalBiomass$DFO_Estimate, list(ScotsBayTotalBiomass$Year), FUN=(sum))
colnames(aggregateSB)<-c("Year", "DFO_Estimate")
SBTotalBiomass <- print(ggplot(aggregateSB, aes(x=Year, y=DFO_Estimate, col = "Yearly Total Biomass")) +
geom_point() +
geom_line()+
labs(x = "Year", y= "Total Biomass (mt)"))
PeakBiomass <- subset(Survey_Factors, select = c("Survey_Date", "Year","Ground", "DFO_Estimate"))
PeakBiomass <- na.omit(PeakBiomass)
PeakBiomass <- subset(PeakBiomass, Survey_Date < '2023-05-22')
ScotsBayPeakBiomass <- subset(PeakBiomass, Ground == "SB")
ScotsBayPeakBiomass <- ScotsBayPeakBiomass %>% group_by(Year) %>% slice_max(DFO_Estimate)
ScotsBayPeakBiomassGraph2 <- ggplot(ScotsBayPeakBiomass, aes(x=Year, y=DFO_Estimate, col = "Yearly Peak Biomass")) +
geom_point()+
geom_line()
labs(x="Year", y="Peak Biomass (mt)")
ScotsBayPeakBiomassPointGraph <- ggplot(ScotsBayPeakBiomass, aes(x=Year, y=DFO_Estimate)) +
geom_point() +
geom_line()+
legend(2000, 500000, legend= c("Scots Bay Peak Biomass"))
plot.new()
ScotsBayPeakBiomassPointGraph <- ggplot(ScotsBayPeakBiomass, aes(x=Year, y=DFO_Estimate)) +
geom_point() +
geom_line()+
legend(2000, 500000, legend= c("Scots Bay Peak Biomass"))
