---
title: "tagReturnsTracey Markdown"
output: html_document
date: "2024-04-05"
---

```{r setup, include=FALSE}
year= substr(Sys.Date(),1,4)
knitr::opts_knit$set(root.dir = paste0("C:/Users/", Sys.info()[7],"/Documents/GitHub/HerringScience.github.io/"))
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE, fig.align='center')

library(cli)
library(lubridate)
library(reprex)
library(tidyverse)
library(geosphere)
library(reshape2)
library(moderndive)
library(skimr)
library(ggridges)
#library(weathercan)
library(GGally)
library(psych)
library(raster)
library(PBSmapping)
#library(rgeos)
library(knitr)
library(kableExtra)
library(grid)
library(gridExtra)
library(cowplot)
library(dplyr)
library(geonames)
library(dplyr)
library(mgcv)
library(scales)



```

```{r Data Import, include=FALSE}

completeReturns <- read_csv(paste0("C:/Users/", Sys.info()[7],"/Documents/GitHub/HerringScience.github.io/Source Data/Tag Returns/complete.returns.csv"))
TaggingEvents <- read_csv(paste0("C:/Users/", Sys.info()[7],"/Documents/GitHub/HerringScience.github.io/Source Data/TaggingEvents.csv"))
    TaggingEvents <- TaggingEvents %>%  
        rename(TAG_NUMBER = Tag_Num)
rawReturn <- read_csv(paste0("C:/Users/", Sys.info()[7],"/Documents/GitHub/HerringScience.github.io/Source Data/Tag Returns/rawReturn.csv"))
relINFO <- read_csv(paste0("C:/Users/", Sys.info()[7],"/Documents/GitHub/HerringScience.github.io/Source Data/Tag Returns/relINFO.csv"))
polysNAFO <- read_csv(paste0("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Main Data/NAFO_subunits.csv"))
polysT <- read_csv(paste0("C:/Users/herri/Documents/GitHub/HerringScience.github.io/Main Data/timGrounds.csv"))

                           
#Combining complete Returns and Tagging events by tag number
TagReturns <- merge(TaggingEvents, completeReturns, by = "TAG_NUMBER")




# Assigning of Grounds

area1=polysT[which(polysT$Box == "NB Coastal"), ]
area2=polysT[which(polysT$Box == "Grand Manan"), ]
area3=polysT[which(polysT$Box == "Grand Manan Banks"), ]
area4=polysT[which(polysT$Box == "Long Island"), ]
area5=polysT[which(polysT$Box == "German Bank"), ]
area6=polysT[which(polysT$Box == "Seal Island"), ]
area7=polysT[which(polysT$Box == "Scots Bay"), ]
area8=polysT[which(polysT$Box == "Yankee Bank"), ]
area9=polysT[which(polysT$Box == "Trinity"), ]
area10=polysT[which(polysT$Box == "Browns Bank"), ]
area11=polysT[which(polysT$Box == "SW Grounds"), ]
area12=polysT[which(polysT$Box == "Gannet Dry Ledge"), ]
area13=polysT[which(polysT$Box == "Lurcher"), ]


ids = (TaggingEvents$TAG_NUMBER)
r = data.frame( TAG_NUMBER=ids, 
                X = NA, 
                Y = NA, 
                NB_Coastal = NA, 
                Grand_Manan = NA, 
                Grand_Manan_Banks = NA,
                Long_Island = NA, 
                German_Bank = NA, 
                Seal_Island = NA, 
                Scots_Bay = NA,
                Yankee_Bank = NA,
                Trinity = NA,
                Browns_Bank = NA,
                SW_Grounds = NA,
                Gannet_Dry_Ledge = NA,
                Lurcher = NA) 



# Assigning fishing grounds to sets. This takes  a few minutes to run through.
for (i in 1:nrow(r)){
  test = which(TaggingEvents$TAG_NUMBER==r[i, "TAG_NUMBER"])
  test1 = TaggingEvents[test, ]
  r$Y[i] = test1$Lat
  r$X[i] = test1$Lon
  r$NB_Coastal[i] = point.in.polygon(r$Y[i], r$X[i], area1$Y, area1$X, mode.checked=FALSE)
  r$Grand_Manan[i] = point.in.polygon(r$Y[i], r$X[i], area2$Y, area2$X, mode.checked=FALSE)
  r$Grand_Manan_Banks[i] = point.in.polygon(r$Y[i], r$X[i], area3$Y, area3$X, mode.checked=FALSE)
  r$Long_Island[i] = point.in.polygon(r$Y[i], r$X[i], area4$Y, area4$X, mode.checked=FALSE)
  r$German_Bank[i] = point.in.polygon(r$Y[i], r$X[i], area5$Y, area5$X, mode.checked=FALSE)
  r$Seal_Island[i] = point.in.polygon(r$Y[i], r$X[i], area6$Y, area6$X, mode.checked=FALSE)
  r$Scots_Bay[i] = point.in.polygon(r$Y[i], r$X[i], area7$Y, area7$X, mode.checked=FALSE)
  r$Yankee_Bank[i] = point.in.polygon(r$Y[i], r$X[i], area8$Y, area8$X, mode.checked=FALSE)
  r$Trinity[i] = point.in.polygon(r$Y[i], r$X[i], area9$Y, area9$X, mode.checked=FALSE)
  r$Browns_Bank[i] = point.in.polygon(r$Y[i], r$X[i], area10$Y, area10$X, mode.checked=FALSE)
  r$SW_Grounds[i] = point.in.polygon(r$Y[i], r$X[i], area11$Y, area11$X, mode.checked=FALSE)
  r$Gannet_Dry_Ledge[i] = point.in.polygon(r$Y[i], r$X[i], area12$Y, area12$X, mode.checked=FALSE)
  r$Lurcher[i] = point.in.polygon(r$Y[i], r$X[i], area13$Y, area13$X, mode.checked=FALSE)
  
}


# Ground                        
r$FishingGround = NA        
         
r$FishingGround = with(r, ifelse(r$NB_Coastal > 0, "NB Coastal",
                                 ifelse(r$Grand_Manan > 0, "Grand Manan",
                                        ifelse(r$Grand_Manan_Banks > 0, "Grand Manan Banks",
                                               ifelse(r$Long_Island > 0, "Long Island", 
                                                      ifelse(r$German_Bank > 0, "German Bank", 
                                                             ifelse(r$Seal_Island > 0, "Seal Island",
                                                                    ifelse(r$Scots_Bay > 0, "Scots Bay",
                                                                           ifelse(r$Yankee_Bank > 0, "Yankee Bank",
                                                                                  ifelse(r$Trinity > 0, "Trinity",
                                                                                         ifelse(r$Browns_Bank > 0, "Brown Bank",
                                                                                                ifelse(r$SW_Grounds > 0, "SW Grounds",
                                                                                                       ifelse(r$Gannet_Dry_Ledge > 0, "Gannet Dry Ledge",
                                                                                                              ifelse(r$Lurcher > 0, "Lurcher", "Other"))))))))))))))
TaggingEvents <- merge(TaggingEvents, r[, c("TAG_NUMBER", "FishingGround")], by = "TAG_NUMBER")
#TaggingSubset <- TaggingEvents[sample(1:nrow(TaggingEvents), 25, replace = FALSE),]



#Combining complete Returns and Tagging events by tag number
TagReturns <- merge(TaggingEvents, completeReturns, by = "TAG_NUMBER")

# Histogram showing average time differences between tagging in Days. Split into categories.
# Category 1 = 0 to 2 days. These should mostly be removed from analysis due to them being caught almost instantly.
# Category 2 = 3 to 10 days. This is the period that the survey window covers.
# Cat. 3 = 11 to 30 days. Rest of the first month.
# Cat. 4 = 31 to 183 days. Caught after the first month, before the 6 month mark.
# Cat. 5 = 184 to 365. Minimum time of 6 months between tagging event and being recaptured.
# Cat. 6 = 366 to 730. Caught a minimum of a year, up to two years after the tagging event.
# Cat. 7 = Anything after two years since tagging event.

TagReturns$timeDifference <- TagReturns$DATE - TagReturns$Date
  TagReturns$timeDifference <- as.numeric(TagReturns$timeDifference)
  TagReturns <- TagReturns[TagReturns$timeDifference >= 0,]
TagReturns$category = with(TagReturns, ifelse(TagReturns$timeDifference < 3, 1,
                                              ifelse(TagReturns$timeDifference < 11 & TagReturns$timeDifference >= 3, 2,
                                                     ifelse(TagReturns$timeDifference < 31 & TagReturns$timeDifference >= 11, 3,
                                                            ifelse(TagReturns$timeDifference < 184 & TagReturns$timeDifference >= 31, 4,
                                                                   ifelse(TagReturns$timeDifference < 366 & TagReturns$timeDifference >= 184, 5,
                                                                          ifelse(TagReturns$timeDifference < 731 & TagReturns$timeDifference >= 366, 6,
                                                                                 ifelse(TagReturns$timeDifference < 1095 & TagReturns$timeDifference >= 731, 7, 8))))))))
                                                   
  
TagReturns$category <- as.numeric(TagReturns$category)
TagReturns$Count <- 1


```

## Average Time Difference Across All Grounds  {.tabset .tabset-fade .tabset-pills}


```{r, results = "asis", fig.align='center'}
TagReturns = TagReturns %>%
  group_by(category) %>%
  mutate(AvgtimeDifference = mean(timeDifference)) %>%
  mutate(No.InCategory = length(category)) %>%
  mutate(timeDifferenceMin =min(timeDifference)) %>%
  mutate(timeDifferenceMax= max(timeDifference)) %>%
  mutate_if(is.numeric, format, digits = 2)

TagReturns$timeDifferenceMin <- as.numeric(TagReturns$timeDifferenceMin)
TagReturns$timeDifferenceMax <- as.numeric(TagReturns$timeDifferenceMax)
TagReturns$timeDifference <- as.numeric(TagReturns$timeDifference)

# Not sure why stat = "count" needs to be in there but causes the histogram to run so...
print(ggplot(data = TagReturns, (aes(category, fill = AvgtimeDifference))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Category", y="Count"))

TagReturns = TagReturns %>%
  group_by(timeDifference) %>%
  mutate(No.ofSameNumberOfDays = length(timeDifference)) %>%
  mutate_if(is.numeric, format, digits = 2)


Table <- TagReturns %>% 
  dplyr::select(category,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)

 Table1 <- unique(Table) %>%
             arrange(timeDifference)

kbl(Table1, col.names=c("Category", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)

Table1 %>% write.csv(paste0("C:/Users/", Sys.info()[7],"/Documents/GitHub/HerringScience.github.io/Source Data/Tag Returns/tagReturnsTracey.csv"))
```

## Scots Bay and German Bank Tags {.tabset .tabset-fade .tabset-pills}

### Tag Returns Scots Bay to German Bank, and German Bank to Scots Bay {.tabset .tabset-fade .tabset-pills}

```{r, results = "asis", fig.align='center'}
#TagReturnsSubset <- TagReturns[sample(1:nrow(TagReturns), 100, replace = FALSE),]

GBtoSB <- subset(TagReturns, subset = (FishingGround == "Scots Bay" & catchAREA == "German Bank" |
                                       FishingGround == "German Bank" & catchAREA == "Scots Bay" |
                                       FishingGround == "Scots Bay" & catchAREA == "German Bank (Area 7)" |
                                       FishingGround == "German Bank" & catchAREA == "Scots Bay (Area 8)" ))

GBtoSB$TagLocation <- with(GBtoSB, ifelse(GBtoSB$FishingGround == "Scots Bay", "SB to GB",
                                          ifelse(GBtoSB$FishingGround == "German Bank", "GB to SB","Other")))

GBtoSB$Count = 1


ggplot(GBtoSB, aes(x=TagLocation, y = Count, fill = factor(timeDifference))) +
        geom_bar(stat="identity") +
        labs(y = "Number of Events", x = "Initial Tag Location") +
        ggtitle("Tag Returns that started in either Scots Bay or German Bank, and were returned to the opposite ground") +
        labs(fill = "Days between tagging event and tag return")


Table <- GBtoSB %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)

```
### All Tag returns associated with tagging events that started in either German Bank or Scots Bay

```{r, results = "asis", fig.align='center'}

# Missing GB to SB now, not sure why. When removing category 1 items for GB to SB show up. Possibly it's because there is more category difference when going from GB to SB, so it ends up not showing?

TagReturns$TagLocation <- with(TagReturns, ifelse(TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA == "German Bank" |
                                                  TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA == "German Bank (Area 7)"  , "SB to GB",
                                           ifelse(TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA == "Scots Bay" |
                                                  TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA == "Scots Bay (Area 8)", "GB to SB",
                                           ifelse(TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA == "German Bank", "GB to GB",
                                           ifelse(TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA == "Scots Bay", "SB to SB",
                                           ifelse(TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA != "Scots Bay" | 
                                                  TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA != "German Bank", "SB to Other",
                                           ifelse(TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA != "Scots Bay" |
                                                  TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA != "German Bank", "GB to Other", "Other")))))))
# TagReturns1 <- subset(TagReturns, category != "1")

ggplot(data = TagReturns, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Category", y="Count")+
        scale_y_continuous(breaks= pretty_breaks())


Table <- TagReturns %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)


```
### Tag Returns between German Bank and Seal Island

```{r, results = "asis", fig.align='center'}
TagReturnsGBSI <- subset(TagReturns, subset = (FishingGround == "German Bank" | FishingGround == "Seal Island"))
TagReturnsGBSI <- subset(TagReturnsGBSI, subset = (catchAREA == "German Bank") | catchAREA == "Seal Island" | catchAREA == "German Bank (Area 7)")

TagReturnsGBSI$TagLocation <- with(TagReturnsGBSI, ifelse(TagReturnsGBSI$FishingGround == "German Bank" & TagReturnsGBSI$catchAREA == "German Bank" |
                                                        TagReturnsGBSI$FishingGround == "German Bank" & TagReturnsGBSI$catchAREA == "German Bank (Area 7)", "GB to GB",
                                                 ifelse(TagReturnsGBSI$FishingGround == "German Bank" & TagReturnsGBSI$catchAREA == "Seal Island", "GB to SI", 
                                                 ifelse(TagReturnsGBSI$FishingGround == "Seal Island" & TagReturnsGBSI$catchAREA == "Seal Island", "SI to SI",
                                                 ifelse(TagReturnsGBSI$FishingGround == "Seal Island" & TagReturnsGBSI$catchAREA == "German Bank" |
                                                        TagReturnsGBSI$FishingGround == "Seal Island" & TagReturnsGBSI$catchAREA == "German Bank (Area 7)", "SI to GB", "Other")))))
                                                 
TagReturnsGBSI <- subset(TagReturnsGBSI, subset = (TagLocation == "GB to SI" | TagLocation == "SI to GB"))

ggplot(data = TagReturnsGBSI, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Category", y="Count") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsGBSI %>% 
  group_by(timeDifference) %>%
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays) %>%
  arrange(timeDifference)

kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)

```


### Tag Returns from German Bank Tagging Events

```{r, results = "asis", fig.align='center'}
TagReturnsGB <- subset(TagReturns, subset = (FishingGround == "German Bank"))

TagReturnsGB$TagLocation <- with(TagReturnsGB, ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "German Bank" |
                                                      TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "German Bank (Area 7)", "GB to GB",
                                               ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Scots Bay" |
                                                      TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Scots Bay (Area 8)", "GB to SB",
                                               ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "NB Coastal", "GB to NBC",
                                               ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Grand Manan", "GB to GM",
                                               ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Grand Manan Banks", "GB to GMB",
                                               ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Long Island", "GB to LI",
                                               ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Seal Island", "GB to SI",
                                               ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Yankee Bank", "GB to YB",
                                               ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Trinity", "GB to T",
                                               ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Browns Bank", "GB to BB",
                                               ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "SW Grounds", "GB to SWG",
                                               ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Gannet Dry Ledge", "GB to GDL",
                                               ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Lurcher", "GB to L","Other" ))))))))))))))


ggplot(data = TagReturnsGB, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Category", y="Count") +
        ggtitle("German Bank Tag Returns") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsGB %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)

#Removed category 1 larvae - any caught within 2 days of tagging.

TagReturnsGB <- subset(TagReturnsGB, subset = (category != "1"))


ggplot(data = TagReturnsGB, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(y = "Number of Events", x = "Tag to Catch Location") +
        ggtitle("German Bank Tag Returns excluding fish caught within 2 days of being tagged") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsGB %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)

```

## Tag Returns from Individual Grounds {.tabset .tabset-fade .tabset-pills}

### NB Coastal Tagging Events
```{r, results = "asis", fig.align='center'}

#NB Coastal
TagReturnsNBC <- subset(TagReturns, subset = (FishingGround == "NB Coastal"))

TagReturnsNBC$TagLocation <- with(TagReturnsNBC, ifelse(TagReturnsNBC$FishingGround == "NB Coastal" & TagReturnsNBC$catchAREA == "German Bank" |
                                                        TagReturnsNBC$FishingGround == "NB Coastal" & TagReturnsNBC$catchAREA == "German Bank (Area 7)", "NBC to GB",
                                                 ifelse(TagReturnsNBC$FishingGround == "NB Coastal" & TagReturnsNBC$catchAREA == "Scots Bay" |
                                                        TagReturnsNBC$FishingGround == "NB Coastal" & TagReturnsNBC$catchAREA == "Scots Bay (Area 8)", "NBC to SB",
                                                 ifelse(TagReturnsNBC$FishingGround == "NB Coastal" & TagReturnsNBC$catchAREA == "NB Coastal", "NBC to NBC",
                                                 ifelse(TagReturnsNBC$FishingGround == "NB Coastal" & TagReturnsNBC$catchAREA == "Grand Manan", "NBC to GM",
                                                 ifelse(TagReturnsNBC$FishingGround == "NB Coastal" & TagReturnsNBC$catchAREA == "Grand Manan Banks", "NBC to GMB",
                                                 ifelse(TagReturnsNBC$FishingGround == "NB Coastal" & TagReturnsNBC$catchAREA == "Long Island", "NBC to LI",
                                                 ifelse(TagReturnsNBC$FishingGround == "NB Coastal" & TagReturnsNBC$catchAREA == "Seal Island", "NBC to SI",
                                                 ifelse(TagReturnsNBC$FishingGround == "NB Coastal" & TagReturnsNBC$catchAREA == "Yankee Bank", "NBC to YB",
                                                 ifelse(TagReturnsNBC$FishingGround == "NB Coastal" & TagReturnsNBC$catchAREA == "Trinity", "NBC to T",
                                                 ifelse(TagReturnsNBC$FishingGround == "NB Coastal" & TagReturnsNBC$catchAREA == "Browns Bank", "NBC to BB",
                                                 ifelse(TagReturnsNBC$FishingGround == "NB Coastal" & TagReturnsNBC$catchAREA == "SW Grounds", "NBC to SWG",
                                                 ifelse(TagReturnsNBC$FishingGround == "NB Coastal" & TagReturnsNBC$catchAREA == "Gannet Dry Ledge", "NBC to GDL",
                                                 ifelse(TagReturnsNBC$FishingGround == "NB Coastal" & TagReturnsNBC$catchAREA == "Lurcher", "NBC to L","Other"
                                                 ))))))))))))))

ggplot(data = TagReturnsNBC, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch location", y="Number of Events") +
        ggtitle("NB Coastal Tag Returns") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsNBC %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)
 
#Removed category 1 larvae - any caught within 2 days of tagging.

TagReturnsNBC <- subset(TagReturnsNBC, subset = (category != "1"))

ggplot(data = TagReturnsNBC, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("NB Coastal Tag Returns excluding fish caught within 2 days of being tagged") +
        scale_y_continuous(breaks= pretty_breaks())


Table <- TagReturnsNBC %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)

```

### Grand Manan Tag Returns

```{r, results = "asis", fig.align='center'}

TagReturnsGM <- subset(TagReturns, subset = (FishingGround == "Grand Manan"))

TagReturnsGM$TagLocation <- with(TagReturnsGM, ifelse(TagReturnsGM$FishingGround == "Grand Manan" & TagReturnsGM$catchAREA == "German Bank" |
                                                      TagReturnsGM$FishingGround == "Grand Manan" & TagReturnsGM$catchAREA == "German Bank (Area 7)", "GM to GB",
                                               ifelse(TagReturnsGM$FishingGround == "Grand Manan" & TagReturnsGM$catchAREA == "Scots Bay" |
                                                      TagReturnsGM$FishingGround == "Grand Manan" & TagReturnsGM$catchAREA == "Scots Bay (Area 8)", "GM to SB",
                                               ifelse(TagReturnsGM$FishingGround == "Grand Manan" & TagReturnsGM$catchAREA == "NB Coastal", "GM to NBC",
                                               ifelse(TagReturnsGM$FishingGround == "Grand Manan" & TagReturnsGM$catchAREA == "Grand Manan", "GM to GM",
                                               ifelse(TagReturnsGM$FishingGround == "Grand Manan" & TagReturnsGM$catchAREA == "Grand Manan Banks", "GM to GMB",
                                               ifelse(TagReturnsGM$FishingGround == "Grand Manan" & TagReturnsGM$catchAREA == "Long Island", "GM to LI",
                                               ifelse(TagReturnsGM$FishingGround == "Grand Manan" & TagReturnsGM$catchAREA == "Seal Island", "GM to SI",
                                               ifelse(TagReturnsGM$FishingGround == "Grand Manan" & TagReturnsGM$catchAREA == "Yankee Bank", "GM to YB",
                                               ifelse(TagReturnsGM$FishingGround == "Grand Manan" & TagReturnsGM$catchAREA == "Trinity", "GM to T",
                                               ifelse(TagReturnsGM$FishingGround == "Grand Manan" & TagReturnsGM$catchAREA == "Browns Bank", "GM to BB",
                                               ifelse(TagReturnsGM$FishingGround == "Grand Manan" & TagReturnsGM$catchAREA == "SW Grounds", "GM to SWG",
                                               ifelse(TagReturnsGM$FishingGround == "Grand Manan" & TagReturnsGM$catchAREA == "Gannet Dry Ledge", "GM to GDL",
                                               ifelse(TagReturnsGM$FishingGround == "Grand Manan" & TagReturnsGM$catchAREA == "Lurcher", "GM to L", "Other"
                                                                                                                                     ))))))))))))))

ggplot(data = TagReturnsGM, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Grand Manan Returns") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsGM %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)

#Removed category 1 larvae - any caught within 2 days of tagging.

TagReturnsGM <- subset(TagReturnsGM, subset = (category != "1"))

ggplot(data = TagReturnsGM, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Grand Manan Tag Returns excluding fish caught within 2 days of being tagged") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsGM %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)

```

### Grand Manan Banks Tag Returns 

```{r, results = "asis", fig.align='center'}

TagReturnsGMB <- subset(TagReturns, subset = (FishingGround == "Grand Manan Banks"))

TagReturnsGMB$TagLocation <- with(TagReturnsGMB, ifelse(TagReturnsGMB$FishingGround == "Grand Manan Banks" & TagReturnsGMB$catchAREA == "German Bank" |
                                                        TagReturnsGMB$FishingGround == "Grand Manan Banks" & TagReturnsGMB$catchAREA == "German Bank (Area 7)", "GMB to GB",
                                                 ifelse(TagReturnsGMB$FishingGround == "Grand Manan Banks" & TagReturnsGMB$catchAREA == "Scots Bay" |
                                                        TagReturnsGMB$FishingGround == "Grand Manan Banks" & TagReturnsGMB$catchAREA == "Scots Bay (Area 8)", "GMB to SB",
                                                 ifelse(TagReturnsGMB$FishingGround == "Grand Manan Banks" & TagReturnsGMB$catchAREA == "NB Coastal", "GMB to NBC",
                                                 ifelse(TagReturnsGMB$FishingGround == "Grand Manan Banks" & TagReturnsGMB$catchAREA == "Grand Manan", "GMB to GM",
                                                 ifelse(TagReturnsGMB$FishingGround == "Grand Manan Banks" & TagReturnsGMB$catchAREA == "Grand Manan Banks", "GMB to GMB",
                                                 ifelse(TagReturnsGMB$FishingGround == "Grand Manan Banks" & TagReturnsGMB$catchAREA == "Long Island", "GMB to LI",
                                                 ifelse(TagReturnsGMB$FishingGround == "Grand Manan Banks" & TagReturnsGMB$catchAREA == "Seal Island", "GMB to SI",
                                                 ifelse(TagReturnsGMB$FishingGround == "Grand Manan Banks" & TagReturnsGMB$catchAREA == "Yankee Bank", "GMB to YB",
                                                 ifelse(TagReturnsGMB$FishingGround == "Grand Manan Banks" & TagReturnsGMB$catchAREA == "Trinity", "GMB to T",
                                                 ifelse(TagReturnsGMB$FishingGround == "Grand Manan Banks" & TagReturnsGMB$catchAREA == "Browns Bank", "GMB to BB",
                                                 ifelse(TagReturnsGMB$FishingGround == "Grand Manan Banks" & TagReturnsGMB$catchAREA == "SW Grounds", "GMB to SWG",
                                                 ifelse(TagReturnsGMB$FishingGround == "Grand Manan Banks" & TagReturnsGMB$catchAREA == "Gannet Dry Ledge", "GMB to GDL",
                                                 ifelse(TagReturnsGMB$FishingGround == "Grand Manan Banks" & TagReturnsGMB$catchAREA == "Lurcher", "GMB to L","Other"
                                                                                                                                   ))))))))))))))

ggplot(data = TagReturnsGMB, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Grand Manan Banks Tag Returns") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsGMB %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)

#Removed category 1 larvae - any caught within 2 days of tagging.

TagReturnsGMB <- subset(TagReturnsGMB, subset = (category != "1"))

ggplot(data = TagReturnsGMB, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Grand Manan Banks Tag Returns excluding fish caught within 2 days of being tagged") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsGMB %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)

```

### Long Island Tag Returns

```{r, results = "asis", fig.align='center'}
TagReturnsLI <- subset(TagReturns, subset = (FishingGround == "Long Island"))

TagReturnsLI$TagLocation <- with(TagReturnsLI, ifelse(TagReturnsLI$FishingGround == "Long Island" & TagReturnsLI$catchAREA == "German Bank" |
                                                      TagReturnsLI$FishingGround == "Long Island" & TagReturnsLI$catchAREA == "German Bank (Area 7)", "LI to GB",
                                               ifelse(TagReturnsLI$FishingGround == "Long Island" & TagReturnsLI$catchAREA == "Scots Bay" |
                                                      TagReturnsLI$FishingGround == "Long Island" & TagReturnsLI$catchAREA == "Scots Bay (Area 8)", "LI to SB",
                                               ifelse(TagReturnsLI$FishingGround == "Long Island" & TagReturnsLI$catchAREA == "NB Coastal", "LI to NBC",
                                               ifelse(TagReturnsLI$FishingGround == "Long Island" & TagReturnsLI$catchAREA == "Grand Manan", "LI to GM",
                                               ifelse(TagReturnsLI$FishingGround == "Long Island" & TagReturnsLI$catchAREA == "Grand Manan Banks", "LI to GMB",
                                               ifelse(TagReturnsLI$FishingGround == "Long Island" & TagReturnsLI$catchAREA == "Long Island", "LI to LI",
                                               ifelse(TagReturnsLI$FishingGround == "Long Island" & TagReturnsLI$catchAREA == "Seal Island", "LI to SI",
                                               ifelse(TagReturnsLI$FishingGround == "Long Island" & TagReturnsLI$catchAREA == "Yankee Bank", "LI to YB",
                                               ifelse(TagReturnsLI$FishingGround == "Long Island" & TagReturnsLI$catchAREA == "Trinity", "LI to T",
                                               ifelse(TagReturnsLI$FishingGround == "Long Island" & TagReturnsLI$catchAREA == "Browns Bank", "LI to BB",
                                               ifelse(TagReturnsLI$FishingGround == "Long Island" & TagReturnsLI$catchAREA == "SW Grounds", "LI to SWG",
                                               ifelse(TagReturnsLI$FishingGround == "Long Island" & TagReturnsLI$catchAREA == "Gannet Dry Ledge", "LI to GDL",
                                               ifelse(TagReturnsLI$FishingGround == "Long Island" & TagReturnsLI$catchAREA == "Lurcher", "LI to L","Other"
                                                                                                                                     ))))))))))))))


ggplot(data = TagReturnsLI, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Long Island Tag Returns") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsLI %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)

#Removed category 1 larvae - any caught within 2 days of tagging.

TagReturnsLI <- subset(TagReturnsLI, subset = (category != "1"))

ggplot(data = TagReturnsLI, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Long Island Tag Returns excluding fish caught within 2 days of being tagged") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsLI %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)
```

### Seal Island Tag Returns

```{r, results = "asis", fig.align='center'}
TagReturnsSI <- subset(TagReturns, subset = (FishingGround == "Seal Island"))

TagReturnsSI$TagLocation <- with(TagReturnsSI, ifelse(TagReturnsSI$FishingGround == "Seal Island" & TagReturnsSI$catchAREA == "German Bank" |
                                                      TagReturnsSI$FishingGround == "Seal Island" & TagReturnsSI$catchAREA == "German Bank (Area 7)", "SI to GB",
                                               ifelse(TagReturnsSI$FishingGround == "Seal Island" & TagReturnsSI$catchAREA == "Scots Bay" |
                                                      TagReturnsSI$FishingGround == "Seal Island" & TagReturnsSI$catchAREA == "Scots Bay (Area 8)", "SI to SB",
                                               ifelse(TagReturnsSI$FishingGround == "Seal Island" & TagReturnsSI$catchAREA == "NB Coastal", "SI to NBC",
                                               ifelse(TagReturnsSI$FishingGround == "Seal Island" & TagReturnsSI$catchAREA == "Grand Manan", "SI to GM",
                                               ifelse(TagReturnsSI$FishingGround == "Seal Island" & TagReturnsSI$catchAREA == "Grand Manan Banks", "SI to GMB",
                                               ifelse(TagReturnsSI$FishingGround == "Seal Island" & TagReturnsSI$catchAREA == "Long Island", "SI to LI",
                                               ifelse(TagReturnsSI$FishingGround == "Seal Island" & TagReturnsSI$catchAREA == "Seal Island", "SI to SI",
                                               ifelse(TagReturnsSI$FishingGround == "Seal Island" & TagReturnsSI$catchAREA == "Yankee Bank", "SI to YB",
                                               ifelse(TagReturnsSI$FishingGround == "Seal Island" & TagReturnsSI$catchAREA == "Trinity", "SI to T",
                                               ifelse(TagReturnsSI$FishingGround == "Seal Island" & TagReturnsSI$catchAREA == "Browns Bank", "SI to BB",
                                               ifelse(TagReturnsSI$FishingGround == "Seal Island" & TagReturnsSI$catchAREA == "SW Grounds", "SI to SWG",
                                               ifelse(TagReturnsSI$FishingGround == "Seal Island" & TagReturnsSI$catchAREA == "Gannet Dry Ledge", "SI to GDL",
                                               ifelse(TagReturnsSI$FishingGround == "Seal Island" & TagReturnsSI$catchAREA == "Lurcher", "SI to L", "Other"
                                                                                                                                   ))))))))))))))


ggplot(data = TagReturnsSI, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Seal Island Tag Returns") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsSI %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)

#Removed category 1 larvae - any caught within 2 days of tagging.

TagReturnsSI <- subset(TagReturnsSI, subset = (category != "1"))

ggplot(data = TagReturnsSI, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Seal Island Tag Returns excluding fish caught within 2 days of being tagged") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsSI %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)
```

### Scots Bay Tag Returns 

```{r, results = "asis", fig.align='center'}
TagReturnsSB <- subset(TagReturns, subset = (FishingGround == "Scots Bay"))

TagReturnsSB$TagLocation <- with(TagReturnsSB, ifelse(TagReturnsSB$FishingGround == "Scots Bay" & TagReturnsSB$catchAREA == "German Bank" |
                                                        TagReturnsSB$FishingGround == "Scots Bay" & TagReturnsSB$catchAREA == "German Bank (Area 7)", "SB to GB",
                                               ifelse(TagReturnsSB$FishingGround == "Scots Bay" & TagReturnsSB$catchAREA == "Scots Bay" |
                                                      TagReturnsSB$FishingGround == "Scots Bay" & TagReturnsSB$catchAREA == "Scots Bay (Area 8)", "SB to SB",
                                               ifelse(TagReturnsSB$FishingGround == "Scots Bay" & TagReturnsSB$catchAREA == "NB Coastal", "SB to NBC",
                                               ifelse(TagReturnsSB$FishingGround == "Scots Bay" & TagReturnsSB$catchAREA == "Grand Manan", "SB to GM",
                                               ifelse(TagReturnsSB$FishingGround == "Scots Bay" & TagReturnsSB$catchAREA == "Grand Manan Banks", "SB to GMB",
                                               ifelse(TagReturnsSB$FishingGround == "Scots Bay" & TagReturnsSB$catchAREA == "Long Island", "SB to LI",
                                               ifelse(TagReturnsSB$FishingGround == "Scots Bay" & TagReturnsSB$catchAREA == "Seal Island", "SB to SI",
                                               ifelse(TagReturnsSB$FishingGround == "Scots Bay" & TagReturnsSB$catchAREA == "Yankee Bank", "SB to YB",
                                               ifelse(TagReturnsSB$FishingGround == "Scots Bay" & TagReturnsSB$catchAREA == "Trinity", "SB to T",
                                               ifelse(TagReturnsSB$FishingGround == "Scots Bay" & TagReturnsSB$catchAREA == "Browns Bank", "SB to BB",
                                               ifelse(TagReturnsSB$FishingGround == "Scots Bay" & TagReturnsSB$catchAREA == "SW Grounds", "SB to SWG",
                                               ifelse(TagReturnsSB$FishingGround == "Scots Bay" & TagReturnsSB$catchAREA == "Gannet Dry Ledge", "SB to GDL",
                                               ifelse(TagReturnsSB$FishingGround == "Scots Bay" & TagReturnsSB$catchAREA == "Lurcher", "SB to L","Other"
                                                                                                                            ))))))))))))))

ggplot(data = TagReturnsSB, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Scots Bay Tag Returns") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsSB %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)

#Removed category 1 larvae - any caught within 2 days of tagging.

TagReturnsSB <- subset(TagReturnsSB, subset = (category != "1"))

ggplot(data = TagReturnsSB, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Scots Bay Tag Returns excluding fish caught within 2 days of being tagged") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsSB %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)
```

### Yankee Bank Tag Returns

```{r, results = "asis", fig.align='center'}
TagReturnsYB <- subset(TagReturns, subset = (FishingGround == "Yankee Bank"))

TagReturnsYB$TagLocation <- with(TagReturnsYB, ifelse(TagReturnsYB$FishingGround == "Yankee Bank" & TagReturnsYB$catchAREA == "German Bank" |
                                                      TagReturnsYB$FishingGround == "Yankee Bank" & TagReturnsYB$catchAREA == "German Bank (Area 7)", "YB to GB",
                                               ifelse(TagReturnsYB$FishingGround == "Yankee Bank" & TagReturnsYB$catchAREA == "Scots Bay" |
                                                      TagReturnsYB$FishingGround == "Yankee Bank" & TagReturnsYB$catchAREA == "Scots Bay (Area 8)", "YB to SB",
                                               ifelse(TagReturnsYB$FishingGround == "Yankee Bank" & TagReturnsYB$catchAREA == "NB Coastal", "YB to NBC",
                                               ifelse(TagReturnsYB$FishingGround == "Yankee Bank" & TagReturnsYB$catchAREA == "Grand Manan", "YB to GM",
                                               ifelse(TagReturnsYB$FishingGround == "Yankee Bank" & TagReturnsYB$catchAREA == "Grand Manan Banks", "YB to GMB",
                                               ifelse(TagReturnsYB$FishingGround == "Yankee Bank" & TagReturnsYB$catchAREA == "Long Island", "YB to LI",
                                               ifelse(TagReturnsYB$FishingGround == "Yankee Bank" & TagReturnsYB$catchAREA == "Seal Island", "YB to SI",
                                               ifelse(TagReturnsYB$FishingGround == "Yankee Bank" & TagReturnsYB$catchAREA == "Yankee Bank", "YB to YB",
                                               ifelse(TagReturnsYB$FishingGround == "Yankee Bank" & TagReturnsYB$catchAREA == "Trinity", "YB to T",
                                               ifelse(TagReturnsYB$FishingGround == "Yankee Bank" & TagReturnsYB$catchAREA == "Browns Bank", "YB to BB",
                                               ifelse(TagReturnsYB$FishingGround == "Yankee Bank" & TagReturnsYB$catchAREA == "SW Grounds", "YB to SWG",
                                               ifelse(TagReturnsYB$FishingGround == "Yankee Bank" & TagReturnsYB$catchAREA == "Gannet Dry Ledge", "YB to GDL",
                                               ifelse(TagReturnsYB$FishingGround == "Yankee Bank" & TagReturnsYB$catchAREA == "Lurcher", "YB to L", "Other"
                                                                                                                            ))))))))))))))

ggplot(data = TagReturnsYB, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Yankee Bank Tag Returns") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsYB %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)

#Removed category 1 larvae - any caught within 2 days of tagging.

TagReturnsYB <- subset(TagReturnsYB, subset = (category != "1"))

ggplot(data = TagReturnsYB, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Yankee Bank Tag Returns excluding fish caught within 2 days of being tagged") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsYB %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)
```

### Trinity Tag Returns 

```{r, results = "asis", fig.align='center'}
TagReturnsT <- subset(TagReturns, subset = (FishingGround == "Trinity"))

TagReturnsT$TagLocation <- with(TagReturnsT, ifelse(TagReturnsT$FishingGround == "Trinity" & TagReturnsT$catchAREA == "German Bank" |
                                                    TagReturnsT$FishingGround == "Trinity" & TagReturnsT$catchAREA == "German Bank (Area 7)", "T to GB",
                                             ifelse(TagReturnsT$FishingGround == "Trinity" & TagReturnsT$catchAREA == "Scots Bay" |
                                                    TagReturnsT$FishingGround == "Trinity" & TagReturnsT$catchAREA == "Scots Bay (Area 8)", "T to SB",
                                             ifelse(TagReturnsT$FishingGround == "Trinity" & TagReturnsT$catchAREA == "NB Coastal", "T to NBC",
                                             ifelse(TagReturnsT$FishingGround == "Trinity" & TagReturnsT$catchAREA == "Grand Manan", "T to GM",
                                             ifelse(TagReturnsT$FishingGround == "Trinity" & TagReturnsT$catchAREA == "Grand Manan Banks", "T to GMB",
                                             ifelse(TagReturnsT$FishingGround == "Trinity" & TagReturnsT$catchAREA == "Long Island", "T to LI",
                                             ifelse(TagReturnsT$FishingGround == "Trinity" & TagReturnsT$catchAREA == "Seal Island", "T to SI",
                                             ifelse(TagReturnsT$FishingGround == "Trinity" & TagReturnsT$catchAREA == "Yank", "T to YB",
                                             ifelse(TagReturnsT$FishingGround == "Trinity" & TagReturnsT$catchAREA == "Trinity", "T to T",
                                             ifelse(TagReturnsT$FishingGround == "Trinity" & TagReturnsT$catchAREA == "Browns Bank", "T to BB",
                                             ifelse(TagReturnsT$FishingGround == "Trinity" & TagReturnsT$catchAREA == "SW Grounds", "T to SWG",
                                             ifelse(TagReturnsT$FishingGround == "Trinity" & TagReturnsT$catchAREA == "Gannet Dry Ledge", "T to GDL",
                                             ifelse(TagReturnsT$FishingGround == "Trinity" & TagReturnsT$catchAREA == "Lurcher", "T to L","Other"
                                                                                                                            ))))))))))))))

ggplot(data = TagReturnsT, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Trinity Tag Returns") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsT %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)

#Removed category 1 larvae - any caught within 2 days of tagging.

TagReturnsT <- subset(TagReturnsT, subset = (category != "1"))

ggplot(data = TagReturnsT, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Trinity Tag Returns excluding fish caught within 2 days of being tagged") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsT %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)
```

### Browns Bank Tag Returns

```{r, results = "asis", fig.align='center'}
TagReturnsBB <- subset(TagReturns, subset = (FishingGround == "Browns Bank"))

TagReturnsBB$TagLocation <- with(TagReturnsBB, ifelse(TagReturnsBB$FishingGround == "Browns Bank" & TagReturnsBB$catchAREA == "German Bank" |
                                                      TagReturnsBB$FishingGround == "Browns Bank" & TagReturnsBB$catchAREA == "German Bank (Area 7)", "BB to GB",
                                               ifelse(TagReturnsBB$FishingGround == "Browns Bank" & TagReturnsBB$catchAREA == "Scots Bay" |
                                                      TagReturnsBB$FishingGround == "Browns Bank" & TagReturnsBB$catchAREA == "Scots Bay (Area 8)", "BB to SB",
                                               ifelse(TagReturnsBB$FishingGround == "Browns Bank" & TagReturnsBB$catchAREA == "NB Coastal", "BB to NBC",
                                               ifelse(TagReturnsBB$FishingGround == "Browns Bank" & TagReturnsBB$catchAREA == "Grand Manan", "BB to GM",
                                               ifelse(TagReturnsBB$FishingGround == "Browns Bank" & TagReturnsBB$catchAREA == "Grand Manan Banks", "BB to GMB",
                                               ifelse(TagReturnsBB$FishingGround == "Browns Bank" & TagReturnsBB$catchAREA == "Long Island", "BB to LI",
                                               ifelse(TagReturnsBB$FishingGround == "Browns Bank" & TagReturnsBB$catchAREA == "Seal Island", "BB to SI",
                                               ifelse(TagReturnsBB$FishingGround == "Browns Bank" & TagReturnsBB$catchAREA == "Yank", "BB to YB",
                                               ifelse(TagReturnsBB$FishingGround == "Browns Bank" & TagReturnsBB$catchAREA == "Trinity", "BB to T",
                                               ifelse(TagReturnsBB$FishingGround == "Browns Bank" & TagReturnsBB$catchAREA == "Browns Bank", "BB to BB",
                                               ifelse(TagReturnsBB$FishingGround == "Browns Bank" & TagReturnsBB$catchAREA == "SW Grounds", "BB to SWG",
                                               ifelse(TagReturnsBB$FishingGround == "Browns Bank" & TagReturnsBB$catchAREA == "Gannet Dry Ledge", "BB to GDL",
                                               ifelse(TagReturnsBB$FishingGround == "Browns Bank" & TagReturnsBB$catchAREA == "Lurcher", "BB to L", "Other"
                                                                                                                          ))))))))))))))


ggplot(data = TagReturnsBB, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Browns Bank Tag Returns") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsBB %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)

#Removed category 1 larvae - any caught within 2 days of tagging.

TagReturnsBB <- subset(TagReturnsBB, subset = (category != "1"))

ggplot(data = TagReturnsBB, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Browns Bank Tag Returns excluding fish caught within 2 days of being tagged") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsBB %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)
```

### SW Ground Tag Returns

```{r, results = "asis", fig.align='center'}
TagReturnsSWG <- subset(TagReturns, subset = (FishingGround == "SW Grounds"))

TagReturnsSWG$TagLocation <- with(TagReturnsSWG, ifelse(TagReturnsSWG$FishingGround == "SW Grounds" & TagReturnsSWG$catchAREA == "German Bank" |
                                                        TagReturnsSWG$FishingGround == "SW Grounds" & TagReturnsSWG$catchAREA == "German Bank (Area 7)", "SWG to GB",
                                                 ifelse(TagReturnsSWG$FishingGround == "SW Grounds" & TagReturnsSWG$catchAREA == "Scots Bay" |
                                                        TagReturnsSWG$FishingGround == "SW Grounds" & TagReturnsSWG$catchAREA == "Scots Bay (Area 8)", "SWG to SB",
                                                 ifelse(TagReturnsSWG$FishingGround == "SW Grounds" & TagReturnsSWG$catchAREA == "NB Coastal", "SWG to NBC",
                                                 ifelse(TagReturnsSWG$FishingGround == "SW Grounds" & TagReturnsSWG$catchAREA == "Grand Manan", "SWG to GM",
                                                 ifelse(TagReturnsSWG$FishingGround == "SW Grounds" & TagReturnsSWG$catchAREA == "Grand Manan Banks", "SWG to GMB",
                                                 ifelse(TagReturnsSWG$FishingGround == "SW Grounds" & TagReturnsSWG$catchAREA == "Long Island", "SWG to LI",
                                                 ifelse(TagReturnsSWG$FishingGround == "SW Grounds" & TagReturnsSWG$catchAREA == "Seal Island", "SWG to SI",
                                                 ifelse(TagReturnsSWG$FishingGround == "SW Grounds" & TagReturnsSWG$catchAREA == "Yank", "SWG to YB",
                                                 ifelse(TagReturnsSWG$FishingGround == "SW Grounds" & TagReturnsSWG$catchAREA == "Trinity", "SWG to T",
                                                 ifelse(TagReturnsSWG$FishingGround == "SW Grounds" & TagReturnsSWG$catchAREA == "Browns Bank", "SWG to BB",
                                                 ifelse(TagReturnsSWG$FishingGround == "SW Grounds" & TagReturnsSWG$catchAREA == "SW Grounds", "SWG to SWG",
                                                 ifelse(TagReturnsSWG$FishingGround == "SW Grounds" & TagReturnsSWG$catchAREA == "Gannet Dry Ledge", "SWG to GDL",
                                                 ifelse(TagReturnsSWG$FishingGround == "SW Grounds" & TagReturnsSWG$catchAREA == "Lurcher", "GDL to L","Other"
                                                                                                                            ))))))))))))))

ggplot(data = TagReturnsSWG, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("SW Grounds Tag Returns") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsSWG %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)

#Removed category 1 larvae - any caught within 2 days of tagging.
#Not sure why an NA has popped up

TagReturnsSWG <- subset(TagReturnsSWG, subset = (category != "1"))

ggplot(data = TagReturnsSWG, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("SW Grounds Tag Returns excluding fish caught within 2 days of being tagged") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsSWG %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)
```

### Gannet Dry Ledge Tag Returns 

```{r, results = "asis", fig.align='center'}
TagReturnsGDL <- subset(TagReturns, subset = (FishingGround == "Gannet Dry Ledge"))

TagReturnsGDL$TagLocation <- with(TagReturnsGDL, ifelse(TagReturnsGDL$FishingGround == "Gannet Dry Ledge" & TagReturnsGDL$catchAREA == "German Bank" |
                                                        TagReturnsGDL$FishingGround == "Gannet Dry Ledge" & TagReturnsGDL$catchAREA == "German Bank (Area 7)", "GDL to GB",
                                                 ifelse(TagReturnsGDL$FishingGround == "Gannet Dry Ledge" & TagReturnsGDL$catchAREA == "Scots Bay" |
                                                        TagReturnsGDL$FishingGround == "Gannet Dry Ledge" & TagReturnsGDL$catchAREA == "Scots Bay (Area 8)", "GDL to SB",
                                                 ifelse(TagReturnsGDL$FishingGround == "Gannet Dry Ledge" & TagReturnsGDL$catchAREA == "NB Coastal", "GDL to NBC",
                                                 ifelse(TagReturnsGDL$FishingGround == "Gannet Dry Ledge" & TagReturnsGDL$catchAREA == "Grand Manan", "GDL to GM",
                                                 ifelse(TagReturnsGDL$FishingGround == "Gannet Dry Ledge" & TagReturnsGDL$catchAREA == "Grand Manan Banks", "GDL to GMB",
                                                 ifelse(TagReturnsGDL$FishingGround == "Gannet Dry Ledge" & TagReturnsGDL$catchAREA == "Long Island", "GDL to LI",
                                                 ifelse(TagReturnsGDL$FishingGround == "Gannet Dry Ledge" & TagReturnsGDL$catchAREA == "Seal Island", "GDL to SI",
                                                 ifelse(TagReturnsGDL$FishingGround == "Gannet Dry Ledge" & TagReturnsGDL$catchAREA == "Yank", "GDL to YB",
                                                 ifelse(TagReturnsGDL$FishingGround == "Gannet Dry Ledge" & TagReturnsGDL$catchAREA == "Trinity", "GDL to T",
                                                 ifelse(TagReturnsGDL$FishingGround == "Gannet Dry Ledge" & TagReturnsGDL$catchAREA == "Browns Bank", "GDL to BB",
                                                 ifelse(TagReturnsGDL$FishingGround == "Gannet Dry Ledge" & TagReturnsGDL$catchAREA == "SW Grounds", "GDL to SWG",
                                                 ifelse(TagReturnsGDL$FishingGround == "Gannet Dry Ledge" & TagReturnsGDL$catchAREA == "Gannet Dry Ledge", "GDL to GDL",
                                                 ifelse(TagReturnsGDL$FishingGround == "Gannet Dry Ledge" & TagReturnsGDL$catchAREA == "Lurcher", "GDL to L","Other"
                                                                                                                              ))))))))))))))

ggplot(data = TagReturnsGDL, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Gannet Dry Ledge Tag Returns") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsGDL %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)

#Removed category 1 larvae - any caught within 2 days of tagging.

TagReturnsGDL <- subset(TagReturnsGDL, subset = (category != "1"))

ggplot(data = TagReturnsGDL, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Gannet Dry Ledget Tag Returns excluding fish caught within 2 days of being tagged") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsGDL %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)
```

### Lurcher Tag Returns 

```{r, results = "asis", fig.align='center'}
TagReturnsL <- subset(TagReturns, subset = (FishingGround == "Lurcher"))

TagReturnsL$TagLocation <- with(TagReturnsL, ifelse(TagReturnsL$FishingGround == "Lurcher" & TagReturnsL$catchAREA == "German Bank" |
                                                    TagReturnsL$FishingGround == "Lurcher" & TagReturnsL$catchAREA == "German Bank (Area 7)", "L to GB",
                                             ifelse(TagReturnsL$FishingGround == "Lurcher" & TagReturnsL$catchAREA == "Scots Bay" |
                                                    TagReturnsL$FishingGround == "Lurcher" & TagReturnsL$catchAREA == "Scots Bay (Area 8)", "L to SB",
                                             ifelse(TagReturnsL$FishingGround == "Lurcher" & TagReturnsL$catchAREA == "NB Coastal", "L to NBC",
                                             ifelse(TagReturnsL$FishingGround == "Lurcher" & TagReturnsL$catchAREA == "Grand Manan", "L to GM",
                                             ifelse(TagReturnsL$FishingGround == "Lurcher" & TagReturnsL$catchAREA == "Grand Manan Banks", "L to GMB",
                                             ifelse(TagReturnsL$FishingGround == "Lurcher" & TagReturnsL$catchAREA == "Long Island", "L to LI",
                                             ifelse(TagReturnsL$FishingGround == "Lurcher" & TagReturnsL$catchAREA == "Seal Island", "L to SI",
                                             ifelse(TagReturnsL$FishingGround == "Lurcher" & TagReturnsL$catchAREA == "Yank", "L to YB",
                                             ifelse(TagReturnsL$FishingGround == "Lurcher" & TagReturnsL$catchAREA == "Trinity", "L to T",
                                             ifelse(TagReturnsL$FishingGround == "Lurcher" & TagReturnsL$catchAREA == "Browns Bank", "L to BB",
                                             ifelse(TagReturnsL$FishingGround == "Lurcher" & TagReturnsL$catchAREA == "SW Grounds", "L to SWG",
                                             ifelse(TagReturnsL$FishingGround == "Lurcher" & TagReturnsL$catchAREA == "Gannet Dry Ledge", "L to GDL",
                                             ifelse(TagReturnsL$FishingGround == "Lurcher" & TagReturnsL$catchAREA == "Lurcher", "L to L", "Other"
                                                                                                                              ))))))))))))))

ggplot(data = TagReturnsL, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Lurcher Tag Returns") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsL %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)

kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)

#Removed category 1 larvae - any caught within 2 days of tagging.

TagReturnsL <- subset(TagReturnsL, subset = (category != "1"))

ggplot(data = TagReturnsL, (aes(TagLocation, fill = category))) + 
        geom_histogram(binwidth=1, colour = "white", stat = "count") + 
        theme(panel.background = element_rect(fill = "white", colour = "grey50")) + 
        labs(x = "Tag to Catch Location", y="Number of Events") +
        ggtitle("Lurcher Tag Returns excluding fish caught within 2 days of being tagged") +
        scale_y_continuous(breaks= pretty_breaks())

Table <- TagReturnsL %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)


kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
  kable_paper("striped", full_width = F)
```

### Gear Types

```{r, results = "asis", fig.align='center'}

GearTable <- TagReturns %>% 
  dplyr::select(TAG_NUMBER,
                category,
                Date,
                FishingGround,
                DATE,
                catchAREA,
                GearType,
                timeDifference,
                AvgtimeDifference,
                timeDifferenceMin,
                timeDifferenceMax,
                No.InCategory,
                No.ofSameNumberOfDays)%>%
  arrange(timeDifference)

GearTable$Count = 1
GearTable<-subset(GearTable, subset = (GearType != "N/A"))

ggplot(GearTable, aes(x=GearType, y = Count, fill = factor(category))) +
  geom_bar(stat="identity") +
  labs(y = "Number of Events", x = "Gear Type") +
  ggtitle("Tag Return") +
  labs(fill = "Category")

GearWithout1 <- subset(GearTable, subset = (category != 1))

ggplot(GearWithout1, aes(x=GearType, y = Count, fill = factor(category))) +
  geom_bar(stat="identity") +
  labs(y = "Number of Events", x = "Gear Type") +
  ggtitle("Tag Return") +
  labs(fill = "Category")



```
### Weirs

```{r, results = "asis", fig.align='center'}

WeirTable <- subset(GearTable, subset = (GearType != "Purse Seine"))
WeirTable <- subset(WeirTable, subset = (GearType != "Mid Water Trawl"))

ggplot(WeirTable, aes(x=GearType, y = Count, fill = factor(category))) +
  geom_bar(stat="identity") +
  labs(y = "Number of Events", x = "Gear Type") +
  ggtitle("Tag Return to Gear Type") +
  labs(fill = "Category")

ggplot(WeirTable, aes(x=GearType, y = Count, fill = factor(FishingGround))) +
  geom_bar(stat="identity") +
  labs(y = "Number of Events", x = "Gear Type") +
  ggtitle("Tag Return to gear type from specific tagging ground") +
  labs(fill = "Category")

```
