labs(x = "Tag to Catch Location", y="Number of Events") +
ggtitle("Lurcher Tag Returns excluding fish caught within 2 days of being tagged") +
scale_y_continuous(breaks= pretty_breaks())
# Table <- TagReturnsL %>%
#   dplyr::select(TAG_NUMBER,
#                 category,
#                 Date,
#                 FishingGround,
#                 DATE,
#                 catchAREA,
#                 timeDifference,
#                 AvgtimeDifference,
#                 timeDifferenceMin,
#                 timeDifferenceMax,
#                 No.InCategory,
#                 No.ofSameNumberOfDays)%>%
#   arrange(timeDifference)
#
#
# kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
#   kable_paper("striped", full_width = F)
SummaryTable <- TagReturnsL %>%
group_by(TagLocation, category) %>%
count()
kbl(SummaryTable, col.names = c("Tag Location", "Category", "Abundance in Category"), align = "c") %>%
kable_paper("striped", full_width = F)
GearTable <- TagReturns %>%
dplyr::select(TAG_NUMBER,
category,
Date,
FishingGround,
DATE,
catchAREA,
GearType,
timeDifference,
AvgtimeDifference,
timeDifferenceMin,
timeDifferenceMax,
No.InCategory,
No.ofSameNumberOfDays)%>%
arrange(timeDifference)
GearTable$Count = 1
GearTable<-subset(GearTable, subset = (GearType != "N/A"))
ggplot(GearTable, aes(x=GearType, y = Count, fill = factor(category))) +
geom_bar(stat="identity") +
labs(y = "Number of Events", x = "Gear Type") +
ggtitle("Tag Return") +
labs(fill = "Category")
GearWithout1 <- subset(GearTable, subset = (category != 1))
ggplot(GearWithout1, aes(x=GearType, y = Count, fill = factor(category))) +
geom_bar(stat="identity") +
labs(y = "Number of Events", x = "Gear Type") +
ggtitle("Tag Return") +
labs(fill = "Category")
SummaryTable <- GearWithout1 %>%
group_by(GearType, category) %>%
count()
kbl(SummaryTable, col.names = c("Gear Type", "Category", "Abundance in Category"), align = "c") %>%
kable_paper("striped", full_width = F)
WeirTable <- subset(GearTable, subset = (GearType != "Purse Seine"))
WeirTable <- subset(WeirTable, subset = (GearType != "Mid Water Trawl"))
ggplot(WeirTable, aes(x=GearType, y = Count, fill = factor(category))) +
geom_bar(stat="identity") +
labs(y = "Number of Events", x = "Gear Type") +
ggtitle("Tag Return to Gear Type") +
labs(fill = "Category")
ggplot(WeirTable, aes(x=GearType, y = Count, fill = factor(FishingGround))) +
geom_bar(stat="identity") +
labs(y = "Number of Events", x = "Gear Type") +
ggtitle("Tag Return to gear type from specific tagging ground") +
labs(fill = "Tagging Ground")
SummaryTable <-WeirTable %>%
group_by(GearType, category) %>%
count()
kbl(SummaryTable, col.names = c("Gear Type", "Category", "Abundance in Category"), align = "c") %>%
kable_paper("striped", full_width = F)
GBSB <- GBSB %>%
group_by(category) %>%
mutate(No.InCategory = length(category))
View(GBSB)
#TagReturnsSubset <- TagReturns[sample(1:nrow(TagReturns), 100, replace = FALSE),]
#Need to change abundance on tables.
GBtoSB <- subset(TagReturns, subset = (FishingGround == "Scots Bay" & catchAREA == "German Bank" |
FishingGround == "German Bank" & catchAREA == "Scots Bay" |
FishingGround == "Scots Bay" & catchAREA == "German Bank (Area 7)" |
FishingGround == "German Bank" & catchAREA == "Scots Bay (Area 8)" ))
GBtoSB$TagLocation <- with(GBtoSB, ifelse(GBtoSB$FishingGround == "Scots Bay", "SB to GB",
ifelse(GBtoSB$FishingGround == "German Bank", "GB to SB","Other")))
GBtoSB$timeDifference <- as.numeric(GBtoSB$timeDifference)
GBSB <- subset(GBtoSB, TagLocation == "GB to SB" )
GBSB$timeDifference <- as.numeric(GBSB$timeDifference)
GBSB <- GBSB %>%
group_by(category) %>%
mutate(No.InCategory = length(category))
SBGB <- subset(GBtoSB, TagLocation == "SB to GB")
#SBGB$timeDifference <- as.numeric(GBSB$timeDifference)
ggplot(GBSB, aes(x=category, y = length(count), fill = factor(timeDifferenceMax))) +
geom_bar(stat="identity") +
labs(y = "Number of Events", x = "Category") +
ggtitle("Tag Returns that started in German Bank and were retrieved in Scots Bay") +
labs(fill = "Days between tagging event and tag return") +
scale_fill_discrete(breaks = c("2", "10", "30", "133", "365", "715", "1079", "2092"), name = "Maximum time difference between tag and recapture")
TableGBSB <- GBSB %>%
dplyr::select(TAG_NUMBER,
category,
Date,
FishingGround,
DATE,
catchAREA,
timeDifference,
AvgtimeDifference,
timeDifferenceMin,
timeDifferenceMax,
No.InCategory,
No.ofSameNumberOfDays)%>%
arrange(timeDifference)
# kbl(TableGBSB, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
#   kable_paper("striped", full_width = F)
SummaryTable <- subset(TableGBSB, select = -c(TAG_NUMBER,timeDifference, Date, DATE,  No.ofSameNumberOfDays))
SummaryTable <- unique(SummaryTable) %>%
arrange(category)
kbl(SummaryTable, col.names = c("Category", "Initial Tagging Ground", "Tag Retrieval Ground", "Average Time from tagging event", "Minimum Time Difference", "Maximum Time Difference", "Abundance in Category"), align = "c") %>%
kable_paper("striped", full_width = F)
ggplot(SBGB, aes(x=category, y = length(count), fill = factor(timeDifferenceMax))) +
geom_bar(stat="identity") +
labs(y = "Number of Events", x = "Category") +
ggtitle("Tag Returns that started in Scots Bay and were retrieved in German Bank") +
labs(fill = "Days between tagging event and tag return") +
scale_fill_discrete(breaks = c("10", "30", "133", "715"), name = "Maximum time difference between tag and recapture")
TableSBGB <- SBGB %>%
dplyr::select(TAG_NUMBER,
category,
Date,
FishingGround,
DATE,
catchAREA,
timeDifference,
AvgtimeDifference,
timeDifferenceMin,
timeDifferenceMax,
No.InCategory,
No.ofSameNumberOfDays)%>%
arrange(timeDifference)
# kbl(TableSBGB, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
#   kable_paper("striped", full_width = F)
SummaryTable <- subset(TableSBGB, select = -c(TAG_NUMBER, timeDifference, Date, DATE,  No.ofSameNumberOfDays))
SummaryTable <- unique(SummaryTable) %>%
arrange(category)
kbl(SummaryTable, col.names = c("Category", "Initial Tagging Ground", "Tag Retrieval Ground", "Average Time from tagging event", "Minimum Time Difference", "Maximum Time Difference", "Abundance in Category"), align = "c") %>%
kable_paper("striped", full_width = F)
SBGB <- SBGB %>%
group_by(category) %>%
mutate(No.InCategory = length(category))
#TagReturnsSubset <- TagReturns[sample(1:nrow(TagReturns), 100, replace = FALSE),]
#Need to change abundance on tables.
GBtoSB <- subset(TagReturns, subset = (FishingGround == "Scots Bay" & catchAREA == "German Bank" |
FishingGround == "German Bank" & catchAREA == "Scots Bay" |
FishingGround == "Scots Bay" & catchAREA == "German Bank (Area 7)" |
FishingGround == "German Bank" & catchAREA == "Scots Bay (Area 8)" ))
GBtoSB$TagLocation <- with(GBtoSB, ifelse(GBtoSB$FishingGround == "Scots Bay", "SB to GB",
ifelse(GBtoSB$FishingGround == "German Bank", "GB to SB","Other")))
GBtoSB$timeDifference <- as.numeric(GBtoSB$timeDifference)
GBSB <- subset(GBtoSB, TagLocation == "GB to SB" )
GBSB$timeDifference <- as.numeric(GBSB$timeDifference)
GBSB <- GBSB %>%
group_by(category) %>%
mutate(No.InCategory = length(category))
SBGB <- subset(GBtoSB, TagLocation == "SB to GB")
#SBGB$timeDifference <- as.numeric(GBSB$timeDifference)
SBGB <- SBGB %>%
group_by(category) %>%
mutate(No.InCategory = length(category))
ggplot(GBSB, aes(x=category, y = length(count), fill = factor(timeDifferenceMax))) +
geom_bar(stat="identity") +
labs(y = "Number of Events", x = "Category") +
ggtitle("Tag Returns that started in German Bank and were retrieved in Scots Bay") +
labs(fill = "Days between tagging event and tag return") +
scale_fill_discrete(breaks = c("2", "10", "30", "133", "365", "715", "1079", "2092"), name = "Maximum time difference between tag and recapture")
TableGBSB <- GBSB %>%
dplyr::select(TAG_NUMBER,
category,
Date,
FishingGround,
DATE,
catchAREA,
timeDifference,
AvgtimeDifference,
timeDifferenceMin,
timeDifferenceMax,
No.InCategory,
No.ofSameNumberOfDays)%>%
arrange(timeDifference)
# kbl(TableGBSB, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
#   kable_paper("striped", full_width = F)
SummaryTable <- subset(TableGBSB, select = -c(TAG_NUMBER,timeDifference, Date, DATE,  No.ofSameNumberOfDays))
SummaryTable <- unique(SummaryTable) %>%
arrange(category)
kbl(SummaryTable, col.names = c("Category", "Initial Tagging Ground", "Tag Retrieval Ground", "Average Time from tagging event", "Minimum Time Difference", "Maximum Time Difference", "Abundance in Category"), align = "c") %>%
kable_paper("striped", full_width = F)
ggplot(SBGB, aes(x=category, y = length(count), fill = factor(timeDifferenceMax))) +
geom_bar(stat="identity") +
labs(y = "Number of Events", x = "Category") +
ggtitle("Tag Returns that started in Scots Bay and were retrieved in German Bank") +
labs(fill = "Days between tagging event and tag return") +
scale_fill_discrete(breaks = c("10", "30", "133", "715"), name = "Maximum time difference between tag and recapture")
TableSBGB <- SBGB %>%
dplyr::select(TAG_NUMBER,
category,
Date,
FishingGround,
DATE,
catchAREA,
timeDifference,
AvgtimeDifference,
timeDifferenceMin,
timeDifferenceMax,
No.InCategory,
No.ofSameNumberOfDays)%>%
arrange(timeDifference)
# kbl(TableSBGB, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
#   kable_paper("striped", full_width = F)
SummaryTable <- subset(TableSBGB, select = -c(TAG_NUMBER, timeDifference, Date, DATE,  No.ofSameNumberOfDays))
SummaryTable <- unique(SummaryTable) %>%
arrange(category)
kbl(SummaryTable, col.names = c("Category", "Initial Tagging Ground", "Tag Retrieval Ground", "Average Time from tagging event", "Minimum Time Difference", "Maximum Time Difference", "Abundance in Category"), align = "c") %>%
kable_paper("striped", full_width = F)
TagReturns$TagLocation <- with(TagReturns, ifelse(TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA == "German Bank" |
TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA == "German Bank (Area 7)"  , "SB to GB",
ifelse(TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA == "Scots Bay" |
TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA == "Scots Bay (Area 8)", "GB to SB",
ifelse(TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA == "German Bank", "GB to GB",
ifelse(TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA == "Scots Bay", "SB to SB",
ifelse(TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA != "Scots Bay" |
TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA != "German Bank", "SB to Other",
ifelse(TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA != "Scots Bay" |
TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA != "German Bank", "GB to Other", "Other")))))))
TagReturns1 <- subset(TagReturns, TagLocation != "Other")
TagReturns1 <- subset(TagReturns1, TagLocation != "SB to Other")
TagReturns1 <- subset(TagReturns1, TagLocation != "GB to Other")
ggplot(data = TagReturns1, (aes(TagLocation, fill = category))) +
geom_histogram(binwidth=1, colour = "white", stat = "count") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
labs(x = "Category", y="Count")+
scale_y_continuous(breaks= pretty_breaks())
Table <- TagReturns1 %>%
dplyr::select(TAG_NUMBER,
category,
Date,
FishingGround,
DATE,
catchAREA,
timeDifference,
AvgtimeDifference,
timeDifferenceMin,
timeDifferenceMax,
No.InCategory,
No.ofSameNumberOfDays)%>%
arrange(timeDifference)
SummaryTable <- subset(Table, select = -c(TAG_NUMBER,timeDifference, Date, DATE,  No.ofSameNumberOfDays))
SummaryTable <- unique(SummaryTable) %>%
arrange(category)
kbl(SummaryTable, col.names = c("Category", "Initial Tagging Ground", "Tag Retrieval Ground", "Average Time from tagging event", "Minimum Time Difference", "Maximum Time Difference", "Abundance in Category"), align = "c") %>%
kable_paper("striped", full_width = F)
# Missing GB to SB now, not sure why. When removing category 1 items for GB to SB show up. Possibly it's because there is more category difference when going from GB to SB, so it ends up not showing?
TagReturns$TagLocation <- with(TagReturns, ifelse(TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA == "German Bank" |
TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA == "German Bank (Area 7)"  , "SB to GB",
ifelse(TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA == "Scots Bay" |
TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA == "Scots Bay (Area 8)", "GB to SB",
ifelse(TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA == "German Bank", "GB to GB",
ifelse(TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA == "Scots Bay", "SB to SB",
ifelse(TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA != "Scots Bay" |
TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA != "German Bank", "SB to Other",
ifelse(TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA != "Scots Bay" |
TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA != "German Bank", "GB to Other", "Other")))))))
TagReturns1 <- subset(TagReturns, TagLocation != "Other")
TagReturns1 <- subset(TagReturns1, TagLocation != "SB to Other")
TagReturns1 <- subset(TagReturns1, TagLocation != "GB to Other")
ggplot(data = TagReturns1, (aes(TagLocation, fill = category))) +
geom_histogram(binwidth=1, colour = "white", stat = "count") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
labs(x = "Category", y="Count")+
scale_y_continuous(breaks= pretty_breaks())
Table <- TagReturns1 %>%
dplyr::select(TAG_NUMBER,
category,
Date,
FishingGround,
DATE,
catchAREA,
timeDifference,
AvgtimeDifference,
timeDifferenceMin,
timeDifferenceMax,
No.InCategory,
No.ofSameNumberOfDays)%>%
arrange(timeDifference)
# kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
#   kable_paper("striped", full_width = F)
SummaryTable <- subset(Table, select = -c(TAG_NUMBER,timeDifference, Date, DATE,  No.ofSameNumberOfDays))
SummaryTable <- unique(SummaryTable) %>%
arrange(category)
kbl(SummaryTable, col.names = c("Category", "Initial Tagging Ground", "Tag Retrieval Ground", "Average Time from tagging event", "Minimum Time Difference", "Maximum Time Difference", "Abundance in Category"), align = "c") %>%
kable_paper("striped", full_width = F)
View(TagReturns1)
TagReturns1 <- TagReturns1 %>%
group_by(TagLocation, category) %>%
mutate(No.InCategory = length(category))
TagReturns$TagLocation <- with(TagReturns, ifelse(TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA == "German Bank" |
TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA == "German Bank (Area 7)"  , "SB to GB",
ifelse(TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA == "Scots Bay" |
TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA == "Scots Bay (Area 8)", "GB to SB",
ifelse(TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA == "German Bank", "GB to GB",
ifelse(TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA == "Scots Bay", "SB to SB",
ifelse(TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA != "Scots Bay" |
TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA != "German Bank", "SB to Other",
ifelse(TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA != "Scots Bay" |
TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA != "German Bank", "GB to Other", "Other")))))))
TagReturns1 <- subset(TagReturns, TagLocation != "Other")
TagReturns1 <- subset(TagReturns1, TagLocation != "SB to Other")
TagReturns1 <- subset(TagReturns1, TagLocation != "GB to Other")
TagReturns1 <- TagReturns1 %>%
group_by(TagLocation, category) %>%
mutate(No.InCategory = length(category))
ggplot(data = TagReturns1, (aes(TagLocation, fill = category))) +
geom_histogram(binwidth=1, colour = "white", stat = "count") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
labs(x = "Category", y="Count")+
scale_y_continuous(breaks= pretty_breaks())
Table <- TagReturns1 %>%
dplyr::select(TAG_NUMBER,
category,
Date,
FishingGround,
DATE,
catchAREA,
timeDifference,
AvgtimeDifference,
timeDifferenceMin,
timeDifferenceMax,
No.InCategory,
No.ofSameNumberOfDays)%>%
arrange(timeDifference)
# kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
#   kable_paper("striped", full_width = F)
SummaryTable <- subset(Table, select = -c(TAG_NUMBER,timeDifference, Date, DATE,  No.ofSameNumberOfDays))
SummaryTable <- unique(SummaryTable) %>%
arrange(category)
kbl(SummaryTable, col.names = c("Category", "Initial Tagging Ground", "Tag Retrieval Ground", "Average Time from tagging event", "Minimum Time Difference", "Maximum Time Difference", "Abundance in Category"), align = "c") %>%
kable_paper("striped", full_width = F)
View(SummaryTable)
SummaryTable <- subset(Table, select = -c(TAG_NUMBER,TagLocation, timeDifference, Date, DATE,  No.ofSameNumberOfDays))
SummaryTable <- unique(SummaryTable) %>%
arrange(category)
kbl(SummaryTable, col.names = c("Category", "Initial Tagging Ground", "Tag Retrieval Ground", "Average Time from tagging event", "Minimum Time Difference", "Maximum Time Difference", "Abundance in Category"), align = "c") %>%
kable_paper("striped", full_width = F)
TagReturns$TagLocation <- with(TagReturns, ifelse(TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA == "German Bank" |
TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA == "German Bank (Area 7)"  , "SB to GB",
ifelse(TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA == "Scots Bay" |
TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA == "Scots Bay (Area 8)", "GB to SB",
ifelse(TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA == "German Bank", "GB to GB",
ifelse(TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA == "Scots Bay", "SB to SB",
ifelse(TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA != "Scots Bay" |
TagReturns$FishingGround == "Scots Bay" & TagReturns$catchAREA != "German Bank", "SB to Other",
ifelse(TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA != "Scots Bay" |
TagReturns$FishingGround == "German Bank" & TagReturns$catchAREA != "German Bank", "GB to Other", "Other")))))))
TagReturns1 <- subset(TagReturns, TagLocation != "Other")
TagReturns1 <- subset(TagReturns1, TagLocation != "SB to Other")
TagReturns1 <- subset(TagReturns1, TagLocation != "GB to Other")
TagReturns1 <- TagReturns1 %>%
group_by(TagLocation, category) %>%
mutate(No.InCategory = length(category))
ggplot(data = TagReturns1, (aes(TagLocation, fill = category))) +
geom_histogram(binwidth=1, colour = "white", stat = "count") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
labs(x = "Category", y="Count")+
scale_y_continuous(breaks= pretty_breaks())
Table <- TagReturns1 %>%
dplyr::select(TAG_NUMBER,
category,
Date,
FishingGround,
DATE,
catchAREA,
timeDifference,
AvgtimeDifference,
timeDifferenceMin,
timeDifferenceMax,
No.InCategory,
No.ofSameNumberOfDays)%>%
arrange(timeDifference)
# kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
#   kable_paper("striped", full_width = F)
SummaryTable <- subset(Table, select = -c(TAG_NUMBER,TagLocation, timeDifference, Date, DATE,  No.ofSameNumberOfDays))
SummaryTable <- unique(SummaryTable) %>%
arrange(category)
kbl(SummaryTable, col.names = c("Category", "Initial Tagging Ground", "Tag Retrieval Ground", "Average Time from tagging event", "Minimum Time Difference", "Maximum Time Difference", "Abundance in Category"), align = "c") %>%
kable_paper("striped", full_width = F)
TagReturnsGBSI <- subset(TagReturns, subset = (FishingGround == "German Bank" | FishingGround == "Seal Island"))
TagReturnsGBSI <- subset(TagReturnsGBSI, subset = (catchAREA == "German Bank") | catchAREA == "Seal Island" | catchAREA == "German Bank (Area 7)")
TagReturnsGBSI$TagLocation <- with(TagReturnsGBSI, ifelse(TagReturnsGBSI$FishingGround == "German Bank" & TagReturnsGBSI$catchAREA == "German Bank" |
TagReturnsGBSI$FishingGround == "German Bank" & TagReturnsGBSI$catchAREA == "German Bank (Area 7)", "GB to GB",
ifelse(TagReturnsGBSI$FishingGround == "German Bank" & TagReturnsGBSI$catchAREA == "Seal Island", "GB to SI",
ifelse(TagReturnsGBSI$FishingGround == "Seal Island" & TagReturnsGBSI$catchAREA == "Seal Island", "SI to SI",
ifelse(TagReturnsGBSI$FishingGround == "Seal Island" & TagReturnsGBSI$catchAREA == "German Bank" |
TagReturnsGBSI$FishingGround == "Seal Island" & TagReturnsGBSI$catchAREA == "German Bank (Area 7)", "SI to GB", "Other")))))
TagReturnsGBSI <- subset(TagReturnsGBSI, subset = (TagLocation == "GB to SI" | TagLocation == "SI to GB"))
TagReturnsGBSI <- TagReturnsGBSI %>%
group_by(TagLocation, category) %>%
mutate(No.InCategory = length(category))
ggplot(data = TagReturnsGBSI, (aes(TagLocation, fill = category))) +
geom_histogram(binwidth=1, colour = "white", stat = "count") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
labs(x = "Category", y="Count") +
scale_y_continuous(breaks= pretty_breaks())
Table <- TagReturnsGBSI %>%
group_by(timeDifference) %>%
dplyr::select(TAG_NUMBER,
category,
Date,
FishingGround,
DATE,
catchAREA,
timeDifference,
AvgtimeDifference,
timeDifferenceMin,
timeDifferenceMax,
No.InCategory,
No.ofSameNumberOfDays) %>%
arrange(timeDifference)
# kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
#   kable_paper("striped", full_width = F)
SummaryTable <- subset(Table, select = -c(TAG_NUMBER,timeDifference, Date, DATE,  No.ofSameNumberOfDays))
SummaryTable <- unique(SummaryTable) %>%
arrange(category)
kbl(SummaryTable, col.names = c("Category", "Initial Tagging Ground", "Tag Retrieval Ground", "Average Time from tagging event", "Minimum Time Difference", "Maximum Time Difference", "Abundance in Category"), align = "c") %>%
kable_paper("striped", full_width = F)
TagReturnsGB <- subset(TagReturns, subset = (FishingGround == "German Bank"))
TagReturnsGB$TagLocation <- with(TagReturnsGB, ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "German Bank" |
TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "German Bank (Area 7)", "GB to GB",
ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Scots Bay" |
TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Scots Bay (Area 8)", "GB to SB",
ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "NB Coastal", "GB to NBC",
ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Grand Manan", "GB to GM",
ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Grand Manan Banks", "GB to GMB",
ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Long Island", "GB to LI",
ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Seal Island", "GB to SI",
ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Yankee Bank", "GB to YB",
ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Trinity", "GB to T",
ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Browns Bank", "GB to BB",
ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "SW Grounds", "GB to SWG",
ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Gannet Dry Ledge", "GB to GDL",
ifelse(TagReturnsGB$FishingGround == "German Bank" & TagReturnsGB$catchAREA == "Lurcher", "GB to L","Other" ))))))))))))))
TagReturnsGB  <- subset(TagReturnsGB, TagLocation != "Other")
SummaryTable <- TagReturnsGB %>%
group_by(TagLocation, category) %>%
count()
# kbl(SummaryTable, col.names = c("Tag Location", "Category", "Abundance in Category"), align = "c") %>%
#   kable_paper("striped", full_width = F)
# ggplot(data = TagReturnsGB, (aes(TagLocation, fill = category))) +
#         geom_histogram(binwidth=1, colour = "white", stat = "count") +
#         theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
#         labs(x = "Category", y="Count") +
#         ggtitle("German Bank Tag Returns") +
#         scale_y_continuous(breaks= pretty_breaks())
# Table <- TagReturnsGB %>%
#   dplyr::select(TAG_NUMBER,
#                 category,
#                 Date,
#                 FishingGround,
#                 DATE,
#                 catchAREA,
#                 timeDifference,
#                 AvgtimeDifference,
#                 timeDifferenceMin,
#                 timeDifferenceMax,
#                 No.InCategory,
#                 No.ofSameNumberOfDays)%>%
#   arrange(timeDifference)
#
#
# kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
#   kable_paper("striped", full_width = F)
#Removed category 1 larvae - any caught within 2 days of tagging.
TagReturnsGB <- subset(TagReturnsGB, subset = (category != "1"))
ggplot(data = TagReturnsGB, (aes(TagLocation, fill = category))) +
geom_histogram(binwidth=1, colour = "white", stat = "count") +
theme(panel.background = element_rect(fill = "white", colour = "grey50")) +
labs(y = "Number of Events", x = "Tag to Catch Location") +
ggtitle("German Bank Tag Returns excluding fish caught within 2 days of being tagged") +
scale_y_continuous(breaks= pretty_breaks())
Table <- TagReturnsGB %>%
dplyr::select(TAG_NUMBER,
category,
Date,
FishingGround,
DATE,
catchAREA,
timeDifference,
AvgtimeDifference,
timeDifferenceMin,
timeDifferenceMax,
No.InCategory,
No.ofSameNumberOfDays)
#
#
# kbl(Table, col.names=c("Tag Number", "Category", "Tagged Date", "Tagged Ground", "Catch Date", "Catch Area", "Time Difference (days)", "Average Time Difference (days)", "Minimum Time Difference", "Maximum Time Difference", "Amount in the Same Category", "Amount with the same number of Days"), align = "c") %>%
#   kable_paper("striped", full_width = F)
SummaryTable <- TagReturnsGB %>%
group_by(TagLocation, category) %>%
count()
kbl(SummaryTable, col.names = c("Tag Location", "Category", "Abundance in Category"), align = "c") %>%
kable_paper("striped", full_width = F)
